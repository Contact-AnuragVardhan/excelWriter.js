/*
excelWriter - Javascript module for generating Excel files
<https://github.com/anfilat/excelWriter.js>
(c) 2017 Andrey Filatkin
Dual licenced under the MIT license or GPLv3
*/
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.excelWriter=e()}}(function(){return function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){var n=t[a][1][e];return o(n||e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){},{}],2:[function(e,t,n){(function(n){"use strict";function r(e){var t="<"+e.name,n="";return e.ns&&(t=a.xmlPrefix+t+' xmlns="'+a.schemas[e.ns]+'"'),e.attributes&&e.attributes.forEach(function(e){var n=o(e,2),r=n[0],a=n[1];t+=" "+r+'="'+i.escape(a)+'"'}),void 0!==e.value&&(n+=i.escape(e.value)),e.children&&(n+=e.children.join("")),t+=n?">"+n+"</"+e.name+">":"/>"}var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="undefined"!=typeof window?window._:void 0!==n?n._:null,a=e("./util");t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":26}],3:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){switch(e.toLowerCase()){case"jpeg":case"jpg":return"image/jpeg";case"png":return"image/png";case"gif":return"image/gif";default:return null}}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this.common=t,this._images=Object.create(null),this._imageByNames=Object.create(null),this._extensions=Object.create(null)}return i(e,[{key:"addImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments[2],r=this._images[e];if(r)n&&!this._imageByNames[n]&&(r.name=n,this._imageByNames[n]=r);else{var i=this.common.uniqueIdForSpace("image"),a="xl/media/image"+i+"."+t,s=o(t);n=n||"excelWriter"+i,r={objectId:"image"+i,data:e,name:n,contentType:s,extension:t,path:a},this.common.addPath(r,"/"+a),this._images[e]=r,this._imageByNames[n]=r,this._extensions[t]=s}return r.name}},{key:"getImage",value:function(e){return this._imageByNames[e]}},{key:"getImages",value:function(){return this._images}},{key:"removeImages",value:function(){this._images=null,this._imageByNames=null}},{key:"getExtensions",value:function(){return this._extensions}}]),e}();t.exports=a},{}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./images"),a=e("./sharedStrings"),s=e("../styles"),l=function(){function e(){r(this,e),this.idSpaces=Object.create(null),this._paths=Object.create(null),this.images=new i(this),this.strings=new a(this),this.addPath(this.strings,"sharedStrings.xml"),this.styles=new s(this),this.addPath(this.styles,"styles.xml"),this.worksheets=[],this.tables=[],this.drawings=[]}return o(e,[{key:"uniqueId",value:function(e){return e+this.uniqueIdForSpace(e)}},{key:"uniqueIdForSpace",value:function(e){return this.idSpaces[e]||(this.idSpaces[e]=1),this.idSpaces[e]++}},{key:"addPath",value:function(e,t){this._paths[e.objectId]=t}},{key:"getPath",value:function(e){return this._paths[e.objectId]}},{key:"addWorksheet",value:function(e){var t=this.worksheets.length+1,n="worksheets/sheet"+t+".xml",r="xl/worksheets/_rels/sheet"+t+".xml.rels";e.path="xl/"+n,e.relationsPath=r,this.worksheets.push(e),this.addPath(e,n)}},{key:"getNewWorksheetDefaultName",value:function(){return"Sheet "+(this.worksheets.length+1)}},{key:"setActiveWorksheet",value:function(e){this.activeWorksheet=e}},{key:"addTable",value:function(e){var t=this.tables.length+1,n="xl/tables/table"+t+".xml";e.path=n,this.tables.push(e),this.addPath(e,"/"+n)}},{key:"addDrawings",value:function(e){var t=this.drawings.length+1,n="xl/drawings/drawing"+t+".xml",r="xl/drawings/_rels/drawing"+t+".xml.rels";e.path=n,e.relationsPath=r,this.drawings.push(e),this.addPath(e,"/"+n)}}]),e}();t.exports=l},{"../styles":18,"./images":3,"./sharedStrings":5}],5:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return f.xmlPrefix+'<sst xmlns="'+f.schemas.spreadsheetml+'" count="'+e+'" uniqueCount="'+e+'">'}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e("stream").Readable,u="undefined"!=typeof window?window._:void 0!==n?n._:null,f=e("../util"),c=/^\s|\s$/,h=function(){function e(t){i(this,e),this.objectId=t.uniqueId("SharedStrings"),this._strings=Object.create(null),this._stringArray=[],this.count=0}return s(e,[{key:"add",value:function(e){var t=this._strings[e];return void 0===t&&(t=this.count++,this._strings[e]=t,this._stringArray[t]=e),t}},{key:"isStrings",value:function(){return this.count>0}},{key:"save",value:function(e){if(this._strings=null,e)return new d({strings:this._stringArray});var t=a(this.count)+this._stringArray.map(function(e){return e=u.escape(e),c.test(e)?'<si><t xml:space="preserve">'+e+"</t></si>":"<si><t>"+e+"</t></si>"}).join("")+"</sst>";return this._stringArray=null,t}}]),e}(),d=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.strings=e.strings,n.status=0,n.index=0,n.len=n.strings.length,n}return o(t,e),s(t,[{key:"_read",value:function(e){var t=!1;if(0===this.status&&(t=!this.push(a(this.len)),this.status=1),1===this.status){for(;this.index<this.len&&!t;)t=!this.push(this.packChunk(e));this.index===this.len&&(this.status=2)}2===this.status&&(this.push("</sst>"),this.push(null))}},{key:"packChunk",value:function(e){for(var t="";this.index<this.len&&t.length<e;){var n=u.escape(this.strings[this.index]);c.test(n)?t+='<si><t xml:space="preserve">'+n+"</t></si>":t+="<si><t>"+n+"</t></si>",this.strings[this.index]=null,this.index++}return t}}]),t}(l||null);t.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":26,stream:1}],6:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i="undefined"!=typeof window?window._:void 0!==n?n._:null,a=e("../util"),s=e("../XMLString"),l=function(){function e(t){r(this,e);var n=void 0;i.isObject(t)?n=i.has(t,"cell")?i.isObject(t.cell)?{x:t.cell.c||1,y:t.cell.r||1}:a.letterToPosition(t.cell||""):{x:t.c||1,y:t.r||1}:(n=a.letterToPosition(t||""),t={});var o=n.x-1,s=n.y-1;this.from={x:o,y:s,xOff:a.pixelsToEMUs(t.left||0),yOff:a.pixelsToEMUs(t.top||0)},this.to={x:o+(t.cols||1),y:s+(t.rows||1),xOff:a.pixelsToEMUs(-t.right||0),yOff:a.pixelsToEMUs(-t.bottom||0)}}return o(e,[{key:"saveWithContent",value:function(e){return s({name:"xdr:twoCellAnchor",children:[s({name:"xdr:from",children:[s({name:"xdr:col",value:this.from.x}),s({name:"xdr:colOff",value:this.from.xOff}),s({name:"xdr:row",value:this.from.y}),s({name:"xdr:rowOff",value:this.from.yOff})]}),s({name:"xdr:to",children:[s({name:"xdr:col",value:this.to.x}),s({name:"xdr:colOff",value:this.to.xOff}),s({name:"xdr:row",value:this.to.y}),s({name:"xdr:rowOff",value:this.to.yOff})]}),e,s({name:"xdr:clientData"})]})}}]),e}();t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":26}],7:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../util"),a=e("../XMLString"),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,o=void 0===n?0:n,a=t.top,s=void 0===a?0:a,l=t.width,u=void 0===l?0:l,f=t.height,c=void 0===f?0:f;r(this,e),this.x=i.pixelsToEMUs(o),this.y=i.pixelsToEMUs(s),this.width=i.pixelsToEMUs(u),this.height=i.pixelsToEMUs(c)}return o(e,[{key:"saveWithContent",value:function(e){return a({name:"xdr:absoluteAnchor",children:[a({name:"xdr:pos",attributes:[["x",this.x],["y",this.y]]}),a({name:"xdr:ext",attributes:[["cx",this.width],["cy",this.height]]}),e,a({name:"xdr:clientData"})]})}}]),e}();t.exports=s},{"../XMLString":2,"../util":26}],8:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i="undefined"!=typeof window?window._:void 0!==n?n._:null,a=e("../util"),s=e("../XMLString"),l=function(){function e(t){r(this,e);var n=void 0;i.isObject(t)?n=i.has(t,"cell")?i.isObject(t.cell)?{x:t.cell.c||1,y:t.cell.r||1}:a.letterToPosition(t.cell||""):{x:t.c||1,y:t.r||1}:(n=a.letterToPosition(t||""),t={}),this.x=n.x-1,this.y=n.y-1,this.xOff=a.pixelsToEMUs(t.left||0),this.yOff=a.pixelsToEMUs(t.top||0),this.width=a.pixelsToEMUs(t.width||0),this.height=a.pixelsToEMUs(t.height||0)}return o(e,[{key:"saveWithContent",value:function(e){return s({name:"xdr:oneCellAnchor",children:[s({name:"xdr:from",children:[s({name:"xdr:col",value:this.x}),s({name:"xdr:colOff",value:this.xOff}),s({name:"xdr:row",value:this.y}),s({name:"xdr:rowOff",value:this.yOff})]}),s({name:"xdr:ext",attributes:[["cx",this.width],["cy",this.height]]}),e,s({name:"xdr:clientData"})]})}}]),e}();t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":26}],9:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../relations"),a=e("../util"),s=e("../XMLString"),l=e("./picture"),u=function(){function e(t){r(this,e),this.common=t,this.objectId=this.common.uniqueId("Drawings"),this.drawings=[],this.relations=new i(t)}return o(e,[{key:"addImage",value:function(e,t,n){var r=this.common.images.getImage(e),o=this.relations.addRelation(r,"image"),i=new l(this.common,{image:r,imageRelationId:o,config:t,anchorType:n});this.drawings.push(i)}},{key:"save",value:function(){var e=[["xmlns:a",a.schemas.drawing],["xmlns:r",a.schemas.relationships],["xmlns:xdr",a.schemas.spreadsheetDrawing]],t=this.drawings.map(function(e){return e.save()});return s({name:"xdr:wsDr",ns:"spreadsheetDrawing",attributes:e,children:t})}}]),e}();t.exports=u},{"../XMLString":2,"../relations":12,"../util":26,"./picture":10}],10:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../util"),a=e("../XMLString"),s=e("./anchor"),l=e("./anchorOneCell"),u=e("./anchorAbsolute"),f=function(){function e(t,n){r(this,e),this.pictureId=t.uniqueIdForSpace("Picture"),this.image=n.image,this.imageRelationId=n.imageRelationId,this.createAnchor(n.anchorType,n.config)}return o(e,[{key:"createAnchor",value:function(e,t){switch(e){case"anchor":this.anchor=new s(t);break;case"oneCell":this.anchor=new l(t);break;case"absolute":this.anchor=new u(t)}}},{key:"save",value:function(){return this.anchor.saveWithContent(a({name:"xdr:pic",children:[a({name:"xdr:nvPicPr",children:[a({name:"xdr:cNvPr",attributes:[["id",this.pictureId],["name",this.image.name]]}),a({name:"xdr:cNvPicPr",children:[a({name:"a:picLocks",attributes:[["noChangeAspect","1"],["noChangeArrowheads","1"]]})]})]}),a({name:"xdr:blipFill",children:[a({name:"a:blip",attributes:[["xmlns:r",i.schemas.relationships],["r:embed",this.imageRelationId]]}),a({name:"a:srcRect"}),a({name:"a:stretch",children:[a({name:"a:fillRect"})]})]}),a({name:"xdr:spPr",attributes:[["bwMode","auto"]],children:[a({name:"a:xfrm"}),a({name:"a:prstGeom",attributes:[["prst","rect"]]})]})]}))}}]),e}();t.exports=f},{"../XMLString":2,"../util":26,"./anchor":6,"./anchorAbsolute":7,"./anchorOneCell":8}],11:[function(e,t,n){(function(n){"use strict";function r(){var e=new s,t=e.common,n=t.styles,r=t.images,u=e.relations;return{addWorksheet:function(e){e=i.defaults(e,{name:t.getNewWorksheetDefaultName()});var n=new l(this,t,e);return t.addWorksheet(n),u.addRelation(n,"worksheet"),n},addFormat:function(e,t){return n.addFormat(e,t)},addFontFormat:function(e,t){return n.addFontFormat(e,t)},addBorderFormat:function(e,t){return n.addBorderFormat(e,t)},addPatternFormat:function(e,t){return n.addPatternFormat(e,t)},addGradientFormat:function(e,t){return n.addGradientFormat(e,t)},addNumberFormat:function(e,t){return n.addNumberFormat(e,t)},addTableFormat:function(e,t){return n.addTableFormat(e,t)},addTableElementFormat:function(e,t){return n.addTableElementFormat(e,t)},setDefaultTableStyle:function(e){return n.setDefaultTableStyle(e),this},addImage:function(e,t,n){return r.addImage(e,t,n)},save:function(t){var n=new a,r=!!o;return e.generateFiles(n,r),n.generateAsync(i.defaults(t,{compression:"DEFLATE",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",type:"base64"}))},saveAsNodeStream:function(t){var n=new a,r=!!o;return e.generateFiles(n,r),n.generateNodeStream(i.defaults(t,{compression:"DEFLATE"}))}}}var o=e("stream").Readable,i="undefined"!=typeof window?window._:void 0!==n?n._:null,a="undefined"!=typeof window?window.JSZip:void 0!==n?n.JSZip:null,s=e("./workbook"),l=e("./worksheet");t.exports={createWorkbook:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./workbook":27,"./worksheet":30,stream:1}],12:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i="undefined"!=typeof window?window._:void 0!==n?n._:null,a=e("./util"),s=e("./XMLString"),l=function(){function e(t){r(this,e),this.common=t,this.relations=Object.create(null),this.lastId=1}return o(e,[{key:"addRelation",value:function(e,t){var n=this.relations[e.objectId];if(n)return n.relationId;var r="rId"+this.lastId++;return this.relations[e.objectId]={relationId:r,schema:a.schemas[t],object:e},r}},{key:"getRelationshipId",value:function(e){var t=this.relations[e.objectId];return t?t.relationId:null}},{key:"save",value:function(){var e=this.common,t=i.map(this.relations,function(t){var n=[["Id",t.relationId],["Type",t.schema],["Target",t.object.target||e.getPath(t.object)]];return t.object.targetMode&&n.push(["TargetMode",t.object.targetMode]),s({name:"Relationship",attributes:n})});return s({name:"Relationships",ns:"relationshipPackage",children:t})}}]),e}();t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./util":26}],13:[function(e,t,n){(function(n){"use strict";function r(e){var t={};return a.has(e,"horizontal")&&a.includes(l,e.horizontal)&&(t.horizontal=e.horizontal),a.has(e,"vertical")&&a.includes(u,e.vertical)&&(t.vertical=e.vertical),a.has(e,"indent")&&(t.indent=e.indent),a.has(e,"justifyLastLine")&&(t.justifyLastLine=e.justifyLastLine?1:0),a.has(e,"readingOrder")&&a.includes([0,1,2],e.readingOrder)&&(t.readingOrder=e.readingOrder),a.has(e,"relativeIndent")&&(t.relativeIndent=e.relativeIndent),a.has(e,"shrinkToFit")&&(t.shrinkToFit=e.shrinkToFit?1:0),a.has(e,"textRotation")&&(t.textRotation=e.textRotation),a.has(e,"wrapText")&&(t.wrapText=e.wrapText?1:0),a.isEmpty(t)?null:t}function o(e,t){return a.assign(e,t)}function i(e){return s({name:"alignment",attributes:a.toPairs(e)})}var a="undefined"!=typeof window?window._:void 0!==n?n._:null,s=e("../XMLString"),l=["left","center","right","fill","justify","centerContinuous","distributed"],u=["top","center","bottom","justify","distributed"];t.exports={canon:r,merge:o,saveFormat:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],14:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s="undefined"!=typeof window?window._:void 0!==n?n._:null,l=e("./stylePart"),u=e("./utils"),f=u.saveColor,c=e("../XMLString"),h=["left","right","top","bottom"],d=["left","right","top","bottom","diagonal"],p=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"borders","border"));return n.init(),n.lastId=n.formats.length,n}return i(t,e),a(t,[{key:"init",value:function(){this.formats.push({format:this.canon({})})}},{key:"canon",value:function(e){return t.canon(e)}},{key:"merge",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.canon({}),n=arguments[1];return n&&d.forEach(function(t){var r=n[t];r&&r.style&&(e[t].style=r.style),r&&r.color&&(e[t].color=r.color)}),e}},{key:"saveFormat",value:function(e,n){return t.saveFormat(e,n)}}],[{key:"canon",value:function(e){var t={};return s.has(e,"style")||s.has(e,"color")?h.forEach(function(n){t[n]={style:e.style,color:e.color}}):d.forEach(function(n){var r=e[n];t[n]=r?{style:r.style,color:r.color}:{}}),t}},{key:"saveFormat",value:function(e){var t=d.map(function(t){var n=e[t],r=void 0,o=void 0;return n&&(n.style&&(r=[["style",n.style]]),n.color&&(o=[f(n.color)])),c({name:t,attributes:r,children:o})});return c({name:"border",children:t})}}]),t}(l);t.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":21,"./utils":24}],15:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s="undefined"!=typeof window?window._:void 0!==n?n._:null,l=e("./stylePart"),u=e("./alignment"),f=e("./protection"),c=e("../XMLString"),h=["format","fill","border","font"],d=["numFmtId","fillId","borderId","fontId"],p=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"cellXfs","format"));return n.init(),n.lastId=n.formats.length,n.saveEmpty=!1,n}return i(t,e),a(t,[{key:"init",value:function(){this.formats.push({format:this.canon({})})}},{key:"canon",value:function(e,t){var n={};e.format&&(n.format=this.styles.numberFormats.add(e.format)),e.font&&(n.font=this.styles.fonts.add(e.font)),e.pattern?n.fill=this.styles.fills.add(e.pattern,null,{fillType:"pattern"}):e.gradient?n.fill=this.styles.fills.add(e.gradient,null,{fillType:"gradient"}):t&&t.merge&&e.fill&&(n.fill=this.styles.fills.add(e.fill,null,t)),e.border&&(n.border=this.styles.borders.add(e.border));var r=t&&t.merge?u.canon(e.alignment):u.canon(e);r&&(n.alignment=r);var o=t&&t.merge?f.canon(e.protection):f.canon(e);return o&&(n.protection=o),e.fillOut&&(n.fillOut=e.fillOut),n}},{key:"fullGet",value:function(e){e=this.getId(e)?this.get(e):this.canon(e);var t={};return e.format&&(t.format=this.styles.numberFormats.get(e.format)),e.font&&(t.font=s.clone(this.styles.fonts.get(e.font))),e.fill&&(t.fill=s.clone(this.styles.fills.get(e.fill))),e.border&&(t.border=s.clone(this.styles.borders.get(e.border))),e.alignment&&(t.alignment=s.clone(e.alignment)),e.protection&&(t.protection=s.clone(e.protection)),t}},{key:"cutVisible",value:function(e){var t={};return e.format&&(t.format=e.format),e.font&&(t.font=e.font),e.alignment&&(t.alignment=e.alignment),e.protection&&(t.protection=e.protection),t}},{key:"merge",value:function(e,t){return(e.format||t.format)&&(e.format=this.styles.numberFormats.merge(e.format,t.format)),(e.font||t.font)&&(e.font=this.styles.fonts.merge(e.font,t.font)),(e.fill||t.fill)&&(e.fill=this.styles.fills.merge(e.fill,t.fill)),(e.border||t.border)&&(e.border=this.styles.borders.merge(e.border,t.border)),(e.alignment||t.alignment)&&(e.alignment=u.merge(e.alignment,t.alignment)),(e.protection||t.protection)&&(e.protection=f.merge(e.protection,t.protection)),e}},{key:"saveFormat",value:function(e){var t=this.styles,n=[],r=[];return e.alignment&&(r.push(u.saveFormat(e.alignment)),n.push(["applyAlignment","true"])),e.protection&&(r.push(f.saveFormat(e.protection)),n.push(["applyProtection","true"])),s.forEach(e,function(e,r){if(s.includes(h,r)){var o=d[s.indexOf(h,r)];"format"===r?(n.push([o,t.numberFormats.getId(e)]),n.push(["applyNumberFormat","true"])):"fill"===r?(n.push([o,t.fills.getId(e)]),n.push(["applyFill","true"])):"border"===r?(n.push([o,t.borders.getId(e)]),n.push(["applyBorder","true"])):"font"===r&&(n.push([o,t.fonts.getId(e)]),n.push(["applyFont","true"]))}}),c({name:"xf",attributes:n,children:r})}}]),t}(l);t.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./alignment":13,"./protection":20,"./stylePart":21}],16:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=[["patternType",e.patternType]],n=[p({name:"fgColor",attributes:[["rgb",h(e.fgColor)]]}),p({name:"bgColor",attributes:[["rgb",h(e.bgColor)]]})];return p({name:"patternFill",attributes:t,children:n})}function s(e){var t=[];e.degree?t.push(["degree",e.degree]):e.left&&(t.push(["type","path"]),t.push(["left",e.left]),t.push(["right",e.right]),t.push(["top",e.top]),t.push(["bottom",e.bottom]));var n=[p({name:"stop",attributes:[["position",0]],children:[d(e.start)]}),p({name:"stop",attributes:[["position",1]],children:[d(e.end)]})];return p({name:"gradientFill",attributes:t,children:n})}var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u="undefined"!=typeof window?window._:void 0!==n?n._:null,f=e("./stylePart"),c=e("./utils"),h=c.canonColor,d=c.saveColor,p=e("../XMLString"),m=["none","solid","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis"],y=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"fills","fill"));return n.init(),n.lastId=n.formats.length,n}return i(t,e),l(t,[{key:"init",value:function(){this.formats.push({format:this.canon({type:"none"},{fillType:"pattern"})},{format:this.canon({type:"gray125"},{fillType:"pattern"})})}},{key:"canon",value:function(e,n){return t.canon(e,n)}},{key:"merge",value:function(e,t){return t||e}},{key:"saveFormat",value:function(e){return t.saveFormat(e)}}],[{key:"canon",value:function(e,t){var n={fillType:t.merge?e.fillType:t.fillType};if("pattern"===n.fillType){var r=(t.merge?e.fgColor:e.color)||"FFFFFFFF",o=(t.merge?e.bgColor:e.backColor)||"FFFFFFFF",i=t.merge?e.patternType:e.type;n.patternType=u.includes(m,i)?i:"solid",t.isTable&&"solid"===n.patternType?(n.fgColor=o,n.bgColor=r):(n.fgColor=r,n.bgColor=o)}else u.has(e,"left")?(n.left=e.left||0,n.right=e.right||0,n.top=e.top||0,n.bottom=e.bottom||0):n.degree=e.degree||0,n.start=e.start||"FFFFFFFF",n.end=e.end||"FFFFFFFF";return n}},{key:"saveFormat",value:function(e){var t="pattern"===e.fillType?[a(e)]:[s(e)];return p({name:"fill",children:t})}}]),t}(f);t.exports=y}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":21,"./utils":24}],17:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s="undefined"!=typeof window?window._:void 0!==n?n._:null,l=e("./stylePart"),u=e("./utils"),f=u.saveColor,c=e("../XMLString"),h=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"fonts","font"));return n.init(),n.lastId=n.formats.length,n}return i(t,e),a(t,[{key:"init",value:function(){this.formats.push({format:this.canon({})})}},{key:"canon",value:function(e){return t.canon(e)}},{key:"merge",value:function(e,t){var n=s.assign(e,t);return n.color=t&&t.color||e&&e.color,n}},{key:"saveFormat",value:function(e,n){return t.saveFormat(e,n)}}],[{key:"canon",value:function(e){var t={};return s.has(e,"bold")&&(t.bold=!!e.bold),s.has(e,"italic")&&(t.italic=!!e.italic),e.superscript&&(t.vertAlign="superscript"),e.subscript&&(t.vertAlign="subscript"),e.underline&&(-1!==s.indexOf(["double","singleAccounting","doubleAccounting"],e.underline)?t.underline=e.underline:t.underline=!0),s.has(e,"strike")&&(t.strike=!!e.strike),e.outline&&(t.outline=!0),e.shadow&&(t.shadow=!0),e.size&&(t.size=e.size),e.color&&(t.color=e.color),e.fontName&&(t.fontName=e.fontName),t}},{key:"saveFormat",value:function(e){var t=[];if(e.size&&t.push(c({name:"sz",attributes:[["val",e.size]]})),e.fontName&&t.push(c({name:"name",attributes:[["val",e.fontName]]})),s.has(e,"bold")&&(e.bold?t.push(c({name:"b"})):t.push(c({name:"b",attributes:[["val",0]]}))),s.has(e,"italic")&&(e.italic?t.push(c({name:"i"})):t.push(c({name:"i",attributes:[["val",0]]}))),e.vertAlign&&t.push(c({name:"vertAlign",attributes:[["val",e.vertAlign]]})),e.underline){var n=null;!0!==e.underline&&(n=[["val",e.underline]]),t.push(c({name:"u",attributes:n}))}return s.has(e,"strike")&&(e.strike?t.push(c({name:"strike"})):t.push(c({name:"strike",attributes:[["val",0]]}))),e.shadow&&t.push(c({name:"shadow"})),e.outline&&t.push(c({name:"outline"})),e.color&&t.push(f(e.color)),c({name:"font",children:t})}}]),t}(l);t.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":21,"./utils":24}],18:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i="undefined"!=typeof window?window._:void 0!==n?n._:null,a=e("./numberFormats"),s=e("./fonts"),l=e("./fills"),u=e("./borders"),f=e("./cells"),c=e("./tables"),h=e("./tableElements"),d=e("../XMLString"),p=function(){function e(t){r(this,e),this.objectId=t.uniqueId("Styles"),this.numberFormats=new a(this),this.fonts=new s(this),this.fills=new l(this),
this.borders=new u(this),this.cells=new f(this),this.tableElements=new h(this),this.tables=new c(this),this.defaultTableStyle=""}return o(e,[{key:"addFormat",value:function(e,t){return this.cells.add(e,t)}},{key:"_get",value:function(e){return this.cells.get(e)}},{key:"_getId",value:function(e){return this.cells.getId(e)}},{key:"_addFillOutFormat",value:function(e){if(this._get(e).fillOut)return e;var t=this.cells.cutVisible(this.cells.fullGet(e));return i.isEmpty(t)?void 0:this.addFormat(t)}},{key:"_merge",value:function(e,t,n){var r=Number(Boolean(e))+Number(Boolean(t))+Number(Boolean(n));if(0===r)return null;if(1===r)return this.cells.add(e||t||n);var o={};return e&&(o=this.cells.merge(o,this.cells.fullGet(e))),t&&(o=this.cells.merge(o,this.cells.fullGet(t))),n&&(o=this.cells.merge(o,this.cells.fullGet(n))),this.cells.add(o,null,{merge:!0})}},{key:"addFontFormat",value:function(e,t){return this.fonts.add(e,t)}},{key:"addBorderFormat",value:function(e,t){return this.borders.add(e,t)}},{key:"addPatternFormat",value:function(e,t){return this.fills.add(e,t,{fillType:"pattern"})}},{key:"addGradientFormat",value:function(e,t){return this.fills.add(e,t,{fillType:"gradient"})}},{key:"addNumberFormat",value:function(e,t){return this.numberFormats.add(e,t)}},{key:"addTableFormat",value:function(e,t){return this.tables.add(e,t)}},{key:"addTableElementFormat",value:function(e,t){return this.tableElements.add(e,t)}},{key:"setDefaultTableStyle",value:function(e){this.tables.defaultTableStyle=e}},{key:"save",value:function(){return d({name:"styleSheet",ns:"spreadsheetml",children:[this.numberFormats.save(),this.fonts.save(),this.fills.save(),this.borders.save(),this.cells.save(),this.tableElements.save(),this.tables.save()]})}}]),e}();t.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./borders":14,"./cells":15,"./fills":16,"./fonts":17,"./numberFormats":19,"./tableElements":22,"./tables":23}],19:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s="undefined"!=typeof window?window._:void 0!==n?n._:null,l=e("./stylePart"),u=e("../XMLString"),f={date:14,time:21},c=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"numFmts","numberFormat"));return n.init(),n.lastId=164,n}return i(t,e),a(t,[{key:"init",value:function(){var e=this;s.forEach(f,function(t,n){e.formatsByNames[n]={formatId:t,format:n}})}},{key:"canon",value:function(e){return t.canon(e)}},{key:"merge",value:function(e,t){return t||e}},{key:"saveFormat",value:function(e,n){return t.saveFormat(e,n)}}],[{key:"canon",value:function(e){return e}},{key:"saveFormat",value:function(e,t){var n=[["numFmtId",t.formatId],["formatCode",e]];return u({name:"numFmt",attributes:n})}}]),t}(l);t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":21}],20:[function(e,t,n){(function(n){"use strict";function r(e){var t={};return a.has(e,"locked")&&(t.locked=e.locked?1:0),a.has(e,"hidden")&&(t.hidden=e.hidden?1:0),a.isEmpty(t)?null:t}function o(e,t){return a.assign(e,t)}function i(e){return s({name:"protection",attributes:a.toPairs(e)})}var a="undefined"!=typeof window?window._:void 0!==n?n._:null,s=e("../XMLString");t.exports={canon:r,merge:o,saveFormat:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],21:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i="undefined"!=typeof window?window._:void 0!==n?n._:null,a=e("../XMLString"),s=function(){function e(t,n,o){r(this,e),this.styles=t,this.saveName=n,this.formatName=o,this.lastName=1,this.lastId=0,this.saveEmpty=!0,this.formats=[],this.formatsByData=Object.create(null),this.formatsByNames=Object.create(null)}return o(e,[{key:"add",value:function(e,t,n){if(t&&this.formatsByNames[t]){var r=this.canon(e,n),o=i.isObject(r)?JSON.stringify(r):r;return o!==this.formatsByNames[t].stringFormat&&this._add(r,o,t),t}if(!t&&i.isString(e)&&this.formatsByNames[e])return e;var a=this.canon(e,n),s=i.isObject(a)?JSON.stringify(a):a,l=this.formatsByData[s];return l?t&&!this.formatsByNames[t]&&(l.name=t,this.formatsByNames[t]=l):l=this._add(a,s,t),l.name}},{key:"_add",value:function(e,t,n){n=n||this.formatName+this.lastName++;var r={name:n,formatId:this.lastId++,format:e,stringFormat:t};return this.formats.push(r),this.formatsByData[t]=r,this.formatsByNames[n]=r,r}},{key:"canon",value:function(e){return e}},{key:"get",value:function(e){if(i.isString(e)){var t=this.formatsByNames[e];return t?t.format:e}return e}},{key:"getId",value:function(e){var t=this.formatsByNames[e];return t?t.formatId:null}},{key:"save",value:function(){var e=this;if(!1!==this.saveEmpty||this.formats.length){var t=[["count",this.formats.length]],n=this.formats.map(function(t){return e.saveFormat(t.format,t)});return this.saveCollectionExt(t,n),a({name:this.saveName,attributes:t,children:n})}return""}},{key:"saveCollectionExt",value:function(){}},{key:"saveFormat",value:function(){return""}}]),e}();t.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],22:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./stylePart"),l=e("./numberFormats"),u=e("./fonts"),f=e("./fills"),c=e("./borders"),h=e("./alignment"),d=e("../XMLString"),p=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"dxfs","tableElement"))}return i(t,e),a(t,[{key:"canon",value:function(e){var t={};return e.format&&(t.format=l.canon(e.format)),e.font&&(t.font=u.canon(e.font)),e.pattern?t.fill=f.canon(e.pattern,{fillType:"pattern",isTable:!0}):e.gradient&&(t.fill=f.canon(e.gradient,{fillType:"gradient"})),e.border&&(t.border=c.canon(e.border)),t.alignment=h.canon(e),t}},{key:"saveFormat",value:function(e){var t=[];return e.font&&t.push(u.saveFormat(e.font)),e.fill&&t.push(f.saveFormat(e.fill)),e.border&&t.push(c.saveFormat(e.border)),e.format&&t.push(l.saveFormat(e.format)),e.alignment&&e.alignment.length&&t.push(h.save(e.alignment)),d({name:"dxf",children:t})}}]),t}(s);t.exports=p},{"../XMLString":2,"./alignment":13,"./borders":14,"./fills":16,"./fonts":17,"./numberFormats":19,"./stylePart":21}],23:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s="undefined"!=typeof window?window._:void 0!==n?n._:null,l=e("./stylePart"),u=e("../XMLString"),f=["wholeTable","headerRow","totalRow","firstColumn","lastColumn","firstRowStripe","secondRowStripe","firstColumnStripe","secondColumnStripe","firstHeaderCell","lastHeaderCell","firstTotalCell","lastTotalCell"],c=["firstRowStripe","secondRowStripe","firstColumnStripe","secondColumnStripe"],h=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"tableStyles","table"));return n.saveEmpty=!1,n}return i(t,e),a(t,[{key:"canon",value:function(e){var t={},n=this.styles;return s.forEach(e,function(e,r){if(s.includes(f,r)){var o=void 0,i=null;e.style?(o=n.tableElements.add(e.style),e.size>1&&s.includes(c,r)&&(i=e.size)):o=n.tableElements.add(e),t[r]={style:o,size:i}}}),t}},{key:"saveCollectionExt",value:function(e){this.styles.defaultTableStyle&&e.push(["defaultTableStyle",this.styles.defaultTableStyle])}},{key:"saveFormat",value:function(e,t){var n=this.styles,r=[["name",t.name],["pivot",0]],o=[];return s.forEach(e,function(e,t){var r=e.style,i=e.size,a=[["type",t],["dxfId",n.tableElements.getId(r)]];i&&a.push(["size",i]),o.push(u({name:"tableStyleElement",attributes:a}))}),r.push(["count",o.length]),u({name:"tableStyle",attributes:r,children:o})}}]),t}(l);t.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":21}],24:[function(e,t,n){(function(n){"use strict";function r(e){return"#"===e[0]?"FF"+e.substr(1):e}function o(e){if(i.isString(e))return a({name:"color",attributes:[["rgb",r(e)]]});var t=[];return i.isUndefined(e.tint)||t.push(["tint",e.tint]),i.isUndefined(e.auto)||t.push(["auto",!!e.auto]),i.isUndefined(e.theme)||t.push(["theme",e.theme]),a({name:"color",attributes:t})}var i="undefined"!=typeof window?window._:void 0!==n?n._:null,a=e("../XMLString");t.exports={canonColor:r,saveColor:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],25:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return c({name:"autoFilter",attributes:["ref",e+":"+t]})}function i(e){var t=[["count",e.length]],n=u.map(e,function(e,t){var n=[["id",t+1],["name",e.name]];return e.totalsRowFunction&&n.push(["totalsRowFunction",e.totalsRowFunction]),e.totalsRowLabel&&n.push(["totalsRowLabel",e.totalsRowLabel]),c({name:"tableColumn",attributes:n})});return c({name:"tableColumns",attributes:t,children:n})}function a(e,t){var n=[["name",t]],r=e.styles.tables.get(t),o=!1,i=!1,a=!1,s=!1;return r&&(o=r.firstRowStripe||r.secondRowStripe,i=r.firstColumnStripe||r.secondColumnStripe,a=r.firstColumn,s=r.lastColumn),n.push(["showRowStripes",o?"1":"0"],["showColumnStripes",i?"1":"0"],["showFirstColumn",a?"1":"0"],["showLastColumn",s?"1":"0"]),c({name:"tableStyleInfo",attributes:n})}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u="undefined"!=typeof window?window._:void 0!==n?n._:null,f=e("./util"),c=e("./XMLString"),h=function(){function e(t,n){r(this,e),this.worksheet=t,this.common=t.common,this.tableId=this.common.uniqueIdForSpace("Table"),this.objectId="Table"+this.tableId,this.name=this.objectId,this.displayName=this.objectId,this.headerRowCount=1,this.beginCell=null,this.endCell=null,this.totalsRowCount=0,this.totalRow=null,this.themeStyle=null,u.extend(this,n)}return l(e,[{key:"end",value:function(){return this.worksheet}},{key:"setReferenceRange",value:function(e,t){return this.beginCell=f.canonCell(e),this.endCell=f.canonCell(t),this}},{key:"addTotalRow",value:function(e){return this.totalRow=e,this.totalsRowCount=1,this}},{key:"setTheme",value:function(e){return this.themeStyle=e,this}},{key:"setSortState",value:function(e){return this.sortState=e,this}},{key:"_prepare",value:function(e){var t=["average","countNums","count","max","min","stdDev","sum","var"],n=[101,102,103,104,105,107,109,110];if(this.totalRow){var r=this.name,o=f.letterToPosition(this.beginCell),i=f.letterToPosition(this.endCell),a=o.y-1,l=o.x-1,c=i.y-1,h=e[a]||[],d=e[c+1];d||(d=[],e[c+1]=d),u.forEach(this.totalRow,function(e,o){var i=h[l+o],a=void 0;"object"===(void 0===i?"undefined":s(i))&&(i=i.value),e.name=i,e.totalsRowLabel?d[l+o]={value:e.totalsRowLabel,type:"string"}:e.totalsRowFunction&&-1!==(a=u.indexOf(t,e.totalsRowFunction))&&(d[l+o]={value:"SUBTOTAL("+n[a]+","+r+"["+i+"])",type:"formula"})})}}},{key:"_save",value:function(){var e=[["id",this.tableId],["name",this.name],["displayName",this.displayName]],t=[],n=f.letterToPosition(this.endCell),r=this.beginCell+":"+f.positionToLetter(n.x,n.y+this.totalsRowCount);return e.push(["ref",r]),e.push(["totalsRowCount",this.totalsRowCount]),e.push(["headerRowCount",this.headerRowCount]),t.push(o(this.beginCell,this.endCell)),t.push(i(this.totalRow)),t.push(a(this.common,this.themeStyle)),c({name:"table",ns:"spreadsheetml",attributes:e,children:t})}}]),e}();t.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./util":26}],26:[function(e,t,n){(function(e){"use strict";function n(e,t){var n=a[e];if(!n){var r="",o=e,s=void 0;do{s=(o-1)%26,r=i[s]+r,o=(o-(s+1))/26}while(o>0);a[e]=r,n=r}return n+(t||"")}function r(e){for(var t=0,n=0,r=0,o=e.length;r<o;r++){var i=e.charCodeAt(r);if(!(i>=65)){n=parseInt(e.slice(r),10);break}t=26*t+i-64}return{x:t||1,y:n||1}}var o="undefined"!=typeof window?window._:void 0!==e?e._:null,i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a={};t.exports={pixelsToEMUs:function(e){return Math.round(914400*e/96)},canonCell:function(e){return o.isObject(e)?n(e.c||1,e.r||1):e},positionToLetter:n,letterToPosition:r,xmlPrefix:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n',schemas:{worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(e,t,n){(function(n){"use strict";function r(){this.common=new a,this.styles=this.common.styles,this.images=this.common.images,this.relations=new s(this.common),this.relations.addRelation(this.common.styles,"stylesheet")}var o="undefined"!=typeof window?window._:void 0!==n?n._:null,i=e("./util"),a=e("./common"),s=e("./relations"),l=e("./XMLString");r.prototype={generateFiles:function(e,t){this.prepareWorksheets(),this.saveWorksheets(e,t),this.saveTables(e),this.saveImages(e),this.saveDrawings(e),this.saveStyles(e),this.saveStrings(e,t),e.file("[Content_Types].xml",this.createContentTypes()),e.file("_rels/.rels",this.createWorkbookRelationship()),e.file("xl/workbook.xml",this.save()),e.file("xl/_rels/workbook.xml.rels",this.relations.save())},save:function(){return l({name:"workbook",ns:"spreadsheetml",attributes:[["xmlns:r",i.schemas.relationships]],children:[this.bookViewsXML(),this.sheetsXML(),this.definedNamesXML()]})},bookViewsXML:function(){var e=0;if(this.common.activeWorksheet){var t=this.common.activeWorksheet.objectId;e=Math.max(e,this.common.worksheets.findIndex(function(e){return e.objectId===t}))}return l({name:"bookViews",children:[l({name:"workbookView",attributes:[["activeTab",e]]})]})},sheetsXML:function(){var e=this,t=this.common.worksheets.map(function(t,n){if(t.name.length>31)throw'Microsoft Excel requires work sheet names to be less than 32 characters long, work sheet name "'+t.name+'" is '+t.name.length+" characters long";return l({name:"sheet",attributes:[["name",t.name],["sheetId",n+1],["r:id",e.relations.getRelationshipId(t)],["state",t.getState()]]})});return l({name:"sheets",children:t})},definedNamesXML:function(){if(this.common.worksheets.some(function(e){return e._printTitles&&(e._printTitles.topTo>=0||e._printTitles.leftTo>=0)})){var e=[];return this.common.worksheets.forEach(function(t,n){var r=t._printTitles;if(r&&(r.topTo>=0||r.leftTo>=0)){var o=t.name,a="";r.topTo>=0&&(a=o+"!$"+(r.topFrom+1)+":$"+(r.topTo+1),r.leftTo>=0&&(a+=",")),r.leftTo>=0&&(a+=o+"!$"+i.positionToLetter(r.leftFrom+1)+":$"+i.positionToLetter(r.leftTo+1)),e.push(l({name:"definedName",value:a,attributes:[["name","_xlnm.Print_Titles"],["localSheetId",n]]}))}}),l({name:"definedNames",children:e})}return""},prepareWorksheets:function(){this.common.worksheets.forEach(function(e){e._prepare()})},saveWorksheets:function(e,t){this.common.worksheets.forEach(function(n){e.file(n.path,n._save(t)),e.file(n.relationsPath,n.relations.save())})},saveTables:function(e){this.common.tables.forEach(function(t){e.file(t.path,t._save())})},saveImages:function(e){o.forEach(this.images.getImages(),function(t){e.file(t.path,t.data,{base64:!0,binary:!0}),t.data=null}),this.images.removeImages()},saveDrawings:function(e){this.common.drawings.forEach(function(t){e.file(t.path,t.save()),e.file(t.relationsPath,t.relations.save())})},saveStyles:function(e){e.file("xl/styles.xml",this.styles.save())},saveStrings:function(e,t){this.common.strings.isStrings()&&(this.relations.addRelation(this.common.strings,"sharedStrings"),e.file("xl/sharedStrings.xml",this.common.strings.save(t)))},createContentTypes:function(){var e=[];return e.push(l({name:"Default",attributes:[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]]})),e.push(l({name:"Default",attributes:[["Extension","xml"],["ContentType","application/xml"]]})),e.push(l({name:"Override",attributes:[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]]})),this.common.strings.isStrings()&&e.push(l({name:"Override",attributes:[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]]})),e.push(l({name:"Override",attributes:[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]]})),this.common.worksheets.forEach(function(t,n){e.push(l({name:"Override",attributes:[["PartName","/xl/worksheets/sheet"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]}))}),this.common.tables.forEach(function(t,n){e.push(l({name:"Override",attributes:[["PartName","/xl/tables/table"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]}))}),o.forEach(this.common.images.getExtensions(),function(t,n){e.push(l({name:"Default",attributes:[["Extension",n],["ContentType",t]]}))}),this.common.drawings.forEach(function(t,n){e.push(l({name:"Override",attributes:[["PartName","/xl/drawings/drawing"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]}))}),l({name:"Types",ns:"contentTypes",children:e})},createWorkbookRelationship:function(){return l({name:"Relationships",ns:"relationshipPackage",children:[l({name:"Relationship",attributes:[["Id","rId1"],["Type",i.schemas.officeDocument],["Target","xl/workbook.xml"]]})]})}},t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./common":4,"./relations":12,"./util":26}],28:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s="undefined"!=typeof window?window._:void 0!==n?n._:null,l=e("./tables"),u=e("../drawings"),f=e("../XMLString"),c=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._drawings=null,e}return i(t,e),a(t,[{key:"setImage",value:function(e,t){return this._setDrawing(e,t,"anchor")}},{key:"setImageOneCell",value:function(e,t){return this._setDrawing(e,t,"oneCell")}},{key:"setImageAbsolute",value:function(e,t){return this._setDrawing(e,t,"absolute")}},{key:"_setDrawing",value:function(e,t,n){this._drawings||(this._drawings=new u(this.common),this.common.addDrawings(this._drawings),this.relations.addRelation(this._drawings,"drawingRelationship"));var r=s.isObject(e)?this.common.images.addImage(e.data,e.type):e;return this._drawings.addImage(r,t,n),this}},{key:"_insertDrawing",value:function(e,t,n){if(n){var r={c:e+1,r:t+1};if("string"==typeof n||n.data)this._setDrawing(n,r,"anchor");else{var o=n.config||{};o.cell=r,this._setDrawing(n.image,o,"anchor")}}}},{key:"_saveDrawing",value:function(){return this._drawings?f({name:"drawing",attributes:[["r:id",this.relations.getRelationshipId(this._drawings)]]}):""}}]),t}(l);t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../drawings":9,"./tables":36}],29:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../util"),l=e("./mergedCells"),u=e("../XMLString"),f=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._hyperlinks=[],e}return i(t,e),a(t,[{key:"setHyperlink",value:function(e){return e.objectId=this.common.uniqueId("hyperlink"),this.relations.addRelation({objectId:e.objectId,target:e.location,targetMode:e.targetMode||"External"},"hyperlink"),this._hyperlinks.push(e),this}},{key:"_insertHyperlink",value:function(e,t,n){if(n){var r={c:e+1,r:t+1};"string"==typeof n?this.setHyperlink({cell:r,location:n}):this.setHyperlink({cell:r,location:n.location,targetMode:n.targetMode,tooltip:n.tooltip})}}},{key:"_saveHyperlinks",value:function(){var e=this;if(this._hyperlinks.length>0){var t=this._hyperlinks.map(function(t){var n=[["ref",s.canonCell(t.cell)],["r:id",e.relations.getRelationshipId(t)]];return t.tooltip&&n.push(["tooltip",t.tooltip]),u({name:"hyperlink",attributes:n})});return u({name:"hyperlinks",children:t})}return""}}]),t}(l);t.exports=f},{"../XMLString":2,"../util":26,"./mergedCells":31}],30:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./save"),l=e("../relations"),u=function(e){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a.outerWorkbook=e,a.common=n,a.styles=a.common.styles,a.objectId=a.common.uniqueId("Worksheet"),a.data=[],a.columns=[],a.rows=[],a.name=i.name,a.state=i.state||"visible",a.timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,a.relations=new l(a.common),a}return i(t,e),a(t,[{key:"end",value:function(){return this.outerWorkbook}},{key:"setActive",value:function(){return this.common.setActiveWorksheet(this),this}},{key:"setVisible",value:function(){return this.setState("visible"),this}},{key:"setHidden",value:function(){return this.setState("hidden"),this}},{key:"setState",value:function(e){return this.state=e,this}},{key:"getState",value:function(){return this.state}},{key:"setRows",value:function(e,t){var n=this;return t?--e:(t=e,e=0),t.forEach(function(t,r){n.rows[e+r]=t}),this}},{key:"setRow",value:function(e,t){return this.rows[--e]=t,this}},{key:"setColumns",value:function(e,t){var n=this;return t?--e:(t=e,e=0),t.forEach(function(t,r){n.columns[e+r]=t}),this}},{key:"setColumn",value:function(e,t){return this.columns[--e]=t,this}},{key:"setData",value:function(e,t){var n=this,r=this.data.length;return t?r+=e:t=e,t.forEach(function(e,t){n.data[r+t]=e}),this}}]),t}(s);t.exports=u},{"../relations":12,"./save":34}],31:[function(e,t,n){(function(n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l="undefined"!=typeof window?window._:void 0!==n?n._:null,u=e("../util"),f=e("./drawing"),c=e("../XMLString"),h=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._mergedCells=[],e}return a(t,e),s(t,[{key:"mergeCells",value:function(e,t){return this._mergedCells.push([e,t]),this}},{key:"_insertMergeCells",value:function(e,t,n,o,i,a){var s=this;return o&&(e=[].concat(r(e.slice(0,t+1)),r(l.times(o,function(){return{style:a,type:"empty"}})),r(e.slice(t+1)))),i&&l.forEach(l.range(n+1,n+1+i),function(e){var n=s.data[e]||[];l.isArray(n)&&(n={data:n},s.data[e]=n),n.inserts=n.inserts||[],l.forEach(l.range(t,t+o+1),function(e){n.inserts[e]={style:a}})}),e}},{key:"_saveMergeCells",value:function(){if(this._mergedCells.length>0){var e=this._mergedCells.map(function(e){return c({name:"mergeCell",attributes:[["ref",u.canonCell(e[0])+":"+u.canonCell(e[1])]]})});return c({name:"mergeCells",attributes:[["count",this._mergedCells.length]],children:e})}return""}}]),t}(f);t.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":26,"./drawing":28}],32:[function(e,t,n){(function(n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,
r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u="undefined"!=typeof window?window._:void 0!==n?n._:null,f=e("./sheetView"),c=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"_prepare",value:function(){this._prepareTables(),this._prepareColumns(),this._prepareRows(),this._prepareData()}},{key:"_prepareColumns",value:function(){var e=this;this.preparedColumns=this.columns.map(function(t){if(t){var n=u.clone(t);if(t.style){var r=e.styles.addFormat(t.style);n.style=r;var o=e.styles._addFillOutFormat(r);n.styleId=e.styles._getId(o)}return n}}),this.columns=null}},{key:"_prepareRows",value:function(){var e=this;this.preparedRows=this.rows.map(function(t){if(t){var n=u.clone(t);return t.style&&(n.style=e.styles.addFormat(t.style)),n}}),this.rows=null}},{key:"_prepareData",value:function(){this.maxX=0,this.preparedData=[];for(var e=0;e<this.data.length;e++){var t=this._prepareDataRow(e);this.preparedData.push(t),this.maxX=Math.max(this.maxX,t.length)}this.maxY=this.preparedData.length,this.data=null}},{key:"_prepareDataRow",value:function(e){var t=[],n=this.preparedRows[e],r=this.data[e];if(r){var o=null,i=!1,a=[];u.isArray(r)||(n=this._mergeDataRowToRow(n,r),r.inserts?(a=r.inserts,r=u.clone(r.data)):r=r.data),n&&(o=n.style||null,i=n.skipColumnsStyle),r=this._splitDataRow(n,r,e);for(var s=0,l=0;l<r.length||s<a.length;s++){var f=this.preparedColumns[s],c=!i&&f?f.style:null,h=void 0;a[s]?h={style:a[s].style,type:"empty"}:(h=r[l],l++);var d=this._readCellValue(h),p=d.cellValue,m=d.cellType,y=d.cellStyle;d.isObject&&(this._insertHyperlink(s,e,h.hyperlink),this._insertDrawing(s,e,h.image),r=this._mergeCells(r,s,e,h)),t[s]=this._getPreparedCell(this.styles._getId(this.styles._merge(c,o,y)),this._getCellType(m,p,n,f),p)}}return n&&(this._setRowStyleId(n),this.preparedRows[e]=n),t}},{key:"_mergeDataRowToRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return e.height=t.height||e.height,e.outlineLevel=t.outlineLevel||e.outlineLevel,e.type=t.type||e.type,e.style=t.style?this.styles.addFormat(t.style):e.style,e.skipColumnsStyle=t.skipColumnsStyle||e.skipColumnsStyle,e}},{key:"_splitDataRow",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,o=arguments[1],i=arguments[2],a=this._calcDataRowHeight(o);if(0===a)return o;var s=u.times(a,function(){var e=u.clone(t);return e.data=[],e});return u.forEach(o,function(e){var t=void 0,r=null;if(u.isArray(e)?t=e:u.isObject(e)&&!u.isDate(e)&&u.isArray(e.value)&&(t=e.value,r=e.style),t){u(t).initial().forEach(function(e,t){s[t].data.push({value:e,style:r})});var o={value:u.last(t),style:r},i=t.length,l=i<a?n._addRowspan(o,a-i+1):o;s[t.length-1].data.push(l)}else s[0].data.push(n._addRowspan(e,a))}),(e=this.data).splice.apply(e,[i,1].concat(r(s))),s[0].data}},{key:"_calcDataRowHeight",value:function(e){var t=0;return u.forEach(e,function(e){u.isArray(e)?t=Math.max(e.length,t):u.isObject(e)&&!u.isDate(e)&&u.isArray(e.value)&&(t=Math.max(e.value.length,t))}),t}},{key:"_addRowspan",value:function(e,t){return u.isObject(e)&&!u.isDate(e)?(e=u.clone(e),e.rowspan=t,e.style=this.styles._merge({vertical:"top"},e.style),e):{value:e,rowspan:t,style:{vertical:"top"}}}},{key:"_readCellValue",value:function(e){var t=void 0,n=null,r=null,o=!1;return u.isDate(e)?(t=e,n="date"):e&&"object"===(void 0===e?"undefined":s(e))?(o=!0,e.style&&(r=e.style),e.formula?(t=e.formula,n="formula"):e.date?(t=e.date,n="date"):e.time?(t=e.time,n="time"):u.isDate(e.value)?(t=e.value,n="date"):(t=e.value,n=e.type)):t=e,{cellValue:t,cellType:n,cellStyle:r,isObject:o}}},{key:"_mergeCells",value:function(e,t,n,r){if(r.colspan||r.rowspan){var o=(r.colspan||1)-1,i=(r.rowspan||1)-1;if(o||i)return this.mergeCells({c:t+1,r:n+1},{c:t+1+o,r:n+1+i}),this._insertMergeCells(e,t,n,o,i,r.style)}return e}},{key:"_getCellType",value:function(e,t,n,r){return e||(n&&n.type?n.type:r&&r.type?r.type:"number"==typeof t?"number":"string"==typeof t?"string":void 0)}},{key:"_getPreparedCell",value:function(e,t,n){var r={styleId:e,value:null,formula:null,isString:!1};if("string"===t)r.value=this.common.strings.add(n),r.isString=!0;else if("date"===t||"time"===t){var o=u.isDate(n)?n.valueOf():n,i=25569+(o-this.timezoneOffset)/864e5;u.isFinite(i)?r.value=i:(r.value=this.common.strings.add(String(n)),r.isString=!0)}else"formula"===t?r.formula=u.escape(n):r.value=n;return r}},{key:"_setRowStyleId",value:function(e){if(e.style){var t=this.styles._addFillOutFormat(e.style);e.styleId=this.styles._getId(t)}}}]),t}(f);t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./sheetView":35}],33:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return e?d({name:"pageMargins",attributes:[["top",e.top],["bottom",e.bottom],["left",e.left],["right",e.right],["header",e.header],["footer",e.footer]]}):""}function i(e){return e?d({name:"pageSetup",attributes:[["orientation",e]]}):""}function a(e,t){if(e.length>0||t.length>0){var n=[];return e.length>0&&n.push(s(e)),t.length>0&&n.push(l(t)),d({name:"headerFooter",children:n})}return""}function s(e){return d({name:"oddHeader",value:u(e)})}function l(e){return d({name:"oddFooter",value:u(e)})}function u(e){return e=e||"",["&L",f(e[0]||""),"&C",f(e[1]||""),"&R",f(e[2]||"")].join("")}function f(e){if(h.isString(e))return'&"-,Regular"'.concat(e);if(h.isObject(e)&&!h.isArray(e)){var t="";if(e.font||e.bold){var n=e.bold?"Bold":"Regular";t+='&"'+(e.font||"-")+","+n+'"'}else t+='&"-,Regular"';return e.underline&&(t+="&U"),e.fontSize&&(t+="&"+e.fontSize),t+=e.text}return h.isArray(e)?h.reduce(e,function(e,t){return e.concat(f(t))},""):void 0}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h="undefined"!=typeof window?window._:void 0!==n?n._:null,d=e("../XMLString"),p=function(){function e(){r(this,e),this._headers=[],this._footers=[]}return c(e,[{key:"setHeader",value:function(e){if(!h.isArray(e))throw"Invalid argument type - setHeader expects an array of three instructions";return this._headers=e,this}},{key:"setFooter",value:function(e){if(!h.isArray(e))throw"Invalid argument type - setFooter expects an array of three instructions";return this._footers=e,this}},{key:"setPageMargin",value:function(e){return this._margin=h.defaults(e,{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3}),this}},{key:"setPageOrientation",value:function(e){return this._orientation=e,this}},{key:"setPrintTitleTop",value:function(e){return this._printTitles=this._printTitles||{},h.isObject(e)?(this._printTitles.topFrom=e[0],this._printTitles.topTo=e[1]):(this._printTitles.topFrom=0,this._printTitles.topTo=e-1),this}},{key:"setPrintTitleLeft",value:function(e){return this._printTitles=this._printTitles||{},h.isObject(e)?(this._printTitles.leftFrom=e[0],this._printTitles.leftTo=e[1]):(this._printTitles.leftFrom=0,this._printTitles.leftTo=e-1),this}},{key:"_savePrint",value:function(){return o(this._margin)+i(this._orientation)+a(this._headers,this._footers)}}]),e}();t.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],34:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return b.xmlPrefix+'<worksheet xmlns="'+b.schemas.spreadsheetml+'" xmlns:r="'+b.schemas.relationships+'" xmlns:mc="'+b.schemas.markupCompat+'">'+c(e.maxX,e.maxY)+e._saveSheetView()+h(e.preparedColumns)+"<sheetData>"}function s(e){return"</sheetData>"+e._saveMergeCells()+e._saveHyperlinks()+e._savePrint()+e._saveTables()+e._saveDrawing()+"</worksheet>"}function l(e){for(var t=e.preparedData,n=e.preparedRows,r="",o=0,i=t.length;o<i;o++)r+=u(t[o],n[o],o),t[o]=null;return r}function u(e,t,n){var r=[];if(e){var o=e.length;r=new Array(o);for(var i=0;i<o;i++){var a=e[i];if(a){var s=' r="'+b.positionToLetter(i+1,n+1)+'"';a.styleId&&(s+=' s="'+a.styleId+'"'),a.isString&&(s+=' t="s"'),m.isNil(a.value)?m.isNil(a.formula)?r[i]="<c"+s+"/>":r[i]="<c"+s+"><f>"+a.formula+"</f></c>":r[i]="<c"+s+"><v>"+a.value+"</v></c>"}}}return"<row"+f(t,n)+">"+r.join("")+"</row>"}function f(e,t){var n=' r="'+(t+1)+'"';return e&&(void 0!==e.height&&(n+=' customHeight="1" ht="'+e.height+'"'),e.styleId&&(n+=' customFormat="1" s="'+e.styleId+'"'),e.outlineLevel&&(n+=' outlineLevel="'+e.outlineLevel+'"')),n}function c(e,t){var n=[];return 0!==e?n.push(["ref","A1:"+b.positionToLetter(e,t)]):n.push(["ref","A1"]),v({name:"dimension",attributes:n})}function h(e){if(e.length){var t=e.map(function(e,t){e=e||{};var n=[["min",e.min||t+1],["max",e.max||t+1]];return e.hidden&&n.push(["hidden",1]),e.bestFit&&n.push(["bestFit",1]),(e.customWidth||e.width)&&n.push(["customWidth",1]),e.width?n.push(["width",e.width]):n.push(["width",9.140625]),e.styleId&&n.push(["style",e.styleId]),v({name:"col",attributes:n})});return v({name:"cols",children:t})}return""}var d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=e("stream").Readable,m="undefined"!=typeof window?window._:void 0!==n?n._:null,y=e("./prepareSave"),b=e("../util"),v=e("../XMLString"),g=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),d(t,[{key:"_save",value:function(e){return e?new w({worksheet:this}):a(this)+l(this)+s(this)}}]),t}(y),w=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.worksheet=e.worksheet,n.status=0,n.index=0,n.len=n.worksheet.preparedData.length,n}return i(t,e),d(t,[{key:"_read",value:function(e){var t=!1;if(0===this.status&&(t=!this.push(a(this.worksheet)),this.status=1),1===this.status){for(;this.index<this.len&&!t;)t=!this.push(this.packChunk(e));this.index===this.len&&(this.status=2)}2===this.status&&(this.push(s(this.worksheet)),this.push(null))}},{key:"packChunk",value:function(e){for(var t=this.worksheet,n=t.preparedData,r=t.preparedRows,o="";this.index<this.len&&o.length<e;)o+=u(n[this.index],r[this.index],this.index),n[this.index]=null,this.index++;return o}}]),t}(p||null);t.exports=g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":26,"./prepareSave":32,stream:1}],35:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return e?c({name:"pane",attributes:[["state",e.state],["xSplit",e.xSplit],["ySplit",e.ySplit],["topLeftCell",e.topLeftCell],["activePane",e.activePane]]}):""}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l="undefined"!=typeof window?window._:void 0!==n?n._:null,u=e("../util"),f=e("./hyperlinks"),c=e("../XMLString"),h=function(e){function t(e,n,i){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a._pane=null,a._attributes={defaultGridColor:{value:null,bool:!0},colorId:{value:null},rightToLeft:{value:null,bool:!0},showFormulas:{value:null,bool:!0},showGridLines:{value:null,bool:!0},showOutlineSymbols:{value:null,bool:!0},showRowColHeaders:{value:null,bool:!0},showRuler:{value:null,bool:!0},showWhiteSpace:{value:null,bool:!0},showZeros:{value:null,bool:!0},tabSelected:{value:null,bool:!0},topLeftCell:{value:null},view:{value:"normal"},windowProtection:{value:null,bool:!0},zoomScale:{value:null},zoomScaleNormal:{value:null},zoomScalePageLayoutView:{value:null},zoomScaleSheetLayoutView:{value:null}},l.forEach(i,function(e,t){"freeze"===t?a.freeze(e.col,e.row,e.cell,e.activePane):"split"===t?a.split(e.x,e.y,e.cell,e.activePane):a._attributes[t]&&(a._attributes[t].value=e)}),a}return i(t,e),s(t,[{key:"setAttribute",value:function(e,t){return this._attributes[e]&&(this._attributes[e].value=t),this}},{key:"freeze",value:function(e,t,n,r){return this._pane={state:"frozen",xSplit:e,ySplit:t,topLeftCell:u.canonCell(n)||u.positionToLetter(e+1,t+1),activePane:r||"bottomRight"},this}},{key:"split",value:function(e,t,n,r){return this._pane={state:"split",xSplit:20*e,ySplit:20*t,topLeftCell:u.canonCell(n)||"A1",activePane:r||"bottomRight"},this}},{key:"_saveSheetView",value:function(){var e=[["workbookViewId",0]];return l.forEach(this._attributes,function(t,n){var r=t.value;null!==r&&(t.bool&&(r=r?"true":"false"),e.push([n,r]))}),c({name:"sheetViews",children:[c({name:"sheetView",attributes:e,children:[a(this._pane)]})]})}}]),t}(f);t.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":26,"./hyperlinks":29}],36:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./print"),l=e("../table"),u=e("../XMLString"),f=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._tables=[],e}return i(t,e),a(t,[{key:"addTable",value:function(e){var t=new l(this,e);return this.common.addTable(t),this.relations.addRelation(t,"table"),this._tables.push(t),t}},{key:"_prepareTables",value:function(){var e=this;this._tables.forEach(function(t){t._prepare(e.data)})}},{key:"_saveTables",value:function(){var e=this;if(this._tables.length>0){var t=this._tables.map(function(t){return u({name:"tablePart",attributes:[["r:id",e.relations.getRelationshipId(t)]]})});return u({name:"tableParts",attributes:[["count",this._tables.length]],children:t})}return""}}]),t}(s);t.exports=f},{"../XMLString":2,"../table":25,"./print":33}]},{},[11])(11)});