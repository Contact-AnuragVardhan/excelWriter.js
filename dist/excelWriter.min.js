/*
excelWriter - Javascript module for generating Excel files
<https://github.com/anfilat/excelWriter.js>
(c) 2017 Andrey Filatkin
Dual licenced under the MIT license or GPLv3
*/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.excelWriter=t()}}(function(){return function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[s]={exports:{}};e[s][0].call(f.exports,function(t){var n=e[s][1][t];return r(n||t)},f,f.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,n){},{}],2:[function(t,e,n){(function(n){"use strict";function i(t){var e="<"+t.name,n="";return t.ns&&(e=s.xmlPrefix+e+' xmlns="'+s.schemas[t.ns]+'"'),t.attributes&&t.attributes.forEach(function(t){var n=r(t,2),i=n[0],s=n[1];e+=" "+i+'="'+o.escape(s)+'"'}),void 0!==t.value&&(n+=o.escape(t.value)),t.children&&(n+=t.children.join("")),e+=n?">"+n+"</"+t.name+">":"/>"}var r=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o="undefined"!=typeof window?window._:void 0!==n?n._:null,s=t("./util");e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":26}],3:[function(t,e,n){"use strict";function i(t){this.common=t,this.images=Object.create(null),this.imageByNames=Object.create(null),this.extensions=Object.create(null)}function r(t){switch(t.toLowerCase()){case"jpeg":case"jpg":return"image/jpeg";case"png":return"image/png";case"gif":return"image/gif";default:return null}}i.prototype={addImage:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments[2],i=this.images[t];if(i)n&&!this.imageByNames[n]&&(i.name=n,this.imageByNames[n]=i);else{var o=this.common.uniqueIdForSpace("image"),s="xl/media/image"+o+"."+e,a=r(e);n=n||"excelWriter"+o,i={objectId:"image"+o,data:t,name:n,contentType:a,extension:e,path:s},this.common.addPath(i,"/"+s),this.images[t]=i,this.imageByNames[n]=i,this.extensions[e]=a}return i.name},getImage:function(t){return this.imageByNames[t]},getImages:function(){return this.images},removeImages:function(){this.images=null,this.imageByNames=null},getExtensions:function(){return this.extensions}},e.exports=i},{}],4:[function(t,e,n){"use strict";function i(){this.idSpaces=Object.create(null),this.paths=Object.create(null),this.images=new r(this),this.strings=new o(this),this.addPath(this.strings,"sharedStrings.xml"),this.styles=new s(this),this.addPath(this.styles,"styles.xml"),this.worksheets=[],this.tables=[],this.drawings=[]}var r=t("./images"),o=t("./sharedStrings"),s=t("../styles");i.prototype={uniqueId:function(t){return t+this.uniqueIdForSpace(t)},uniqueIdForSpace:function(t){return this.idSpaces[t]||(this.idSpaces[t]=1),this.idSpaces[t]++},addPath:function(t,e){this.paths[t.objectId]=e},getPath:function(t){return this.paths[t.objectId]},addWorksheet:function(t){var e=this.worksheets.length+1,n="worksheets/sheet"+e+".xml",i="xl/worksheets/_rels/sheet"+e+".xml.rels";t.path="xl/"+n,t.relationsPath=i,this.worksheets.push(t),this.addPath(t,n)},getNewWorksheetDefaultName:function(){return"Sheet "+(this.worksheets.length+1)},setActiveWorksheet:function(t){this.activeWorksheet=t},addTable:function(t){var e=this.tables.length+1,n="xl/tables/table"+e+".xml";t.path=n,this.tables.push(t),this.addPath(t,"/"+n)},addDrawings:function(t){var e=this.drawings.length+1,n="xl/drawings/drawing"+e+".xml",i="xl/drawings/_rels/drawing"+e+".xml.rels";t.path=n,t.relationsPath=i,this.drawings.push(t),this.addPath(t,"/"+n)}},e.exports=i},{"../styles":18,"./images":3,"./sharedStrings":5}],5:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){this.objectId=t.uniqueId("SharedStrings"),this.strings=Object.create(null),this.stringArray=[],this.count=0}function a(t){return c.xmlPrefix+'<sst xmlns="'+c.schemas.spreadsheetml+'" count="'+t+'" uniqueCount="'+t+'">'}var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=t("stream").Readable,f="undefined"!=typeof window?window._:void 0!==n?n._:null,c=t("../util"),h=/^\s|\s$/;s.prototype={add:function(t){var e=this.strings[t];return void 0===e&&(e=this.count++,this.strings[t]=e,this.stringArray[e]=t),e},isStrings:function(){return this.count>0},save:function(t){if(this.strings=null,t)return new d({strings:this.stringArray});var e=a(this.count)+this.stringArray.map(function(t){return t=f.escape(t),h.test(t)?'<si><t xml:space="preserve">'+t+"</t></si>":"<si><t>"+t+"</t></si>"}).join("")+"</sst>";return this.stringArray=null,e}};var d=function(t){function e(t){i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.strings=t.strings,n.status=0,n.index=0,n.len=n.strings.length,n}return o(e,t),l(e,[{key:"_read",value:function(t){var e=!1;if(0===this.status&&(e=!this.push(a(this.len)),this.status=1),1===this.status){for(;this.index<this.len&&!e;)e=!this.push(this.packChunk(t));this.index===this.len&&(this.status=2)}2===this.status&&(this.push("</sst>"),this.push(null))}},{key:"packChunk",value:function(t){for(var e="";this.index<this.len&&e.length<t;){var n=f.escape(this.strings[this.index]);h.test(n)?e+='<si><t xml:space="preserve">'+n+"</t></si>":e+="<si><t>"+n+"</t></si>",this.strings[this.index]=null,this.index++}return e}}]),e}(u||null);e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":26,stream:1}],6:[function(t,e,n){(function(n){"use strict";function i(t){var e=void 0;r.isObject(t)?e=r.has(t,"cell")?r.isObject(t.cell)?{x:t.cell.c||1,y:t.cell.r||1}:o.letterToPosition(t.cell||""):{x:t.c||1,y:t.r||1}:(e=o.letterToPosition(t||""),t={});var n=e.x-1,i=e.y-1;this.from={x:n,y:i,xOff:o.pixelsToEMUs(t.left||0),yOff:o.pixelsToEMUs(t.top||0)},this.to={x:n+(t.cols||1),y:i+(t.rows||1),xOff:o.pixelsToEMUs(-t.right||0),yOff:o.pixelsToEMUs(-t.bottom||0)}}var r="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../util"),s=t("../XMLString");i.prototype={saveWithContent:function(t){return s({name:"xdr:twoCellAnchor",children:[s({name:"xdr:from",children:[s({name:"xdr:col",value:this.from.x}),s({name:"xdr:colOff",value:this.from.xOff}),s({name:"xdr:row",value:this.from.y}),s({name:"xdr:rowOff",value:this.from.yOff})]}),s({name:"xdr:to",children:[s({name:"xdr:col",value:this.to.x}),s({name:"xdr:colOff",value:this.to.xOff}),s({name:"xdr:row",value:this.to.y}),s({name:"xdr:rowOff",value:this.to.yOff})]}),t,s({name:"xdr:clientData"})]})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":26}],7:[function(t,e,n){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.left,n=void 0===e?0:e,i=t.top,o=void 0===i?0:i,s=t.width,a=void 0===s?0:s,l=t.height,u=void 0===l?0:l;this.x=r.pixelsToEMUs(n),this.y=r.pixelsToEMUs(o),this.width=r.pixelsToEMUs(a),this.height=r.pixelsToEMUs(u)}var r=t("../util"),o=t("../XMLString");i.prototype={saveWithContent:function(t){return o({name:"xdr:absoluteAnchor",children:[o({name:"xdr:pos",attributes:[["x",this.x],["y",this.y]]}),o({name:"xdr:ext",attributes:[["cx",this.width],["cy",this.height]]}),t,o({name:"xdr:clientData"})]})}},e.exports=i},{"../XMLString":2,"../util":26}],8:[function(t,e,n){(function(n){"use strict";function i(t){var e=void 0;r.isObject(t)?e=r.has(t,"cell")?r.isObject(t.cell)?{x:t.cell.c||1,y:t.cell.r||1}:o.letterToPosition(t.cell||""):{x:t.c||1,y:t.r||1}:(e=o.letterToPosition(t||""),t={}),this.x=e.x-1,this.y=e.y-1,this.xOff=o.pixelsToEMUs(t.left||0),this.yOff=o.pixelsToEMUs(t.top||0),this.width=o.pixelsToEMUs(t.width||0),this.height=o.pixelsToEMUs(t.height||0)}var r="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../util"),s=t("../XMLString");i.prototype={saveWithContent:function(t){return s({name:"xdr:oneCellAnchor",children:[s({name:"xdr:from",children:[s({name:"xdr:col",value:this.x}),s({name:"xdr:colOff",value:this.xOff}),s({name:"xdr:row",value:this.y}),s({name:"xdr:rowOff",value:this.yOff})]}),s({name:"xdr:ext",attributes:[["cx",this.width],["cy",this.height]]}),t,s({name:"xdr:clientData"})]})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":26}],9:[function(t,e,n){"use strict";function i(t){this.common=t,this.objectId=this.common.uniqueId("Drawings"),this.drawings=[],this.relations=new r(t)}var r=t("../relations"),o=t("../util"),s=t("../XMLString"),a=t("./picture");i.prototype={addImage:function(t,e,n){var i=this.common.images.getImage(t),r=this.relations.addRelation(i,"image"),o=new a(this.common,{image:i,imageRelationId:r,config:e,anchorType:n});this.drawings.push(o)},save:function(){var t=[["xmlns:a",o.schemas.drawing],["xmlns:r",o.schemas.relationships],["xmlns:xdr",o.schemas.spreadsheetDrawing]],e=this.drawings.map(function(t){return t.save()});return s({name:"xdr:wsDr",ns:"spreadsheetDrawing",attributes:t,children:e})}},e.exports=i},{"../XMLString":2,"../relations":12,"../util":26,"./picture":10}],10:[function(t,e,n){"use strict";function i(t,e){this.pictureId=t.uniqueIdForSpace("Picture"),this.image=e.image,this.imageRelationId=e.imageRelationId,this.createAnchor(e.anchorType,e.config)}var r=t("../util"),o=t("../XMLString"),s=t("./anchor"),a=t("./anchorOneCell"),l=t("./anchorAbsolute");i.prototype={createAnchor:function(t,e){switch(t){case"anchor":this.anchor=new s(e);break;case"oneCell":this.anchor=new a(e);break;case"absolute":this.anchor=new l(e)}},save:function(){return this.anchor.saveWithContent(o({name:"xdr:pic",children:[o({name:"xdr:nvPicPr",children:[o({name:"xdr:cNvPr",attributes:[["id",this.pictureId],["name",this.image.name]]}),o({name:"xdr:cNvPicPr",children:[o({name:"a:picLocks",attributes:[["noChangeAspect","1"],["noChangeArrowheads","1"]]})]})]}),o({name:"xdr:blipFill",children:[o({name:"a:blip",attributes:[["xmlns:r",r.schemas.relationships],["r:embed",this.imageRelationId]]}),o({name:"a:srcRect"}),o({name:"a:stretch",children:[o({name:"a:fillRect"})]})]}),o({name:"xdr:spPr",attributes:[["bwMode","auto"]],children:[o({name:"a:xfrm"}),o({name:"a:prstGeom",attributes:[["prst","rect"]]})]})]}))}},e.exports=i},{"../XMLString":2,"../util":26,"./anchor":6,"./anchorAbsolute":7,"./anchorOneCell":8}],11:[function(t,e,n){(function(n){"use strict";function i(){var t=new a,e=t.common,n=e.styles,i=e.images,u=t.relations;return{addWorksheet:function(t){t=o.defaults(t,{name:e.getNewWorksheetDefaultName()});var n=l(this,e,t),i=n.outerWorksheet,r=n.worksheet;return e.addWorksheet(r),u.addRelation(r,"worksheet"),i},addFormat:function(t,e){return n.addFormat(t,e)},addFontFormat:function(t,e){return n.addFontFormat(t,e)},addBorderFormat:function(t,e){return n.addBorderFormat(t,e)},addPatternFormat:function(t,e){return n.addPatternFormat(t,e)},addGradientFormat:function(t,e){return n.addGradientFormat(t,e)},addNumberFormat:function(t,e){return n.addNumberFormat(t,e)},addTableFormat:function(t,e){return n.addTableFormat(t,e)},addTableElementFormat:function(t,e){return n.addTableElementFormat(t,e)},setDefaultTableStyle:function(t){return n.setDefaultTableStyle(t),this},addImage:function(t,e,n){return i.addImage(t,e,n)},save:function(e){var n=new s,i=!!r;return t.generateFiles(n,i),n.generateAsync(o.defaults(e,{compression:"DEFLATE",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",type:"base64"}))},saveAsNodeStream:function(e){var n=new s,i=!!r;return t.generateFiles(n,i),n.generateNodeStream(o.defaults(e,{compression:"DEFLATE"}))}}}var r=t("stream").Readable,o="undefined"!=typeof window?window._:void 0!==n?n._:null,s="undefined"!=typeof window?window.JSZip:void 0!==n?n.JSZip:null,a=t("./workbook"),l=t("./worksheet");e.exports={createWorkbook:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./workbook":27,"./worksheet":30,stream:1}],12:[function(t,e,n){(function(n){"use strict";function i(t){this.common=t,this.relations=Object.create(null),this.lastId=1}var r="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("./util"),s=t("./XMLString");i.prototype={addRelation:function(t,e){var n=this.relations[t.objectId];if(n)return n.relationId;var i="rId"+this.lastId++;return this.relations[t.objectId]={relationId:i,schema:o.schemas[e],object:t},i},getRelationshipId:function(t){var e=this.relations[t.objectId];return e?e.relationId:null},save:function(){var t=this.common,e=r.map(this.relations,function(e){var n=[["Id",e.relationId],["Type",e.schema],["Target",e.object.target||t.getPath(e.object)]];return e.object.targetMode&&n.push(["TargetMode",e.object.targetMode]),s({name:"Relationship",attributes:n})});return s({name:"Relationships",ns:"relationshipPackage",children:e})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./util":26}],13:[function(t,e,n){(function(n){"use strict";function i(t){var e={};return s.has(t,"horizontal")&&s.includes(l,t.horizontal)&&(e.horizontal=t.horizontal),s.has(t,"vertical")&&s.includes(u,t.vertical)&&(e.vertical=t.vertical),s.has(t,"indent")&&(e.indent=t.indent),s.has(t,"justifyLastLine")&&(e.justifyLastLine=t.justifyLastLine?1:0),s.has(t,"readingOrder")&&s.includes([0,1,2],t.readingOrder)&&(e.readingOrder=t.readingOrder),s.has(t,"relativeIndent")&&(e.relativeIndent=t.relativeIndent),s.has(t,"shrinkToFit")&&(e.shrinkToFit=t.shrinkToFit?1:0),s.has(t,"textRotation")&&(e.textRotation=t.textRotation),s.has(t,"wrapText")&&(e.wrapText=t.wrapText?1:0),s.isEmpty(e)?null:e}function r(t,e){return s.assign(t,e)}function o(t){return a({name:"alignment",attributes:s.toPairs(t)})}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,a=t("../XMLString"),l=["left","center","right","fill","justify","centerContinuous","distributed"],u=["top","center","bottom","justify","distributed"];e.exports={canon:i,merge:r,saveFormat:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],14:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a="undefined"!=typeof window?window._:void 0!==n?n._:null,l=t("./stylePart"),u=t("./utils"),f=u.saveColor,c=t("../XMLString"),h=["left","right","top","bottom"],d=["left","right","top","bottom","diagonal"],p=function(t){function e(t){i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"borders","border"));return n.init(),n.lastId=n.formats.length,n}return o(e,t),s(e,[{key:"init",value:function(){this.formats.push({format:this.canon({})})}},{key:"canon",value:function(t){return e.canon(t)}},{key:"merge",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.canon({}),n=arguments[1];return n&&d.forEach(function(e){var i=n[e];i&&i.style&&(t[e].style=i.style),i&&i.color&&(t[e].color=i.color)}),t}},{key:"saveFormat",value:function(t,n){return e.saveFormat(t,n)}}],[{key:"canon",value:function(t){var e={};return a.has(t,"style")||a.has(t,"color")?h.forEach(function(n){e[n]={style:t.style,color:t.color}}):d.forEach(function(n){var i=t[n];e[n]=i?{style:i.style,color:i.color}:{}}),e}},{key:"saveFormat",value:function(t){var e=d.map(function(e){var n=t[e],i=void 0,r=void 0;return n&&(n.style&&(i=[["style",n.style]]),n.color&&(r=[f(n.color)])),c({name:e,attributes:i,children:r})});return c({name:"border",children:e})}}]),e}(l);e.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":21,"./utils":24}],15:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a="undefined"!=typeof window?window._:void 0!==n?n._:null,l=t("./stylePart"),u=t("./alignment"),f=t("./protection"),c=t("../XMLString"),h=["format","fill","border","font"],d=["numFmtId","fillId","borderId","fontId"],p=function(t){function e(t){i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"cellXfs","format"));return n.init(),n.lastId=n.formats.length,n.saveEmpty=!1,n}return o(e,t),s(e,[{key:"init",value:function(){this.formats.push({format:this.canon({})})}},{key:"canon",value:function(t,e){var n={};t.format&&(n.format=this.styles.numberFormats.add(t.format)),t.font&&(n.font=this.styles.fonts.add(t.font)),t.pattern?n.fill=this.styles.fills.add(t.pattern,null,{fillType:"pattern"}):t.gradient?n.fill=this.styles.fills.add(t.gradient,null,{fillType:"gradient"}):e&&e.merge&&t.fill&&(n.fill=this.styles.fills.add(t.fill,null,e)),t.border&&(n.border=this.styles.borders.add(t.border));var i=e&&e.merge?u.canon(t.alignment):u.canon(t);i&&(n.alignment=i);var r=e&&e.merge?f.canon(t.protection):f.canon(t);return r&&(n.protection=r),t.fillOut&&(n.fillOut=t.fillOut),n}},{key:"fullGet",value:function(t){t=this.getId(t)?this.get(t):this.canon(t);var e={};return t.format&&(e.format=this.styles.numberFormats.get(t.format)),t.font&&(e.font=a.clone(this.styles.fonts.get(t.font))),t.fill&&(e.fill=a.clone(this.styles.fills.get(t.fill))),t.border&&(e.border=a.clone(this.styles.borders.get(t.border))),t.alignment&&(e.alignment=a.clone(t.alignment)),t.protection&&(e.protection=a.clone(t.protection)),e}},{key:"cutVisible",value:function(t){var e={};return t.format&&(e.format=t.format),t.font&&(e.font=t.font),t.alignment&&(e.alignment=t.alignment),t.protection&&(e.protection=t.protection),e}},{key:"merge",value:function(t,e){return(t.format||e.format)&&(t.format=this.styles.numberFormats.merge(t.format,e.format)),(t.font||e.font)&&(t.font=this.styles.fonts.merge(t.font,e.font)),(t.fill||e.fill)&&(t.fill=this.styles.fills.merge(t.fill,e.fill)),(t.border||e.border)&&(t.border=this.styles.borders.merge(t.border,e.border)),(t.alignment||e.alignment)&&(t.alignment=u.merge(t.alignment,e.alignment)),(t.protection||e.protection)&&(t.protection=f.merge(t.protection,e.protection)),t}},{key:"saveFormat",value:function(t){var e=this.styles,n=[],i=[];return t.alignment&&(i.push(u.saveFormat(t.alignment)),n.push(["applyAlignment","true"])),t.protection&&(i.push(f.saveFormat(t.protection)),n.push(["applyProtection","true"])),a.forEach(t,function(t,i){if(a.includes(h,i)){var r=d[a.indexOf(h,i)];"format"===i?(n.push([r,e.numberFormats.getId(t)]),n.push(["applyNumberFormat","true"])):"fill"===i?(n.push([r,e.fills.getId(t)]),n.push(["applyFill","true"])):"border"===i?(n.push([r,e.borders.getId(t)]),n.push(["applyBorder","true"])):"font"===i&&(n.push([r,e.fonts.getId(t)]),n.push(["applyFont","true"]))}}),c({name:"xf",attributes:n,children:i})}}]),e}(l);e.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./alignment":13,"./protection":20,"./stylePart":21}],16:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){var e=[["patternType",t.patternType]],n=[p({name:"fgColor",attributes:[["rgb",h(t.fgColor)]]}),p({name:"bgColor",attributes:[["rgb",h(t.bgColor)]]})];return p({name:"patternFill",attributes:e,children:n})}function a(t){var e=[];t.degree?e.push(["degree",t.degree]):t.left&&(e.push(["type","path"]),e.push(["left",t.left]),e.push(["right",t.right]),e.push(["top",t.top]),e.push(["bottom",t.bottom]));var n=[p({name:"stop",attributes:[["position",0]],children:[d(t.start)]}),p({name:"stop",attributes:[["position",1]],children:[d(t.end)]})];return p({name:"gradientFill",attributes:e,children:n})}var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u="undefined"!=typeof window?window._:void 0!==n?n._:null,f=t("./stylePart"),c=t("./utils"),h=c.canonColor,d=c.saveColor,p=t("../XMLString"),m=["none","solid","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis"],y=function(t){function e(t){i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"fills","fill"));return n.init(),n.lastId=n.formats.length,n}return o(e,t),l(e,[{key:"init",value:function(){this.formats.push({format:this.canon({type:"none"},{fillType:"pattern"})},{format:this.canon({type:"gray125"},{fillType:"pattern"})})}},{key:"canon",value:function(t,n){return e.canon(t,n)}},{key:"merge",value:function(t,e){return e||t}},{key:"saveFormat",value:function(t){return e.saveFormat(t)}}],[{key:"canon",value:function(t,e){var n={fillType:e.merge?t.fillType:e.fillType};if("pattern"===n.fillType){var i=(e.merge?t.fgColor:t.color)||"FFFFFFFF",r=(e.merge?t.bgColor:t.backColor)||"FFFFFFFF",o=e.merge?t.patternType:t.type;n.patternType=u.includes(m,o)?o:"solid",e.isTable&&"solid"===n.patternType?(n.fgColor=r,n.bgColor=i):(n.fgColor=i,n.bgColor=r)}else u.has(t,"left")?(n.left=t.left||0,n.right=t.right||0,n.top=t.top||0,n.bottom=t.bottom||0):n.degree=t.degree||0,n.start=t.start||"FFFFFFFF",n.end=t.end||"FFFFFFFF";return n}},{key:"saveFormat",value:function(t){var e="pattern"===t.fillType?[s(t)]:[a(t)];return p({name:"fill",children:e})}}]),e}(f);e.exports=y}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":21,"./utils":24}],17:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a="undefined"!=typeof window?window._:void 0!==n?n._:null,l=t("./stylePart"),u=t("./utils"),f=u.saveColor,c=t("../XMLString"),h=function(t){function e(t){i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"fonts","font"));return n.init(),n.lastId=n.formats.length,n}return o(e,t),s(e,[{key:"init",value:function(){this.formats.push({format:this.canon({})})}},{key:"canon",value:function(t){return e.canon(t)}},{key:"merge",value:function(t,e){var n=a.assign(t,e);return n.color=e&&e.color||t&&t.color,n}},{key:"saveFormat",value:function(t,n){return e.saveFormat(t,n)}}],[{key:"canon",value:function(t){var e={};return a.has(t,"bold")&&(e.bold=!!t.bold),a.has(t,"italic")&&(e.italic=!!t.italic),t.superscript&&(e.vertAlign="superscript"),t.subscript&&(e.vertAlign="subscript"),t.underline&&(-1!==a.indexOf(["double","singleAccounting","doubleAccounting"],t.underline)?e.underline=t.underline:e.underline=!0),a.has(t,"strike")&&(e.strike=!!t.strike),t.outline&&(e.outline=!0),t.shadow&&(e.shadow=!0),t.size&&(e.size=t.size),t.color&&(e.color=t.color),t.fontName&&(e.fontName=t.fontName),e}},{key:"saveFormat",value:function(t){var e=[];if(t.size&&e.push(c({name:"sz",attributes:[["val",t.size]]})),t.fontName&&e.push(c({name:"name",attributes:[["val",t.fontName]]})),a.has(t,"bold")&&(t.bold?e.push(c({name:"b"})):e.push(c({name:"b",attributes:[["val",0]]}))),a.has(t,"italic")&&(t.italic?e.push(c({name:"i"})):e.push(c({name:"i",attributes:[["val",0]]}))),t.vertAlign&&e.push(c({name:"vertAlign",attributes:[["val",t.vertAlign]]})),t.underline){var n=null;!0!==t.underline&&(n=[["val",t.underline]]),e.push(c({name:"u",attributes:n}))}return a.has(t,"strike")&&(t.strike?e.push(c({name:"strike"})):e.push(c({name:"strike",attributes:[["val",0]]}))),t.shadow&&e.push(c({name:"shadow"})),t.outline&&e.push(c({name:"outline"})),t.color&&e.push(f(t.color)),c({name:"font",children:e})}}]),e}(l);e.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":21,"./utils":24}],18:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o="undefined"!=typeof window?window._:void 0!==n?n._:null,s=t("./numberFormats"),a=t("./fonts"),l=t("./fills"),u=t("./borders"),f=t("./cells"),c=t("./tables"),h=t("./tableElements"),d=t("../XMLString"),p=function(){function t(e){i(this,t),this.objectId=e.uniqueId("Styles"),this.numberFormats=new s(this),this.fonts=new a(this),this.fills=new l(this),this.borders=new u(this),this.cells=new f(this),this.tableElements=new h(this),this.tables=new c(this),this.defaultTableStyle=""}return r(t,[{key:"addFormat",value:function(t,e){return this.cells.add(t,e)}},{key:"_get",value:function(t){return this.cells.get(t)}},{key:"_getId",value:function(t){return this.cells.getId(t)}},{key:"_addFillOutFormat",value:function(t){if(this._get(t).fillOut)return t;var e=this.cells.cutVisible(this.cells.fullGet(t));return o.isEmpty(e)?void 0:this.addFormat(e)}},{key:"_merge",value:function(t,e,n){var i=Number(Boolean(t))+Number(Boolean(e))+Number(Boolean(n));if(0===i)return null;if(1===i)return this.cells.add(t||e||n);var r={};return t&&(r=this.cells.merge(r,this.cells.fullGet(t))),e&&(r=this.cells.merge(r,this.cells.fullGet(e))),n&&(r=this.cells.merge(r,this.cells.fullGet(n))),this.cells.add(r,null,{merge:!0})}},{key:"addFontFormat",value:function(t,e){return this.fonts.add(t,e)}},{key:"addBorderFormat",value:function(t,e){return this.borders.add(t,e)}},{key:"addPatternFormat",value:function(t,e){return this.fills.add(t,e,{fillType:"pattern"})}},{key:"addGradientFormat",value:function(t,e){return this.fills.add(t,e,{fillType:"gradient"})}},{key:"addNumberFormat",value:function(t,e){return this.numberFormats.add(t,e)}},{key:"addTableFormat",value:function(t,e){return this.tables.add(t,e)}},{key:"addTableElementFormat",value:function(t,e){return this.tableElements.add(t,e)}},{key:"setDefaultTableStyle",value:function(t){this.tables.defaultTableStyle=t}},{key:"save",value:function(){return d({name:"styleSheet",ns:"spreadsheetml",children:[this.numberFormats.save(),this.fonts.save(),this.fills.save(),this.borders.save(),this.cells.save(),this.tableElements.save(),this.tables.save()]})}}]),t}();e.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./borders":14,"./cells":15,"./fills":16,"./fonts":17,"./numberFormats":19,"./tableElements":22,"./tables":23}],19:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a="undefined"!=typeof window?window._:void 0!==n?n._:null,l=t("./stylePart"),u=t("../XMLString"),f={date:14,time:21},c=function(t){function e(t){i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"numFmts","numberFormat"));return n.init(),n.lastId=164,n}return o(e,t),s(e,[{key:"init",value:function(){var t=this;a.forEach(f,function(e,n){t.formatsByNames[n]={formatId:e,format:n}})}},{key:"canon",value:function(t){return e.canon(t)}},{
key:"merge",value:function(t,e){return e||t}},{key:"saveFormat",value:function(t,n){return e.saveFormat(t,n)}}],[{key:"canon",value:function(t){return t}},{key:"saveFormat",value:function(t,e){var n=[["numFmtId",e.formatId],["formatCode",t]];return u({name:"numFmt",attributes:n})}}]),e}(l);e.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":21}],20:[function(t,e,n){(function(n){"use strict";function i(t){var e={};return s.has(t,"locked")&&(e.locked=t.locked?1:0),s.has(t,"hidden")&&(e.hidden=t.hidden?1:0),s.isEmpty(e)?null:e}function r(t,e){return s.assign(t,e)}function o(t){return a({name:"protection",attributes:s.toPairs(t)})}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,a=t("../XMLString");e.exports={canon:i,merge:r,saveFormat:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],21:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o="undefined"!=typeof window?window._:void 0!==n?n._:null,s=t("../XMLString"),a=function(){function t(e,n,r){i(this,t),this.styles=e,this.saveName=n,this.formatName=r,this.lastName=1,this.lastId=0,this.saveEmpty=!0,this.formats=[],this.formatsByData=Object.create(null),this.formatsByNames=Object.create(null)}return r(t,[{key:"add",value:function(t,e,n){if(e&&this.formatsByNames[e]){var i=this.canon(t,n),r=o.isObject(i)?JSON.stringify(i):i;return r!==this.formatsByNames[e].stringFormat&&this._add(i,r,e),e}if(!e&&o.isString(t)&&this.formatsByNames[t])return t;var s=this.canon(t,n),a=o.isObject(s)?JSON.stringify(s):s,l=this.formatsByData[a];return l?e&&!this.formatsByNames[e]&&(l.name=e,this.formatsByNames[e]=l):l=this._add(s,a,e),l.name}},{key:"_add",value:function(t,e,n){n=n||this.formatName+this.lastName++;var i={name:n,formatId:this.lastId++,format:t,stringFormat:e};return this.formats.push(i),this.formatsByData[e]=i,this.formatsByNames[n]=i,i}},{key:"canon",value:function(t){return t}},{key:"get",value:function(t){if(o.isString(t)){var e=this.formatsByNames[t];return e?e.format:t}return t}},{key:"getId",value:function(t){var e=this.formatsByNames[t];return e?e.formatId:null}},{key:"save",value:function(){var t=this;if(!1!==this.saveEmpty||this.formats.length){var e=[["count",this.formats.length]],n=this.formats.map(function(e){return t.saveFormat(e.format,e)});return this.saveCollectionExt(e,n),s({name:this.saveName,attributes:e,children:n})}return""}},{key:"saveCollectionExt",value:function(){}},{key:"saveFormat",value:function(){return""}}]),t}();e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],22:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("./stylePart"),l=t("./numberFormats"),u=t("./fonts"),f=t("./fills"),c=t("./borders"),h=t("./alignment"),d=t("../XMLString"),p=function(t){function e(t){return i(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"dxfs","tableElement"))}return o(e,t),s(e,[{key:"canon",value:function(t){var e={};return t.format&&(e.format=l.canon(t.format)),t.font&&(e.font=u.canon(t.font)),t.pattern?e.fill=f.canon(t.pattern,{fillType:"pattern",isTable:!0}):t.gradient&&(e.fill=f.canon(t.gradient,{fillType:"gradient"})),t.border&&(e.border=c.canon(t.border)),e.alignment=h.canon(t),e}},{key:"saveFormat",value:function(t){var e=[];return t.font&&e.push(u.saveFormat(t.font)),t.fill&&e.push(f.saveFormat(t.fill)),t.border&&e.push(c.saveFormat(t.border)),t.format&&e.push(l.saveFormat(t.format)),t.alignment&&t.alignment.length&&e.push(h.save(t.alignment)),d({name:"dxf",children:e})}}]),e}(a);e.exports=p},{"../XMLString":2,"./alignment":13,"./borders":14,"./fills":16,"./fonts":17,"./numberFormats":19,"./stylePart":21}],23:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a="undefined"!=typeof window?window._:void 0!==n?n._:null,l=t("./stylePart"),u=t("../XMLString"),f=["wholeTable","headerRow","totalRow","firstColumn","lastColumn","firstRowStripe","secondRowStripe","firstColumnStripe","secondColumnStripe","firstHeaderCell","lastHeaderCell","firstTotalCell","lastTotalCell"],c=["firstRowStripe","secondRowStripe","firstColumnStripe","secondColumnStripe"],h=function(t){function e(t){i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"tableStyles","table"));return n.saveEmpty=!1,n}return o(e,t),s(e,[{key:"canon",value:function(t){var e={},n=this.styles;return a.forEach(t,function(t,i){if(a.includes(f,i)){var r=void 0,o=null;t.style?(r=n.tableElements.add(t.style),t.size>1&&a.includes(c,i)&&(o=t.size)):r=n.tableElements.add(t),e[i]={style:r,size:o}}}),e}},{key:"saveCollectionExt",value:function(t){this.styles.defaultTableStyle&&t.push(["defaultTableStyle",this.styles.defaultTableStyle])}},{key:"saveFormat",value:function(t,e){var n=this.styles,i=[["name",e.name],["pivot",0]],r=[];return a.forEach(t,function(t,e){var i=t.style,o=t.size,s=[["type",e],["dxfId",n.tableElements.getId(i)]];o&&s.push(["size",o]),r.push(u({name:"tableStyleElement",attributes:s}))}),i.push(["count",r.length]),u({name:"tableStyle",attributes:i,children:r})}}]),e}(l);e.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":21}],24:[function(t,e,n){(function(n){"use strict";function i(t){return"#"===t[0]?"FF"+t.substr(1):t}function r(t){if(o.isString(t))return s({name:"color",attributes:[["rgb",i(t)]]});var e=[];return o.isUndefined(t.tint)||e.push(["tint",t.tint]),o.isUndefined(t.auto)||e.push(["auto",!!t.auto]),o.isUndefined(t.theme)||e.push(["theme",t.theme]),s({name:"color",attributes:e})}var o="undefined"!=typeof window?window._:void 0!==n?n._:null,s=t("../XMLString");e.exports={canonColor:i,saveColor:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],25:[function(t,e,n){(function(n){"use strict";function i(t,e,n){var i=new r(n,e);return{outerTable:{end:function(){return t},setReferenceRange:function(t,e){return i.beginCell=a.canonCell(t),i.endCell=a.canonCell(e),this},addTotalRow:function(t){return i.totalRow=t,i.totalsRowCount=1,this},setTheme:function(t){return i.themeStyle=t,this},setSortState:function(t){return i.sortState=t,this}},table:i}}function r(t,e){this.common=e,this.tableId=this.common.uniqueIdForSpace("Table"),this.objectId="Table"+this.tableId,this.name=this.objectId,this.displayName=this.objectId,this.headerRowCount=1,this.beginCell=null,this.endCell=null,this.totalsRowCount=0,this.totalRow=null,this.themeStyle=null,s.extend(this,t)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s="undefined"!=typeof window?window._:void 0!==n?n._:null,a=t("./util"),l=t("./XMLString"),u=["average","countNums","count","max","min","stdDev","sum","var"],f=[101,102,103,104,105,107,109,110];r.prototype={prepare:function(t){if(this.totalRow){var e=this.name,n=a.letterToPosition(this.beginCell),i=a.letterToPosition(this.endCell),r=n.y-1,l=n.x-1,c=i.y-1,h=t[r]||[],d=t[c+1];d||(d=[],t[c+1]=d),s.forEach(this.totalRow,function(t,n){var i=h[l+n],r=void 0;"object"===(void 0===i?"undefined":o(i))&&(i=i.value),t.name=i,t.totalsRowLabel?d[l+n]={value:t.totalsRowLabel,type:"string"}:t.totalsRowFunction&&-1!==(r=s.indexOf(u,t.totalsRowFunction))&&(d[l+n]={value:"SUBTOTAL("+f[r]+","+e+"["+i+"])",type:"formula"})})}},save:function(){var t=[["id",this.tableId],["name",this.name],["displayName",this.displayName]],e=[],n=a.letterToPosition(this.endCell),i=this.beginCell+":"+a.positionToLetter(n.x,n.y+this.totalsRowCount);return t.push(["ref",i]),t.push(["totalsRowCount",this.totalsRowCount]),t.push(["headerRowCount",this.headerRowCount]),e.push(this.saveAutoFilter()),e.push(this.saveTableColumns()),e.push(this.saveTableStyleInfo()),l({name:"table",ns:"spreadsheetml",attributes:t,children:e})},saveAutoFilter:function(){return l({name:"autoFilter",attributes:["ref",this.beginCell+":"+this.endCell]})},saveTableColumns:function(){var t=[["count",this.totalRow.length]],e=s.map(this.totalRow,function(t,e){var n=[["id",e+1],["name",t.name]];return t.totalsRowFunction&&n.push(["totalsRowFunction",t.totalsRowFunction]),t.totalsRowLabel&&n.push(["totalsRowLabel",t.totalsRowLabel]),l({name:"tableColumn",attributes:n})});return l({name:"tableColumns",attributes:t,children:e})},saveTableStyleInfo:function(){var t=[["name",this.themeStyle]],e=this.common.styles.tables.get(this.themeStyle),n=!1,i=!1,r=!1,o=!1;return e&&(n=e.firstRowStripe||e.secondRowStripe,i=e.firstColumnStripe||e.secondColumnStripe,r=e.firstColumn,o=e.lastColumn),t.push(["showRowStripes",n?"1":"0"],["showColumnStripes",i?"1":"0"],["showFirstColumn",r?"1":"0"],["showLastColumn",o?"1":"0"]),l({name:"tableStyleInfo",attributes:t})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./util":26}],26:[function(t,e,n){(function(t){"use strict";function n(t,e){var n=s[t];if(!n){var i="",r=t,a=void 0;do{a=(r-1)%26,i=o[a]+i,r=(r-(a+1))/26}while(r>0);s[t]=i,n=i}return n+(e||"")}function i(t){for(var e=0,n=0,i=0,r=t.length;i<r;i++){var o=t.charCodeAt(i);if(!(o>=65)){n=parseInt(t.slice(i),10);break}e=26*e+o-64}return{x:e||1,y:n||1}}var r="undefined"!=typeof window?window._:void 0!==t?t._:null,o="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s={};e.exports={pixelsToEMUs:function(t){return Math.round(914400*t/96)},canonCell:function(t){return r.isObject(t)?n(t.c||1,t.r||1):t},positionToLetter:n,letterToPosition:i,xmlPrefix:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n',schemas:{worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(t,e,n){(function(n){"use strict";function i(){this.common=new s,this.styles=this.common.styles,this.images=this.common.images,this.relations=new a(this.common),this.relations.addRelation(this.common.styles,"stylesheet")}var r="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("./util"),s=t("./common"),a=t("./relations"),l=t("./XMLString");i.prototype={generateFiles:function(t,e){this.prepareWorksheets(),this.saveWorksheets(t,e),this.saveTables(t),this.saveImages(t),this.saveDrawings(t),this.saveStyles(t),this.saveStrings(t,e),t.file("[Content_Types].xml",this.createContentTypes()),t.file("_rels/.rels",this.createWorkbookRelationship()),t.file("xl/workbook.xml",this.save()),t.file("xl/_rels/workbook.xml.rels",this.relations.save())},save:function(){return l({name:"workbook",ns:"spreadsheetml",attributes:[["xmlns:r",o.schemas.relationships]],children:[this.bookViewsXML(),this.sheetsXML(),this.definedNamesXML()]})},bookViewsXML:function(){var t=0;if(this.common.activeWorksheet){var e=this.common.activeWorksheet.objectId;t=Math.max(t,this.common.worksheets.findIndex(function(t){return t.objectId===e}))}return l({name:"bookViews",children:[l({name:"workbookView",attributes:[["activeTab",t]]})]})},sheetsXML:function(){var t=this,e=this.common.worksheets.map(function(e,n){if(e.name.length>31)throw'Microsoft Excel requires work sheet names to be less than 32 characters long, work sheet name "'+e.name+'" is '+e.name.length+" characters long";return l({name:"sheet",attributes:[["name",e.name],["sheetId",n+1],["r:id",t.relations.getRelationshipId(e)],["state",e.getState()]]})});return l({name:"sheets",children:e})},definedNamesXML:function(){if(this.common.worksheets.some(function(t){return t.printTitles&&(t.printTitles.topTo>=0||t.printTitles.leftTo>=0)})){var t=[];return this.common.worksheets.forEach(function(e,n){var i=e.printTitles;if(i&&(i.topTo>=0||i.leftTo>=0)){var r=e.name,s="";i.topTo>=0&&(s=r+"!$"+(i.topFrom+1)+":$"+(i.topTo+1),i.leftTo>=0&&(s+=",")),i.leftTo>=0&&(s+=r+"!$"+o.positionToLetter(i.leftFrom+1)+":$"+o.positionToLetter(i.leftTo+1)),t.push(l({name:"definedName",value:s,attributes:[["name","_xlnm.Print_Titles"],["localSheetId",n]]}))}}),l({name:"definedNames",children:t})}return""},prepareWorksheets:function(){this.common.worksheets.forEach(function(t){t.prepare()})},saveWorksheets:function(t,e){this.common.worksheets.forEach(function(n){t.file(n.path,n.save(e)),t.file(n.relationsPath,n.relations.save())})},saveTables:function(t){this.common.tables.forEach(function(e){t.file(e.path,e.save())})},saveImages:function(t){r.forEach(this.images.getImages(),function(e){t.file(e.path,e.data,{base64:!0,binary:!0}),e.data=null}),this.images.removeImages()},saveDrawings:function(t){this.common.drawings.forEach(function(e){t.file(e.path,e.save()),t.file(e.relationsPath,e.relations.save())})},saveStyles:function(t){t.file("xl/styles.xml",this.styles.save())},saveStrings:function(t,e){this.common.strings.isStrings()&&(this.relations.addRelation(this.common.strings,"sharedStrings"),t.file("xl/sharedStrings.xml",this.common.strings.save(e)))},createContentTypes:function(){var t=[];return t.push(l({name:"Default",attributes:[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]]})),t.push(l({name:"Default",attributes:[["Extension","xml"],["ContentType","application/xml"]]})),t.push(l({name:"Override",attributes:[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]]})),this.common.strings.isStrings()&&t.push(l({name:"Override",attributes:[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]]})),t.push(l({name:"Override",attributes:[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]]})),this.common.worksheets.forEach(function(e,n){t.push(l({name:"Override",attributes:[["PartName","/xl/worksheets/sheet"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]}))}),this.common.tables.forEach(function(e,n){t.push(l({name:"Override",attributes:[["PartName","/xl/tables/table"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]}))}),r.forEach(this.common.images.getExtensions(),function(e,n){t.push(l({name:"Default",attributes:[["Extension",n],["ContentType",e]]}))}),this.common.drawings.forEach(function(e,n){t.push(l({name:"Override",attributes:[["PartName","/xl/drawings/drawing"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]}))}),l({name:"Types",ns:"contentTypes",children:t})},createWorkbookRelationship:function(){return l({name:"Relationships",ns:"relationshipPackage",children:[l({name:"Relationship",attributes:[["Id","rId1"],["Type",o.schemas.officeDocument],["Target","xl/workbook.xml"]]})]})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./common":4,"./relations":12,"./util":26}],28:[function(t,e,n){(function(n){"use strict";function i(t,e){this.common=t,this.relations=e,this.drawings=null}var r="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../drawings"),s=t("../XMLString");i.prototype={setImage:function(t,e){this.setDrawing(t,e,"anchor")},setImageOneCell:function(t,e){this.setDrawing(t,e,"oneCell")},setImageAbsolute:function(t,e){this.setDrawing(t,e,"absolute")},setDrawing:function(t,e,n){this.drawings||(this.drawings=new o(this.common),this.common.addDrawings(this.drawings),this.relations.addRelation(this.drawings,"drawingRelationship"));var i=r.isObject(t)?this.common.images.addImage(t.data,t.type):t;this.drawings.addImage(i,e,n)},insert:function(t,e,n){if(n){var i={c:t+1,r:e+1};if("string"==typeof n||n.data)this.setDrawing(n,i,"anchor");else{var r=n.config||{};r.cell=i,this.setDrawing(n.image,r,"anchor")}}},save:function(){return this.drawings?s({name:"drawing",attributes:[["r:id",this.relations.getRelationshipId(this.drawings)]]}):""}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../drawings":9}],29:[function(t,e,n){"use strict";function i(t,e){this.common=t,this.relations=e,this.hyperlinks=[]}var r=t("../util"),o=t("../XMLString");i.prototype={setHyperlink:function(t){t.objectId=this.common.uniqueId("hyperlink"),this.relations.addRelation({objectId:t.objectId,target:t.location,targetMode:t.targetMode||"External"},"hyperlink"),this.hyperlinks.push(t)},insert:function(t,e,n){if(n){var i={c:t+1,r:e+1};"string"==typeof n?this.setHyperlink({cell:i,location:n}):this.setHyperlink({cell:i,location:n.location,targetMode:n.targetMode,tooltip:n.tooltip})}},save:function(){var t=this;if(this.hyperlinks.length>0){var e=this.hyperlinks.map(function(e){var n=[["ref",r.canonCell(e.cell)],["r:id",t.relations.getRelationshipId(e)]];return e.tooltip&&n.push(["tooltip",e.tooltip]),o({name:"hyperlink",attributes:n})});return o({name:"hyperlinks",children:e})}return""}},e.exports=i},{"../XMLString":2,"../util":26}],30:[function(t,e,n){"use strict";function i(t,e,n){var i=new r(e,n),o={end:function(){return t},setActive:function(){return i.common.setActiveWorksheet(i),this},setVisible:function(){return this.setState("visible"),this},setHidden:function(){return this.setState("hidden"),this},setState:function(t){return i.setState(t),this},getState:function(){return i.getState()},setRows:function(t,e){return i.setRows(t,e),this},setRow:function(t,e){return i.setRow(t,e),this},setColumns:function(t,e){return i.setColumns(t,e),this},setColumn:function(t,e){return i.setColumn(t,e),this},setData:function(t,e){return i.setData(t,e),this},setAttribute:function(t,e){return i.sheetView.setAttribute(t,e),this},freeze:function(t,e,n,r){return i.sheetView.freeze(t,e,n,r),this},split:function(t,e,n,r){return i.sheetView.split(t,e,n,r),this},setHyperlink:function(t){return i.hyperlinks.setHyperlink(t),this},mergeCells:function(t,e){return i.mergedCells.mergeCells(t,e),this},setImage:function(t,e){return i.drawings.setImage(t,e),this},setImageOneCell:function(t,e){return i.drawings.setImageOneCell(t,e),this},setImageAbsolute:function(t,e){return i.drawings.setImageAbsolute(t,e),this},addTable:function(t){return i.tables.addTable(t)},setHeader:function(t){return i.setHeader(t),this},setFooter:function(t){return i.setFooter(t),this},setPageMargin:function(t){return i.setPageMargin(t),this},setPageOrientation:function(t){return i.setPageOrientation(t),this},setPrintTitleTop:function(t){return i.setPrintTitleTop(t),this},setPrintTitleLeft:function(t){return i.setPrintTitleLeft(t),this}};return i.outerWorksheet=o,{outerWorksheet:o,worksheet:i}}var r=t("./worksheet");e.exports=i},{"./worksheet":37}],31:[function(t,e,n){(function(n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t){this.worksheet=t,this.mergedCells=[]}var o="undefined"!=typeof window?window._:void 0!==n?n._:null,s=t("../util"),a=t("../XMLString");r.prototype={mergeCells:function(t,e){this.mergedCells.push([t,e])},insert:function(t,e,n,r,s,a){if(r&&(t=[].concat(i(t.slice(0,e+1)),i(o.times(r,function(){return{style:a,type:"empty"}})),i(t.slice(e+1)))),s){var l=this.worksheet.data;o.forEach(o.range(n+1,n+1+s),function(t){var n=l[t]||[];o.isArray(n)&&(n={data:n},l[t]=n),n.inserts=n.inserts||[],o.forEach(o.range(e,e+r+1),function(t){n.inserts[t]={style:a}})})}return t},save:function(){if(this.mergedCells.length>0){var t=this.mergedCells.map(function(t){return a({name:"mergeCell",attributes:[["ref",s.canonCell(t[0])+":"+s.canonCell(t[1])]]})});return a({name:"mergeCells",attributes:[["count",this.mergedCells.length]],children:t})}return""}},e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":26}],32:[function(t,e,n){(function(t){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r="undefined"!=typeof window?window._:void 0!==t?t._:null,o={prepare:function(){this.tables.prepare(),this.prepareColumns(),this.prepareRows(),this.prepareData()},prepareColumns:function(){var t=this;this.preparedColumns=this.columns.map(function(e){if(e){var n=r.clone(e);if(e.style){var i=t.styles.addFormat(e.style);n.style=i;var o=t.styles._addFillOutFormat(i);n.styleId=t.styles._getId(o)}return n}}),this.columns=null},prepareRows:function(){var t=this;this.preparedRows=this.rows.map(function(e){if(e){var n=r.clone(e);return e.style&&(n.style=t.styles.addFormat(e.style)),n}}),this.rows=null},prepareData:function(){this.maxX=0,this.preparedData=[];for(var t=0;t<this.data.length;t++){var e=this.prepareDataRow(t);this.preparedData.push(e),this.maxX=Math.max(this.maxX,e.length)}this.maxY=this.preparedData.length,this.data=null},prepareDataRow:function(t){var e=[],n=this.preparedRows[t],i=this.data[t];if(i){var o=null,s=!1,a=[];r.isArray(i)||(n=this.mergeDataRowToRow(n,i),i.inserts?(a=i.inserts,i=r.clone(i.data)):i=i.data),n&&(o=n.style||null,s=n.skipColumnsStyle),i=this.splitDataRow(n,i,t);for(var l=0,u=0;u<i.length||l<a.length;l++){var f=this.preparedColumns[l],c=!s&&f?f.style:null,h=void 0;a[l]?h={style:a[l].style,type:"empty"}:(h=i[u],u++);var d=this.readCellValue(h),p=d.cellValue,m=d.cellType,y=d.cellStyle;d.isObject&&(this.hyperlinks.insert(l,t,h.hyperlink),this.drawings.insert(l,t,h.image),i=this.mergeCells(i,l,t,h)),e[l]=this.getPreparedCell(this.styles._getId(this.styles._merge(c,o,y)),this.getCellType(m,p,n,f),p)}}return n&&(this.setRowStyleId(n),this.preparedRows[t]=n),e},mergeDataRowToRow:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];return t.height=e.height||t.height,t.outlineLevel=e.outlineLevel||t.outlineLevel,t.type=e.type||t.type,t.style=e.style?this.styles.addFormat(e.style):t.style,t.skipColumnsStyle=e.skipColumnsStyle||t.skipColumnsStyle,t},splitDataRow:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this,o=arguments[1],s=arguments[2],a=this.calcDataRowHeight(o);if(0===a)return o;var l=r.times(a,function(){var t=r.clone(e);return t.data=[],t});return r.forEach(o,function(t){var e=void 0,n=null;if(r.isArray(t)?e=t:r.isObject(t)&&!r.isDate(t)&&r.isArray(t.value)&&(e=t.value,n=t.style),e){r(e).initial().forEach(function(t,e){l[e].data.push({value:t,style:n})});var o={value:r.last(e),style:n},s=e.length,u=s<a?i.addRowspan(o,a-s+1):o;l[e.length-1].data.push(u)}else l[0].data.push(i.addRowspan(t,a))}),(t=this.data).splice.apply(t,[s,1].concat(n(l))),l[0].data},calcDataRowHeight:function(t){var e=0;return r.forEach(t,function(t){r.isArray(t)?e=Math.max(t.length,e):r.isObject(t)&&!r.isDate(t)&&r.isArray(t.value)&&(e=Math.max(t.value.length,e))}),e},addRowspan:function(t,e){return r.isObject(t)&&!r.isDate(t)?(t=r.clone(t),t.rowspan=e,t.style=this.styles._merge({vertical:"top"},t.style),t):{value:t,rowspan:e,style:{vertical:"top"}}},readCellValue:function(t){var e=void 0,n=null,o=null,s=!1;return r.isDate(t)?(e=t,n="date"):t&&"object"===(void 0===t?"undefined":i(t))?(s=!0,t.style&&(o=t.style),t.formula?(e=t.formula,n="formula"):t.date?(e=t.date,n="date"):t.time?(e=t.time,n="time"):r.isDate(t.value)?(e=t.value,n="date"):(e=t.value,n=t.type)):e=t,{cellValue:e,cellType:n,cellStyle:o,isObject:s}},mergeCells:function(t,e,n,i){if(i.colspan||i.rowspan){var r=(i.colspan||1)-1,o=(i.rowspan||1)-1;if(r||o)return this.mergedCells.mergeCells({c:e+1,r:n+1},{c:e+1+r,r:n+1+o}),this.mergedCells.insert(t,e,n,r,o,i.style)}return t},getCellType:function(t,e,n,i){return t||(n&&n.type?n.type:i&&i.type?i.type:"number"==typeof e?"number":"string"==typeof e?"string":void 0)},getPreparedCell:function(t,e,n){var i={styleId:t,value:null,formula:null,isString:!1};if("string"===e)i.value=this.common.strings.add(n),i.isString=!0;else if("date"===e||"time"===e){var o=r.isDate(n)?n.valueOf():n,s=25569+(o-this.timezoneOffset)/864e5;r.isFinite(s)?i.value=s:(i.value=this.common.strings.add(String(n)),i.isString=!0)}else"formula"===e?i.formula=r.escape(n):i.value=n;return i},setRowStyleId:function(t){if(t.style){var e=this.styles._addFillOutFormat(t.style);t.styleId=this.styles._getId(e)}}};e.exports={methods:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(t,e,n){(function(n){"use strict";function i(t){return t=t||"",["&L",r(t[0]||""),"&C",r(t[1]||""),"&R",r(t[2]||"")].join("")}function r(t){if(o.isString(t))return'&"-,Regular"'.concat(t);if(o.isObject(t)&&!o.isArray(t)){var e="";if(t.font||t.bold){var n=t.bold?"Bold":"Regular";e+='&"'+(t.font||"-")+","+n+'"'}else e+='&"-,Regular"';return t.underline&&(e+="&U"),t.fontSize&&(e+="&"+t.fontSize),e+=t.text}return o.isArray(t)?o.reduce(t,function(t,e){return t.concat(r(e))},""):void 0}var o="undefined"!=typeof window?window._:void 0!==n?n._:null,s=t("../XMLString"),a={setHeader:function(t){if(!o.isArray(t))throw"Invalid argument type - setHeader expects an array of three instructions";this.headers=t},setFooter:function(t){if(!o.isArray(t))throw"Invalid argument type - setFooter expects an array of three instructions";this.footers=t},setPageMargin:function(t){this.margin=o.defaults(t,{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3})},setPageOrientation:function(t){this.orientation=t},setPrintTitleTop:function(t){this.printTitles=this.printTitles||{},o.isObject(t)?(this.printTitles.topFrom=t[0],this.printTitles.topTo=t[1]):(this.printTitles.topFrom=0,this.printTitles.topTo=t-1)},setPrintTitleLeft:function(t){this.printTitles=this.printTitles||{},o.isObject(t)?(this.printTitles.leftFrom=t[0],this.printTitles.leftTo=t[1]):(this.printTitles.leftFrom=0,this.printTitles.leftTo=t-1)},savePrint:function(){return this.savePageMargins()+this.savePageSetup()+this.saveHeaderFooter()},savePageMargins:function(){var t=this.margin;return t?s({name:"pageMargins",attributes:[["top",t.top],["bottom",t.bottom],["left",t.left],["right",t.right],["header",t.header],["footer",t.footer]]}):""},savePageSetup:function(){var t=this.orientation;return t?s({name:"pageSetup",attributes:[["orientation",t]]}):""},saveHeaderFooter:function(){if(this.headers.length>0||this.footers.length>0){var t=[];return this.headers.length>0&&t.push(this.saveHeader()),this.footers.length>0&&t.push(this.saveFooter(this.footers)),s({name:"headerFooter",children:t})}return""},saveHeader:function(){return s({name:"oddHeader",value:i(this.headers)})},saveFooter:function(){return s({name:"oddFooter",value:i(this.footers)})}};e.exports={methods:a}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],34:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){return y.xmlPrefix+'<worksheet xmlns="'+y.schemas.spreadsheetml+'" xmlns:r="'+y.schemas.relationships+'" xmlns:mc="'+y.schemas.markupCompat+'">'+c(t.maxX,t.maxY)+t.sheetView.save()+h(t.preparedColumns)+"<sheetData>"}function a(t){return"</sheetData>"+t.mergedCells.save()+t.hyperlinks.save()+t.savePrint()+t.tables.save()+t.drawings.save()+"</worksheet>"}function l(t){for(var e=t.preparedData,n=t.preparedRows,i="",r=0,o=e.length;r<o;r++)i+=u(e[r],n[r],r),e[r]=null;return i}function u(t,e,n){var i=[];if(t){var r=t.length;i=new Array(r);for(var o=0;o<r;o++){var s=t[o];if(s){var a=' r="'+y.positionToLetter(o+1,n+1)+'"';s.styleId&&(a+=' s="'+s.styleId+'"'),s.isString&&(a+=' t="s"'),
m.isNil(s.value)?m.isNil(s.formula)?i[o]="<c"+a+"/>":i[o]="<c"+a+"><f>"+s.formula+"</f></c>":i[o]="<c"+a+"><v>"+s.value+"</v></c>"}}}return"<row"+f(e,n)+">"+i.join("")+"</row>"}function f(t,e){var n=' r="'+(e+1)+'"';return t&&(void 0!==t.height&&(n+=' customHeight="1" ht="'+t.height+'"'),t.styleId&&(n+=' customFormat="1" s="'+t.styleId+'"'),t.outlineLevel&&(n+=' outlineLevel="'+t.outlineLevel+'"')),n}function c(t,e){var n=[];return 0!==t?n.push(["ref","A1:"+y.positionToLetter(t,e)]):n.push(["ref","A1"]),g({name:"dimension",attributes:n})}function h(t){if(t.length){var e=t.map(function(t,e){t=t||{};var n=[["min",t.min||e+1],["max",t.max||e+1]];return t.hidden&&n.push(["hidden",1]),t.bestFit&&n.push(["bestFit",1]),(t.customWidth||t.width)&&n.push(["customWidth",1]),t.width?n.push(["width",t.width]):n.push(["width",9.140625]),t.styleId&&n.push(["style",t.styleId]),g({name:"col",attributes:n})});return g({name:"cols",children:e})}return""}var d=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),p=t("stream").Readable,m="undefined"!=typeof window?window._:void 0!==n?n._:null,y=t("../util"),g=t("../XMLString"),v={save:function(t){return t?new b({worksheet:this}):s(this)+l(this)+a(this)}},b=function(t){function e(t){i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.worksheet=t.worksheet,n.status=0,n.index=0,n.len=n.worksheet.preparedData.length,n}return o(e,t),d(e,[{key:"_read",value:function(t){var e=!1;if(0===this.status&&(e=!this.push(s(this.worksheet)),this.status=1),1===this.status){for(;this.index<this.len&&!e;)e=!this.push(this.packChunk(t));this.index===this.len&&(this.status=2)}2===this.status&&(this.push(a(this.worksheet)),this.push(null))}},{key:"packChunk",value:function(t){for(var e=this.worksheet,n=e.preparedData,i=e.preparedRows,r="";this.index<this.len&&r.length<t;)r+=u(n[this.index],i[this.index],this.index),n[this.index]=null,this.index++;return r}}]),e}(p||null);e.exports={methods:v}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":26,stream:1}],35:[function(t,e,n){(function(n){"use strict";function i(t){var e=this;this.pane=null,this.attributes={defaultGridColor:{value:null,bool:!0},colorId:{value:null},rightToLeft:{value:null,bool:!0},showFormulas:{value:null,bool:!0},showGridLines:{value:null,bool:!0},showOutlineSymbols:{value:null,bool:!0},showRowColHeaders:{value:null,bool:!0},showRuler:{value:null,bool:!0},showWhiteSpace:{value:null,bool:!0},showZeros:{value:null,bool:!0},tabSelected:{value:null,bool:!0},topLeftCell:{value:null},view:{value:"normal"},windowProtection:{value:null,bool:!0},zoomScale:{value:null},zoomScaleNormal:{value:null},zoomScalePageLayoutView:{value:null},zoomScaleSheetLayoutView:{value:null}},r.forEach(t,function(t,n){"freeze"===n?e.freeze(t.col,t.row,t.cell,t.activePane):"split"===n?e.split(t.x,t.y,t.cell,t.activePane):e.attributes[n]&&(e.attributes[n].value=t)})}var r="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../util"),s=t("../XMLString");i.prototype={setAttribute:function(t,e){this.attributes[t]&&(this.attributes[t].value=e)},freeze:function(t,e,n,i){this.pane={state:"frozen",xSplit:t,ySplit:e,topLeftCell:o.canonCell(n)||o.positionToLetter(t+1,e+1),activePane:i||"bottomRight"}},split:function(t,e,n,i){this.pane={state:"split",xSplit:20*t,ySplit:20*e,topLeftCell:o.canonCell(n)||"A1",activePane:i||"bottomRight"}},save:function(){var t=[["workbookViewId",0]];return r.forEach(this.attributes,function(e,n){var i=e.value;null!==i&&(e.bool&&(i=i?"true":"false"),t.push([n,i]))}),s({name:"sheetViews",children:[s({name:"sheetView",attributes:t,children:[this.savePane()]})]})},savePane:function(){var t=this.pane;return t?s({name:"pane",attributes:[["state",t.state],["xSplit",t.xSplit],["ySplit",t.ySplit],["topLeftCell",t.topLeftCell],["activePane",t.activePane]]}):""}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":26}],36:[function(t,e,n){"use strict";function i(t,e,n){this.worksheet=t,this.common=e,this.relations=n,this.tables=[]}var r=t("../table"),o=t("../XMLString");i.prototype={addTable:function(t){var e=r(this.worksheet.outerWorksheet,this.common,t),n=e.outerTable,i=e.table;return this.common.addTable(i),this.relations.addRelation(i,"table"),this.tables.push(i),n},prepare:function(){var t=this;this.tables.forEach(function(e){e.prepare(t.worksheet.data)})},save:function(){var t=this;if(this.tables.length>0){var e=this.tables.map(function(e){return o({name:"tablePart",attributes:[["r:id",t.relations.getRelationshipId(e)]]})});return o({name:"tableParts",attributes:[["count",this.tables.length]],children:e})}return""}},e.exports=i},{"../XMLString":2,"../table":25}],37:[function(t,e,n){"use strict";function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.common=t,this.styles=this.common.styles,this.objectId=this.common.uniqueId("Worksheet"),this.data=[],this.columns=[],this.rows=[],this.headers=[],this.footers=[],this.name=e.name,this.state=e.state||"visible",this.timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,this.relations=new h(this.common),this.tables=new r(this,this.common,this.relations),this.drawings=new o(this.common,this.relations),this.hyperlinks=new s(this.common,this.relations),this.mergedCells=new a(this),this.sheetView=new l(e)}var r=t("./tables"),o=t("./drawing"),s=t("./hyperlinks"),a=t("./mergedCells"),l=t("./sheetView"),u=t("./print"),f=t("./prepareSave"),c=t("./save"),h=t("../relations");i.prototype={setRows:function(t,e){var n=this;e?--t:(e=t,t=0),e.forEach(function(e,i){n.rows[t+i]=e})},setRow:function(t,e){this.rows[--t]=e},setColumns:function(t,e){var n=this;e?--t:(e=t,t=0),e.forEach(function(e,i){n.columns[t+i]=e})},setColumn:function(t,e){this.columns[--t]=e},setData:function(t,e){var n=this,i=this.data.length;e?i+=t:e=t,e.forEach(function(t,e){n.data[i+e]=t})},setState:function(t){this.state=t},getState:function(){return this.state}},Object.assign(i.prototype,u.methods),Object.assign(i.prototype,f.methods),Object.assign(i.prototype,c.methods),e.exports=i},{"../relations":12,"./drawing":28,"./hyperlinks":29,"./mergedCells":31,"./prepareSave":32,"./print":33,"./save":34,"./sheetView":35,"./tables":36}]},{},[11])(11)});