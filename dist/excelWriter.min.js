/*
excelWriter - Javascript module for generating Excel files
<https://github.com/anfilat/excelWriter.js>
(c) 2016 Andrey Filatkin
Dual licenced under the MIT license or GPLv3
*/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.excelWriter=t()}}(function(){return function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[s]={exports:{}};e[s][0].call(d.exports,function(t){var n=e[s][1][t];return o(n?n:t)},d,d.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){},{}],2:[function(t,e,n){(function(n){"use strict";function i(t){var e,n,i,s=t.name,a="<"+s,l="";if(t.ns&&(a=r.xmlPrefix+a+' xmlns="'+r.schemas[t.ns]+'"'),t.attributes)for(n=0,i=t.attributes.length;n<i;n++)e=t.attributes[n],a+=" "+e[0]+'="'+o.escape(e[1])+'"';return o.isUndefined(t.value)||(l+=o.escape(t.value)),t.children&&(l+=t.children.join("")),a+=l?">"+l+"</"+s+">":"/>"}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./util");e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":27}],3:[function(t,e,n){"use strict";e.exports={init:function(){this._images=Object.create(null),this._imageByNames=Object.create(null),this._extensions=Object.create(null)},methods:{addImage:function(t,e,n){var i=this._images[t];if(i)n&&!this._imageByNames[n]&&(i.name=n,this._imageByNames[n]=i);else{e=e||"";var o,r=this.uniqueIdSeparated("image").id,s="xl/media/image"+r+"."+e;switch(n=n||"excelWriter"+r,e.toLowerCase()){case"jpeg":case"jpg":o="image/jpeg";break;case"png":o="image/png";break;case"gif":o="image/gif";break;default:o=null}i={objectId:"image"+r,data:t,name:n,contentType:o,extension:e,path:s},this.addPath(i,"/"+s),this._images[t]=i,this._imageByNames[n]=i,this._extensions[e]=o}return i.name},getImage:function(t){return this._imageByNames[t]},getImages:function(){return this._images},removeImages:function(){this._images=null,this._imageByNames=null},getExtensions:function(){return this._extensions}}}},{}],4:[function(t,e,n){(function(n){"use strict";function i(){r.init.call(this),s.init.call(this),this.idSpaces=Object.create(null),this.sharedStrings=new a(this),this.addPath(this.sharedStrings,"sharedStrings.xml"),this.styles=new l(this),this.addPath(this.styles,"styles.xml"),this.worksheets=[],this.tables=[],this.drawings=[]}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./paths"),s=t("./images"),a=t("./sharedStrings"),l=t("../styles");o.assign(i.prototype,r.methods),o.assign(i.prototype,s.methods),i.prototype.uniqueId=function(t){return this.idSpaces[t]||(this.idSpaces[t]=1),t+this.idSpaces[t]++},i.prototype.uniqueIdSeparated=function(t){return this.idSpaces[t]||(this.idSpaces[t]=1),{space:t,id:this.idSpaces[t]++}},i.prototype.addString=function(t){return this.sharedStrings.add(t)},i.prototype.addWorksheet=function(t){var e=this.worksheets.length+1,n="worksheets/sheet"+e+".xml",i="xl/worksheets/_rels/sheet"+e+".xml.rels";t.path="xl/"+n,t.relationsPath=i,this.worksheets.push(t),this.addPath(t,n)},i.prototype.getNewWorksheetDefaultName=function(){return"Sheet "+(this.worksheets.length+1)},i.prototype.setActiveWorksheet=function(t){this.activeWorksheet=t},i.prototype.addTable=function(t){var e=this.tables.length+1,n="xl/tables/table"+e+".xml";t.path=n,this.tables.push(t),this.addPath(t,"/"+n)},i.prototype.addDrawings=function(t){var e=this.drawings.length+1,n="xl/drawings/drawing"+e+".xml",i="xl/drawings/_rels/drawing"+e+".xml.rels";t.path=n,t.relationsPath=i,this.drawings.push(t),this.addPath(t,"/"+n)},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../styles":19,"./images":3,"./paths":5,"./sharedStrings":6}],5:[function(t,e,n){"use strict";e.exports={init:function(){this._paths=Object.create(null)},methods:{addPath:function(t,e){this._paths[t.objectId]=e},getPath:function(t){return this._paths[t.objectId]}}}},{}],6:[function(t,e,n){(function(n){"use strict";function i(t){this.objectId=t.uniqueId("SharedStrings"),this._strings=Object.create(null),this._stringArray=[]}function o(t){a.call(this,t),this.strings=t.strings,this.status=0}function r(t){return u.xmlPrefix+'<sst xmlns="'+u.schemas.spreadsheetml+'" count="'+t+'" uniqueCount="'+t+'">'}function s(){return"</sst>"}var a=t("stream").Readable,l="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,u=t("../util");i.prototype.add=function(t){var e=this._strings[t];return void 0===e&&(e=this._stringArray.length,this._strings[t]=e,this._stringArray[e]=t),e},i.prototype.isEmpty=function(){return 0===this._stringArray.length},i.prototype.export=function(t){if(this._strings=null,t)return new o({strings:this._stringArray});var e=this._stringArray.length,n=l.map(this._stringArray,function(t){return"<si><t>"+l.escape(t)+"</t></si>"});return r(e)+n.join("")+s()},u.inherits(o,a||{}),o.prototype._read=function(t){var e=!1;if(0===this.status&&(e=!this.push(r(this.strings.length)),this.status=1,this.index=0,this.len=this.strings.length),1===this.status){for(var n="";this.index<this.len&&!e;){for(;this.index<this.len&&n.length<t;)n+="<si><t>"+l.escape(this.strings[this.index])+"</t></si>",this.strings[this.index]=null,this.index++;e=!this.push(n),n=""}this.index===this.len&&(this.status=2)}2===this.status&&(this.push(s()),this.push(null))},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":27,stream:1}],7:[function(t,e,n){(function(n){"use strict";function i(t){var e,n,i;o.isObject(t)?e=o.has(t,"cell")?o.isObject(t.cell)?{x:t.cell.c||1,y:t.cell.r||1}:r.letterToPosition(t.cell||""):{x:t.c||1,y:t.r||1}:(e=r.letterToPosition(t||""),t={}),n=e.x-1,i=e.y-1,this.from={x:n,y:i,xOff:r.pixelsToEMUs(t.left||0),yOff:r.pixelsToEMUs(t.top||0)},this.to={x:n+(t.cols||1),y:i+(t.rows||1),xOff:r.pixelsToEMUs(-t.right||0),yOff:r.pixelsToEMUs(-t.bottom||0)}}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("../util"),s=t("../XMLString");i.prototype.exportWithContent=function(t){return s({name:"xdr:twoCellAnchor",children:[s({name:"xdr:from",children:[s({name:"xdr:col",value:this.from.x}),s({name:"xdr:colOff",value:this.from.xOff}),s({name:"xdr:row",value:this.from.y}),s({name:"xdr:rowOff",value:this.from.yOff})]}),s({name:"xdr:to",children:[s({name:"xdr:col",value:this.to.x}),s({name:"xdr:colOff",value:this.to.xOff}),s({name:"xdr:row",value:this.to.y}),s({name:"xdr:rowOff",value:this.to.yOff})]}),t,s({name:"xdr:clientData"})]})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27}],8:[function(t,e,n){"use strict";function i(t){t=t||{},this.x=o.pixelsToEMUs(t.left||0),this.y=o.pixelsToEMUs(t.top||0),this.width=o.pixelsToEMUs(t.width||0),this.height=o.pixelsToEMUs(t.height||0)}var o=t("../util"),r=t("../XMLString");i.prototype.exportWithContent=function(t){return r({name:"xdr:absoluteAnchor",children:[r({name:"xdr:pos",attributes:[["x",this.x],["y",this.y]]}),r({name:"xdr:ext",attributes:[["cx",this.width],["cy",this.height]]}),t,r({name:"xdr:clientData"})]})},e.exports=i},{"../XMLString":2,"../util":27}],9:[function(t,e,n){(function(n){"use strict";function i(t){var e;o.isObject(t)?e=o.has(t,"cell")?o.isObject(t.cell)?{x:t.cell.c||1,y:t.cell.r||1}:r.letterToPosition(t.cell||""):{x:t.c||1,y:t.r||1}:(e=r.letterToPosition(t||""),t={}),this.x=e.x-1,this.y=e.y-1,this.xOff=r.pixelsToEMUs(t.left||0),this.yOff=r.pixelsToEMUs(t.top||0),this.width=r.pixelsToEMUs(t.width||0),this.height=r.pixelsToEMUs(t.height||0)}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("../util"),s=t("../XMLString");i.prototype.exportWithContent=function(t){return s({name:"xdr:oneCellAnchor",children:[s({name:"xdr:from",children:[s({name:"xdr:col",value:this.x}),s({name:"xdr:colOff",value:this.xOff}),s({name:"xdr:row",value:this.y}),s({name:"xdr:rowOff",value:this.yOff})]}),s({name:"xdr:ext",attributes:[["cx",this.width],["cy",this.height]]}),t,s({name:"xdr:clientData"})]})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27}],10:[function(t,e,n){(function(n){"use strict";function i(t){this.common=t,this.objectId=this.common.uniqueId("Drawings"),this.drawings=[],this.relations=new r(t)}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("../relations"),s=t("../util"),a=t("../XMLString"),l=t("./picture");i.prototype.addImage=function(t,e,n){var i=this.common.getImage(t),o=this.relations.addRelation(i,"image"),r=new l(this.common,{image:i,imageRelationId:o,config:e,anchorType:n});this.drawings.push(r)},i.prototype.export=function(){var t=[["xmlns:a",s.schemas.drawing],["xmlns:r",s.schemas.relationships],["xmlns:xdr",s.schemas.spreadsheetDrawing]],e=o.map(this.drawings,function(t){return t.export()});return a({name:"xdr:wsDr",ns:"spreadsheetDrawing",attributes:t,children:e})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../relations":13,"../util":27,"./picture":11}],11:[function(t,e,n){"use strict";function i(t,e){this.pictureId=t.uniqueIdSeparated("Picture").id,this.image=e.image,this.imageRelationId=e.imageRelationId,this.createAnchor(e.anchorType,e.config)}var o=t("../util"),r=t("../XMLString"),s=t("./anchor"),a=t("./anchorOneCell"),l=t("./anchorAbsolute");i.prototype.createAnchor=function(t,e){switch(t){case"anchor":this.anchor=new s(e);break;case"oneCell":this.anchor=new a(e);break;case"absolute":this.anchor=new l(e)}},i.prototype.export=function(){var t=r({name:"xdr:pic",children:[r({name:"xdr:nvPicPr",children:[r({name:"xdr:cNvPr",attributes:[["id",this.pictureId],["name",this.image.name]]}),r({name:"xdr:cNvPicPr",children:[r({name:"a:picLocks",attributes:[["noChangeAspect","1"],["noChangeArrowheads","1"]]})]})]}),r({name:"xdr:blipFill",children:[r({name:"a:blip",attributes:[["xmlns:r",o.schemas.relationships],["r:embed",this.imageRelationId]]}),r({name:"a:srcRect"}),r({name:"a:stretch",children:[r({name:"a:fillRect"})]})]}),r({name:"xdr:spPr",attributes:[["bwMode","auto"]],children:[r({name:"a:xfrm"}),r({name:"a:prstGeom",attributes:[["prst","rect"]]})]})]});return this.anchor.exportWithContent(t)},e.exports=i},{"../XMLString":2,"../util":27,"./anchor":7,"./anchorAbsolute":8,"./anchorOneCell":9}],12:[function(t,e,n){(function(n){"use strict";var i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o="undefined"!=typeof window?window.JSZip:"undefined"!=typeof n?n.JSZip:null,r=t("./workbook"),s={createWorkbook:function(){return new r},save:function(t,e){var n=new o,r=o.support.nodestream;return t._generateFiles(n,r),n.generateAsync(i.defaults(e,{compression:"DEFLATE",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",type:"base64"}))},saveAsNodeStream:function(t,e){var n=new o,r=o.support.nodestream;return t._generateFiles(n,r),n.generateNodeStream(i.defaults(e,{compression:"DEFLATE"}))}};e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./workbook":28}],13:[function(t,e,n){(function(n){"use strict";function i(t){this.common=t,this.relations=Object.create(null),this.lastId=1}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./util"),s=t("./XMLString");i.prototype.addRelation=function(t,e){var n,i=this.relations[t.objectId];return i?n=i.relationId:(n="rId"+this.lastId++,this.relations[t.objectId]={relationId:n,schema:r.schemas[e],object:t}),n},i.prototype.getRelationshipId=function(t){var e=this.relations[t.objectId];return e?e.relationId:null},i.prototype.export=function(){var t=this.common,e=o.map(this.relations,function(e){var n=[["Id",e.relationId],["Type",e.schema],["Target",e.object.target||t.getPath(e.object)]];return e.object.targetMode&&n.push(["TargetMode",e.object.targetMode]),s({name:"Relationship",attributes:n})});return s({name:"Relationships",ns:"relationshipPackage",children:e})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./util":27}],14:[function(t,e,n){(function(n){"use strict";function i(t){var e={};return s.has(t,"horizontal")&&s.includes(l,t.horizontal)&&(e.horizontal=t.horizontal),s.has(t,"vertical")&&s.includes(u,t.vertical)&&(e.vertical=t.vertical),s.has(t,"indent")&&(e.indent=t.indent),s.has(t,"justifyLastLine")&&(e.justifyLastLine=t.justifyLastLine?1:0),s.has(t,"readingOrder")&&s.includes([0,1,2],t.readingOrder)&&(e.readingOrder=t.readingOrder),s.has(t,"relativeIndent")&&(e.relativeIndent=t.relativeIndent),s.has(t,"shrinkToFit")&&(e.shrinkToFit=t.shrinkToFit?1:0),s.has(t,"textRotation")&&(e.textRotation=t.textRotation),s.has(t,"wrapText")&&(e.wrapText=t.wrapText?1:0),s.isEmpty(e)?void 0:e}function o(t,e){return s.assign(t,e)}function r(t){return a({name:"alignment",attributes:s.toPairs(t)})}var s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,a=t("../XMLString"),l=["left","center","right","fill","justify","centerContinuous","distributed"],u=["top","center","bottom","justify","distributed"];e.exports={canon:i,merge:o,export:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],15:[function(t,e,n){(function(n){"use strict";function i(t){a.call(this,t,"borders","border"),this.init(),this.lastId=this.formats.length}function o(t){var e={};return s.forEach(f,function(n){var i=t[n];i?e[n]={style:i.style,color:i.color}:e[n]={}}),e}function r(t){var e=s.map(f,function(e){var n,i,o=t[e];return o&&(o.style&&(n=[["style",o.style]]),o.color&&(i=[u.exportColor(o.color)])),d({name:e,attributes:n,children:i})});return d({name:"border",children:e})}var s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,a=t("./stylePart"),l=t("../util"),u=t("./utils"),d=t("../XMLString"),f=["left","right","top","bottom","diagonal"];l.inherits(i,a),i.prototype.init=function(){this.formats.push({format:this.canon({})})},i.prototype.canon=o,i.prototype.exportFormat=r,i.prototype.merge=function(t,e){return t=t||{},e&&s.forEach(f,function(n){var i=e[n];i&&(i.style||i.color)?t[n]={style:i.style,color:i.color}:t[n]||(t[n]={})}),t},e.exports={Borders:i,canon:o,exportFormat:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./stylePart":22,"./utils":25}],16:[function(t,e,n){(function(n){"use strict";function i(t){r.call(this,t,"cellXfs","format"),this.init(),this.lastId=this.formats.length,this.exportEmpty=!1}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./stylePart"),s=t("./alignment"),a=t("./protection"),l=t("../util"),u=t("../XMLString"),d=["format","fill","border","font"],f=["numFmtId","fillId","borderId","fontId"];l.inherits(i,r),i.prototype.init=function(){this.formats.push({format:this.canon({})})},i.prototype.canon=function(t){var e={};return t.format&&(e.format=this.styles.numberFormats.add(t.format)),t.font&&(e.font=this.styles.fonts.add(t.font)),t.pattern?e.fill=this.styles.fills.add(t.pattern,"pattern"):t.gradient?e.fill=this.styles.fills.add(t.gradient,"gradient"):t.fill&&(e.fill=this.styles.fills.add(t.fill,t.fillType)),t.border&&(e.border=this.styles.borders.add(t.border)),e.alignment=s.canon(t),e.protection=a.canon(t),e},i.prototype.fullGet=function(t){var e={};return t=this.get(t),t.format&&(e.format=this.styles.numberFormats.get(t.format)),t.font&&(e.font=o.clone(this.styles.fonts.get(t.font))),t.fill&&(e.fill=o.clone(this.styles.fills.get(t.fill))),t.border&&(e.border=o.clone(this.styles.borders.get(t.border))),t.alignment&&(e.alignment=o.clone(t.alignment)),t.protection&&(e.protection=o.clone(t.protection)),e},i.prototype.merge=function(t,e){return(t.format||e.format)&&(t.format=this.styles.numberFormats.merge(t.format,e.format)),(t.font||e.font)&&(t.font=this.styles.fonts.merge(t.font,e.font)),(t.fill||e.fill)&&(t.fill=this.styles.fills.merge(t.fill,e.fill)),(t.border||e.border)&&(t.border=this.styles.borders.merge(t.border,e.border)),(t.alignment||e.alignment)&&(t.alignment=s.merge(t.alignment,e.alignment)),(t.protection||e.protection)&&(t.protection=a.merge(t.protection,e.protection)),t},i.prototype.exportFormat=function(t){var e=this.styles,n=[],i=[];return t.alignment&&(i.push(s.export(t.alignment)),n.push(["applyAlignment","true"])),t.protection&&(i.push(a.export(t.protection)),n.push(["applyProtection","true"])),o.forEach(t,function(t,i){var r;o.includes(d,i)&&(r=f[o.indexOf(d,i)],"format"===i?(n.push([r,e.numberFormats.getId(t)]),n.push(["applyNumberFormat","true"])):"fill"===i?(n.push([r,e.fills.getId(t)]),n.push(["applyFill","true"])):"border"===i?(n.push([r,e.borders.getId(t)]),n.push(["applyBorder","true"])):"font"===i&&(n.push([r,e.fonts.getId(t)]),n.push(["applyFont","true"])))}),u({name:"xf",attributes:n,children:i})},e.exports={Cells:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./alignment":14,"./protection":21,"./stylePart":22}],17:[function(t,e,n){(function(n){"use strict";function i(t){u.call(this,t,"fills","fill"),this.init(),this.lastId=this.formats.length}function o(t,e,n){var i={fillType:e};if("pattern"===e){var o=t.color||t.fgColor||"FFFFFFFF",r=t.backColor||t.bgColor||"FFFFFFFF",s=t.type||t.patternType;i.patternType=l.includes(h,s)?s:"solid",n&&"solid"===i.patternType?(i.fgColor=r,i.bgColor=o):(i.fgColor=o,i.bgColor=r)}else l.has(t,"left")?(i.left=t.left||0,i.right=t.right||0,i.top=t.top||0,i.bottom=t.bottom||0):i.degree=t.degree||0,i.start=t.start||"FFFFFFFF",i.end=t.end||"FFFFFFFF";return i}function r(t){var e;return e="pattern"===t.fillType?[s(t)]:[a(t)],f({name:"fill",children:e})}function s(t){var e=[["patternType",t.patternType]],n=[f({name:"fgColor",attributes:[["rgb",t.fgColor]]}),f({name:"bgColor",attributes:[["rgb",t.bgColor]]})];return f({name:"patternFill",attributes:e,children:n})}function a(t){var e,n=[],i=[];return t.degree?n.push(["degree",t.degree]):t.left&&(n.push(["type","path"]),n.push(["left",t.left]),n.push(["right",t.right]),n.push(["top",t.top]),n.push(["bottom",t.bottom])),e=[["rgb",t.start]],i.push(f({name:"stop",attributes:[["position",0]],children:[f({name:"color",attributes:e})]})),e=[["rgb",t.end]],i.push(f({name:"stop",attributes:[["position",1]],children:[f({name:"color",attributes:e})]})),f({name:"gradientFill",attributes:n,children:i})}var l="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,u=t("./stylePart"),d=t("../util"),f=t("../XMLString"),h=["none","solid","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis"];d.inherits(i,u),i.prototype.init=function(){this.formats.push({format:this.canon({type:"none"},"pattern")},{format:this.canon({type:"gray125"},"pattern")})},i.prototype.canon=o,i.prototype.exportFormat=r,i.prototype.merge=function(t,e){return e||t},e.exports={Fills:i,canon:o,exportFormat:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./stylePart":22}],18:[function(t,e,n){(function(n){"use strict";function i(t){a.call(this,t,"fonts","font"),this.init(),this.lastId=this.formats.length}function o(t){var e={};return s.has(t,"bold")&&(e.bold=!!t.bold),s.has(t,"italic")&&(e.italic=!!t.italic),t.superscript&&(e.vertAlign="superscript"),t.subscript&&(e.vertAlign="subscript"),t.underline&&(s.indexOf(["double","singleAccounting","doubleAccounting"],t.underline)!==-1?e.underline=t.underline:e.underline=!0),s.has(t,"strike")&&(e.strike=!!t.strike),t.outline&&(e.outline=!0),t.shadow&&(e.shadow=!0),t.size&&(e.size=t.size),t.color&&(e.color=t.color),t.fontName&&(e.fontName=t.fontName),e}function r(t){var e,n=[];return t.size&&n.push(d({name:"sz",attributes:[["val",t.size]]})),t.fontName&&n.push(d({name:"name",attributes:[["val",t.fontName]]})),s.has(t,"bold")&&(t.bold?n.push(d({name:"b"})):n.push(d({name:"b",attributes:[["val",0]]}))),s.has(t,"italic")&&(t.italic?n.push(d({name:"i"})):n.push(d({name:"i",attributes:[["val",0]]}))),t.vertAlign&&n.push(d({name:"vertAlign",attributes:[["val",t.vertAlign]]})),t.underline&&(e=null,t.underline!==!0&&(e=[["val",t.underline]]),n.push(d({name:"u",attributes:e}))),s.has(t,"strike")&&(t.strike?n.push(d({name:"strike"})):n.push(d({name:"strike",attributes:[["val",0]]}))),t.shadow&&n.push(d({name:"shadow"})),t.outline&&n.push(d({name:"outline"})),t.color&&n.push(u.exportColor(t.color)),d({name:"font",children:n})}var s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,a=t("./stylePart"),l=t("../util"),u=t("./utils"),d=t("../XMLString");l.inherits(i,a),i.prototype.init=function(){this.formats.push({format:o({})})},i.prototype.canon=o,i.prototype.exportFormat=r,i.prototype.merge=function(t,e){var n=s.assign(t,e);return n.color=e&&e.color||t&&t.color,n},e.exports={Fonts:i,canon:o,exportFormat:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./stylePart":22,"./utils":25}],19:[function(t,e,n){"use strict";function i(t){this.objectId=t.uniqueId("Styles"),this.numberFormats=new o.NumberFormats(this),this.fonts=new r.Fonts(this),this.fills=new s.Fills(this),this.borders=new a.Borders(this),this.cells=new l.Cells(this),this.tableElements=new d.TableElements(this),this.tables=new u.Tables(this),this.defaultTableStyle=""}var o=t("./numberFormats"),r=t("./fonts"),s=t("./fills"),a=t("./borders"),l=t("./cells"),u=t("./tables"),d=t("./tableElements"),f=t("../XMLString");i.prototype.addFormat=function(t,e){return this.cells.add(t,null,e)},i.prototype._getId=function(t){return this.cells.getId(t)},i.prototype._merge=function(t,e,n){var i=Number(Boolean(t))+Number(Boolean(e))+Number(Boolean(n));if(0===i)return null;if(1===i)return this.cells.add(t||e||n);var o={};return t&&(o=this.cells.merge(o,this.cells.fullGet(t))),e&&(o=this.cells.merge(o,this.cells.fullGet(e))),n&&(o=this.cells.merge(o,this.cells.fullGet(n))),this.cells.add(o)},i.prototype.addFontFormat=function(t,e){return this.fonts.add(t,null,e)},i.prototype.addBorderFormat=function(t,e){return this.borders.add(t,null,e)},i.prototype.addPatternFormat=function(t,e){return this.fills.add(t,"pattern",e)},i.prototype.addGradientFormat=function(t,e){return this.fills.add(t,"gradient",e)},i.prototype.addNumberFormat=function(t,e){return this.numberFormats.add(t,null,e)},i.prototype.addTableFormat=function(t,e){return this.tables.add(t,null,e)},i.prototype.addTableElementFormat=function(t,e){return this.tableElements.add(t,null,e)},i.prototype.setDefaultTableStyle=function(t){this.tables.defaultTableStyle=t},i.prototype.export=function(){return f({name:"styleSheet",ns:"spreadsheetml",children:[this.numberFormats.export(),this.fonts.export(),this.fills.export(),this.borders.export(),this.cells.export(),this.tableElements.export(),this.tables.export()]})},e.exports=i},{"../XMLString":2,"./borders":15,"./cells":16,"./fills":17,"./fonts":18,"./numberFormats":20,"./tableElements":23,"./tables":24}],20:[function(t,e,n){(function(n){"use strict";function i(t){a.call(this,t,"numFmts","numberFormat"),this.init(),this.lastId=164}function o(t){return t}function r(t,e){var n=[["numFmtId",e.formatId],["formatCode",t]];return u({name:"numFmt",attributes:n})}var s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,a=t("./stylePart"),l=t("../util"),u=t("../XMLString"),d={date:14,time:21};l.inherits(i,a),i.prototype.init=function(){var t=this;s.forEach(d,function(e,n){t.formatsByNames[n]={formatId:e,format:n}})},i.prototype.canon=o,i.prototype.exportFormat=r,i.prototype.merge=function(t,e){return e||t},e.exports={NumberFormats:i,canon:o,exportFormat:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./stylePart":22}],21:[function(t,e,n){(function(n){"use strict";function i(t){var e={};return s.has(t,"locked")&&(e.locked=t.locked?1:0),s.has(t,"hidden")&&(e.hidden=t.hidden?1:0),s.isEmpty(e)?void 0:e}function o(t,e){return s.assign(t,e)}function r(t){return a({name:"protection",attributes:s.toPairs(t)})}var s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,a=t("../XMLString");e.exports={canon:i,merge:o,export:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],22:[function(t,e,n){(function(n){"use strict";function i(t,e,n){this.styles=t,this.exportName=e,this.formatName=n,this.lastName=1,this.lastId=0,this.exportEmpty=!0,this.formats=[],this.formatsByData={},this.formatsByNames={}}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("../XMLString");i.prototype.add=function(t,e,n){var i,r,s;return n&&this.formatsByNames[n]?(i=this.canon(t,e),r=o.isObject(i)?JSON.stringify(i):i,r!==this.formatsByNames[n].stringFormat&&this._add(i,r,n),n):!n&&o.isString(t)&&this.formatsByNames[t]?t:(i=this.canon(t,e||t.fillType),r=o.isObject(i)?JSON.stringify(i):i,s=this.formatsByData[r],s?n&&!this.formatsByNames[n]&&(s.name=n,this.formatsByNames[n]=s):s=this._add(i,r,n),s.name)},i.prototype._add=function(t,e,n){n=n||this.formatName+this.lastName++;var i={name:n,formatId:this.lastId++,format:t,stringFormat:e};return this.formats.push(i),this.formatsByData[e]=i,this.formatsByNames[n]=i,i},i.prototype.get=function(t){if(o.isString(t)){var e=this.formatsByNames[t];return e?e.format:t}return t},i.prototype.getId=function(t){var e=this.formatsByNames[t];return e?e.formatId:null},i.prototype.export=function(){if(this.exportEmpty!==!1||this.formats.length){var t=this,e=[["count",this.formats.length]],n=o.map(this.formats,function(e){return t.exportFormat(e.format,e)});return this.exportCollectionExt(e,n),r({name:this.exportName,attributes:e,children:n})}return""},i.prototype.canon=function(t){return t},i.prototype.exportCollectionExt=function(){},i.prototype.exportFormat=function(){return""},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],23:[function(t,e,n){"use strict";function i(t){o.call(this,t,"dxfs","tableElement")}var o=t("./stylePart"),r=t("../util"),s=t("./numberFormats"),a=t("./fonts"),l=t("./fills"),u=t("./borders"),d=t("./alignment"),f=t("../XMLString");r.inherits(i,o),i.prototype.canon=function(t){var e={};return t.format&&(e.format=s.canon(t.format)),t.font&&(e.font=a.canon(t.font)),t.pattern?e.fill=l.canon(t.pattern,"pattern","table"):t.gradient&&(e.fill=l.canon(t.gradient,"gradient")),t.border&&(e.border=u.canon(t.border)),e.alignment=d.canon(t),e},i.prototype.exportFormat=function(t){var e=[];return t.font&&e.push(a.exportFormat(t.font)),t.fill&&e.push(l.exportFormat(t.fill)),t.border&&e.push(u.exportFormat(t.border)),t.format&&e.push(s.exportFormat(t.format)),t.alignment&&t.alignment.length&&e.push(d.export(t.alignment)),f({name:"dxf",children:e})},e.exports={TableElements:i}},{"../XMLString":2,"../util":27,"./alignment":14,"./borders":15,"./fills":17,"./fonts":18,"./numberFormats":20,"./stylePart":22}],24:[function(t,e,n){(function(n){"use strict";function i(t){r.call(this,t,"tableStyles","table"),this.exportEmpty=!1}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./stylePart"),s=t("../util"),a=t("../XMLString"),l=["wholeTable","headerRow","totalRow","firstColumn","lastColumn","firstRowStripe","secondRowStripe","firstColumnStripe","secondColumnStripe","firstHeaderCell","lastHeaderCell","firstTotalCell","lastTotalCell"],u=["firstRowStripe","secondRowStripe","firstColumnStripe","secondColumnStripe"];s.inherits(i,r),i.prototype.canon=function(t){var e={},n=this.styles;return o.forEach(t,function(t,i){if(o.includes(l,i)){var r,s=null;t.style?(r=n.tableElements.add(t.style),t.size>1&&o.includes(u,i)&&(s=t.size)):r=n.tableElements.add(t),e[i]={style:r,size:s}}}),e},i.prototype.exportCollectionExt=function(t){this.styles.defaultTableStyle&&t.push(["defaultTableStyle",this.styles.defaultTableStyle])},i.prototype.exportFormat=function(t,e){var n=this.styles,i=[["name",e.name],["pivot",0]],r=[];return o.forEach(t,function(t,e){var i=t.style,o=t.size,s=[["type",e],["dxfId",n.tableElements.getId(i)]];o&&s.push(["size",o]),r.push(a({name:"tableStyleElement",attributes:s}))}),i.push(["count",r.length]),a({name:"tableStyle",attributes:i,children:r})},e.exports={Tables:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./stylePart":22}],25:[function(t,e,n){(function(n){"use strict";function i(t){var e;return o.isString(t)?r({name:"color",attributes:[["rgb",t]]}):(e=[],o.isUndefined(t.tint)||e.push(["tint",t.tint]),o.isUndefined(t.auto)||e.push(["auto",!!t.auto]),o.isUndefined(t.theme)||e.push(["theme",t.theme]),r({name:"color",attributes:e}))}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("../XMLString");e.exports={exportColor:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],26:[function(t,e,n){(function(n){"use strict";function i(t,e){this.worksheet=t,this.common=t.common;var n=this.common.uniqueIdSeparated("Table");this.tableId=n.id,this.objectId=n.space+n.id,this.name=this.objectId,this.displayName=this.objectId,this.headerRowBorderDxfId=null,this.headerRowCount=1,this.headerRowDxfId=null,this.beginCell=null,this.endCell=null,this.totalsRowCount=0,this.totalRow=null,this.themeStyle=null,a.extend(this,e)}function o(t,e){return u({name:"autoFilter",attributes:["ref",t+":"+e]})}function r(t){var e=[["count",t.length]],n=a.map(t,function(t,e){var n=[["id",e+1],["name",t.name]];return t.totalsRowFunction&&n.push(["totalsRowFunction",t.totalsRowFunction]),t.totalsRowLabel&&n.push(["totalsRowLabel",t.totalsRowLabel]),u({name:"tableColumn",attributes:n})});return u({name:"tableColumns",attributes:e,children:n})}function s(t,e){var n=[["name",e]],i=!1,o=!1,r=!1,s=!1,a=t.styles.tables.get(e);return a&&(i=a.firstRowStripe||a.secondRowStripe,o=a.firstColumnStripe||a.secondColumnStripe,r=a.firstColumn,s=a.lastColumn),n.push(["showRowStripes",i?"1":"0"],["showColumnStripes",o?"1":"0"],["showFirstColumn",r?"1":"0"],["showLastColumn",s?"1":"0"]),u({name:"tableStyleInfo",attributes:n})}var a="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=t("./util"),u=t("./XMLString");i.prototype.end=function(){return this.worksheet},i.prototype.setReferenceRange=function(t,e){return this.beginCell=l.canonCell(t),this.endCell=l.canonCell(e),this},i.prototype.addTotalRow=function(t){return this.totalRow=t,this.totalsRowCount=1,this},i.prototype.setTheme=function(t){return this.themeStyle=t,this},i.prototype.setSortState=function(t){return this.sortState=t,this},i.prototype._prepare=function(t){var e=["average","countNums","count","max","min","stdDev","sum","var"],n=[101,102,103,104,105,107,109,110];if(this.totalRow){var i=this.name,o=l.letterToPosition(this.beginCell),r=l.letterToPosition(this.endCell),s=o.y-1,u=o.x-1,d=r.y-1,f=t[s]||[],h=t[d+1];
h||(h=[],t[d+1]=h),a.forEach(this.totalRow,function(t,o){var r,s=f[u+o];"object"==typeof s&&(s=s.value),t.name=s,t.totalsRowLabel?h[u+o]={value:t.totalsRowLabel,type:"string"}:t.totalsRowFunction&&(r=a.indexOf(e,t.totalsRowFunction),r!==-1&&(h[u+o]={value:"SUBTOTAL("+n[r]+","+i+"["+s+"])",type:"formula"}))})}},i.prototype._export=function(){var t=[["id",this.tableId],["name",this.name],["displayName",this.displayName]],e=[],n=l.letterToPosition(this.endCell),i=this.beginCell+":"+l.positionToLetter(n.x,n.y+this.totalsRowCount);return t.push(["ref",i]),t.push(["totalsRowCount",this.totalsRowCount]),t.push(["headerRowCount",this.headerRowCount]),e.push(o(this.beginCell,this.endCell)),e.push(r(this.totalRow)),e.push(s(this.common,this.themeStyle)),u({name:"table",ns:"spreadsheetml",attributes:t,children:e})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./util":27}],27:[function(t,e,n){(function(t){"use strict";function n(t,e){var n=s[t];if(!n){var i,o="",a=t;do i=(a-1)%26,o=r[i]+o,a=(a-(i+1))/26;while(a>0);s[t]=o,n=o}return n+(e||"")}function i(t){var e,n,i,o=0,r=0;for(e=0,n=t.length;e<n;e++){if(i=t.charCodeAt(e),!(i>=65)){r=parseInt(t.slice(e),10);break}o=26*o+i-64}return{x:o||1,y:r||1}}var o="undefined"!=typeof window?window._:"undefined"!=typeof t?t._:null,r="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s={},a={inherits:function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n},pixelsToEMUs:function(t){return Math.round(914400*t/96)},canonCell:function(t){return o.isObject(t)?n(t.c||1,t.r||1):t},positionToLetter:n,letterToPosition:i,xmlPrefix:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n',schemas:{worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"}};e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(t,e,n){(function(n){"use strict";function i(){this.common=new w,this.styles=this.common.styles,this.relations=new b(this.common),this.objectId=this.common.uniqueId("Workbook")}function o(t){var e,n=0;return t.activeWorksheet&&(e=t.activeWorksheet.objectId,n=Math.max(n,y.findIndex(t.worksheets,function(t){return t.objectId===e}))),v({name:"bookViews",children:[v({name:"workbookView",attributes:[["activeTab",n]]})]})}function r(t,e){var n=31,i=y.map(e.worksheets,function(e,i){if(e.name.length>n)throw"Microsoft Excel requires work sheet names to be less than "+(n+1)+' characters long, work sheet name "'+e.name+'" is '+e.name.length+" characters long";return v({name:"sheet",attributes:[["name",e.name],["sheetId",i+1],["r:id",t.getRelationshipId(e)],["state",e.getState()]]})});return v({name:"sheets",children:i})}function s(t){var e=y.some(t.worksheets,function(t){return t._printTitles&&(t._printTitles.topTo>=0||t._printTitles.leftTo>=0)});if(e){var n=[];return y.forEach(t.worksheets,function(t,e){var i=t._printTitles;if(i&&(i.topTo>=0||i.leftTo>=0)){var o="",r=t.name;i.topTo>=0&&(o=r+"!$"+(i.topFrom+1)+":$"+(i.topTo+1),i.leftTo>=0&&(o+=",")),i.leftTo>=0&&(o+=r+"!$"+g.positionToLetter(i.leftFrom+1)+":$"+g.positionToLetter(i.leftTo+1)),n.push(v({name:"definedName",value:o,attributes:[["name","_xlnm.Print_Titles"],["localSheetId",e]]}))}}),v({name:"definedNames",children:n})}return""}function a(t){y.forEach(t.worksheets,function(t){t._prepare()})}function l(t,e,n){y.forEach(n.worksheets,function(n){t.file(n.path,n._export(e)),t.file(n.relationsPath,n.relations.export())})}function u(t,e){y.forEach(e.tables,function(e){t.file(e.path,e._export())})}function d(t,e){y.forEach(e.getImages(),function(e){t.file(e.path,e.data,{base64:!0,binary:!0}),e.data=null}),e.removeImages()}function f(t,e){y.forEach(e.drawings,function(e){t.file(e.path,e.export()),t.file(e.relationsPath,e.relations.export())})}function h(t,e,n){e.addRelation(n,"stylesheet"),t.file("xl/styles.xml",n.export())}function p(t,e,n,i){i.sharedStrings.isEmpty()||(n.addRelation(i.sharedStrings,"sharedStrings"),t.file("xl/sharedStrings.xml",i.sharedStrings.export(e)))}function c(t){var e=[];return e.push(v({name:"Default",attributes:[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]]})),e.push(v({name:"Default",attributes:[["Extension","xml"],["ContentType","application/xml"]]})),e.push(v({name:"Override",attributes:[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]]})),t.sharedStrings.isEmpty()||e.push(v({name:"Override",attributes:[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]]})),e.push(v({name:"Override",attributes:[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]]})),y.forEach(t.worksheets,function(t,n){e.push(v({name:"Override",attributes:[["PartName","/xl/worksheets/sheet"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]}))}),y.forEach(t.tables,function(t,n){e.push(v({name:"Override",attributes:[["PartName","/xl/tables/table"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]}))}),y.forEach(t.getExtensions(),function(t,n){e.push(v({name:"Default",attributes:[["Extension",n],["ContentType",t]]}))}),y.forEach(t.drawings,function(t,n){e.push(v({name:"Override",attributes:[["PartName","/xl/drawings/drawing"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]}))}),v({name:"Types",ns:"contentTypes",children:e})}function m(){return v({name:"Relationships",ns:"relationshipPackage",children:[v({name:"Relationship",attributes:[["Id","rId1"],["Type",g.schemas.officeDocument],["Target","xl/workbook.xml"]]})]})}var y="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,g=t("./util"),w=t("./common"),b=t("./relations"),x=t("./worksheet"),v=t("./XMLString");i.prototype.addWorksheet=function(t){var e;return t=y.defaults(t,{name:this.common.getNewWorksheetDefaultName()}),e=new x(this,t),this.common.addWorksheet(e),this.relations.addRelation(e,"worksheet"),e},i.prototype.addFormat=function(t,e){return this.styles.addFormat(t,e)},i.prototype.addFontFormat=function(t,e){return this.styles.addFontFormat(t,e)},i.prototype.addBorderFormat=function(t,e){return this.styles.addBorderFormat(t,e)},i.prototype.addPatternFormat=function(t,e){return this.styles.addPatternFormat(t,e)},i.prototype.addGradientFormat=function(t,e){return this.styles.addGradientFormat(t,e)},i.prototype.addNumberFormat=function(t,e){return this.styles.addNumberFormat(t,e)},i.prototype.addTableFormat=function(t,e){return this.styles.addTableFormat(t,e)},i.prototype.addTableElementFormat=function(t,e){return this.styles.addTableElementFormat(t,e)},i.prototype.setDefaultTableStyle=function(t){return this.styles.setDefaultTableStyle(t),this},i.prototype.addImage=function(t,e,n){return this.common.addImage(t,e,n)},i.prototype._generateFiles=function(t,e){a(this.common),l(t,e,this.common),u(t,this.common),d(t,this.common),f(t,this.common),h(t,this.relations,this.styles),p(t,e,this.relations,this.common),t.file("[Content_Types].xml",c(this.common)),t.file("_rels/.rels",m()),t.file("xl/workbook.xml",this._export()),t.file("xl/_rels/workbook.xml.rels",this.relations.export())},i.prototype._export=function(){return v({name:"workbook",ns:"spreadsheetml",attributes:[["xmlns:r",g.schemas.relationships]],children:[o(this.common),r(this.relations,this.common),s(this.common)]})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./common":4,"./relations":13,"./util":27,"./worksheet":32}],29:[function(t,e,n){(function(n){"use strict";var i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o=t("../drawings"),r=t("../XMLString");e.exports={init:function(){this._drawings=null},methods:{setImage:function(t,e){return this._setDrawing(t,e,"anchor")},setImageOneCell:function(t,e){return this._setDrawing(t,e,"oneCell")},setImageAbsolute:function(t,e){return this._setDrawing(t,e,"absolute")},_setDrawing:function(t,e,n){var r;return this._drawings||(this._drawings=new o(this.common),this.common.addDrawings(this._drawings),this.relations.addRelation(this._drawings,"drawingRelationship")),r=i.isObject(t)?this.common.addImage(t.data,t.type):t,this._drawings.addImage(r,e,n),this},_insertDrawing:function(t,e,n){var i;"string"==typeof n||n.data?this._setDrawing(n,{c:t+1,r:e+1},"anchor"):(i=n.config||{},i.cell={c:t+1,r:e+1},this._setDrawing(n.image,i,"anchor"))},_exportDrawing:function(){return this._drawings?r({name:"drawing",attributes:[["r:id",this.relations.getRelationshipId(this._drawings)]]}):""}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../drawings":10}],30:[function(t,e,n){(function(n){"use strict";function i(t){f.call(this,t),this.worksheet=t.worksheet,this.status=0}function o(t){return p.xmlPrefix+'<worksheet xmlns="'+p.schemas.spreadsheetml+'" xmlns:r="'+p.schemas.relationships+'" xmlns:mc="'+p.schemas.markupCompat+'">'+u(t.maxX,t.maxY)+t._exportSheetView()+d(t.preparedColumns)+"<sheetData>"}function r(t){return"</sheetData>"+t._exportMergeCells()+t._exportHyperlinks()+t._exportPrint()+t._exportTables()+t._exportDrawing()+"</worksheet>"}function s(t){for(var e=t.preparedData,n=t.preparedRows,i="",o=0,r=e.length;o<r;o++)i+=a(e[o],n[o],o),e[o]=null;return i}function a(t,e,n){var i,o,r,s,a=[];if(t)for(i=t.length,a=new Array(i),o=0;o<i;o++)r=t[o],r&&(s=' r="'+p.positionToLetter(o+1,n+1)+'"',r.styleId&&(s+=' s="'+r.styleId+'"'),r.isString&&(s+=' t="s"'),h.isNil(r.value)?h.isNil(r.formula)?a[o]="<c"+s+"/>":a[o]="<c"+s+"><f>"+r.formula+"</f></c>":a[o]="<c"+s+"><v>"+r.value+"</v></c>");return"<row"+l(e,n)+">"+a.join("")+"</row>"}function l(t,e){var n=' r="'+(e+1)+'"';return t&&(void 0!==t.height&&(n+=' customHeight="1"',n+=' ht="'+t.height+'"'),t.styleId&&(n+=' customFormat="1"',n+=' s="'+t.styleId+'"'),t.outlineLevel&&(n+=' outlineLevel="'+t.outlineLevel+'"')),n}function u(t,e){var n=[];return 0!==t?n.push(["ref","A1:"+p.positionToLetter(t,e)]):n.push(["ref","A1"]),c({name:"dimension",attributes:n})}function d(t){if(t.length){var e=h.map(t,function(t,e){t=t||{};var n=[["min",t.min||e+1],["max",t.max||e+1]];return t.hidden&&n.push(["hidden",1]),t.bestFit&&n.push(["bestFit",1]),(t.customWidth||t.width)&&n.push(["customWidth",1]),t.width?n.push(["width",t.width]):n.push(["width",9.140625]),t.styleId&&n.push(["style",t.styleId]),c({name:"col",attributes:n})});return c({name:"cols",children:e})}return""}var f=t("stream").Readable,h="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,p=t("../util"),c=t("../XMLString");e.exports={_export:function(t){return t?new i({worksheet:this}):o(this)+s(this)+r(this)}},p.inherits(i,f||{}),i.prototype._read=function(t){var e=!1,n=this.worksheet;if(0===this.status&&(e=!this.push(o(n)),this.status=1,this.index=0,this.len=n.preparedData.length),1===this.status){for(var i="",s=n.preparedData,l=n.preparedRows;this.index<this.len&&!e;){for(;this.index<this.len&&i.length<t;)i+=a(s[this.index],l[this.index],this.index),s[this.index]=null,this.index++;e=!this.push(i),i=""}this.index===this.len&&(this.status=2)}2===this.status&&(this.push(r(n)),this.push(null))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,stream:1}],31:[function(t,e,n){(function(n){"use strict";var i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o=t("../util"),r=t("../XMLString");e.exports={init:function(){this._hyperlinks=[]},methods:{setHyperlink:function(t){return t.objectId=this.common.uniqueId("hyperlink"),this.relations.addRelation({objectId:t.objectId,target:t.location,targetMode:t.targetMode||"External"},"hyperlink"),this._hyperlinks.push(t),this},_insertHyperlink:function(t,e,n){var i,o,r;"string"==typeof n?i=n:(i=n.location,o=n.targetMode,r=n.tooltip),this.setHyperlink({cell:{c:t+1,r:e+1},location:i,targetMode:o,tooltip:r})},_exportHyperlinks:function(){var t=this.relations;if(this._hyperlinks.length>0){var e=i.map(this._hyperlinks,function(e){var n=[["ref",o.canonCell(e.cell)],["r:id",t.getRelationshipId(e)]];return e.tooltip&&n.push(["tooltip",e.tooltip]),r({name:"hyperlink",attributes:n})});return r({name:"hyperlinks",children:e})}return""}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27}],32:[function(t,e,n){(function(n){"use strict";function i(t,e){e=e||{},this.workbook=t,this.common=t.common,r.init.call(this,e),s.init.call(this),a.init.call(this),u.init.call(this),d.init.call(this),l.init.call(this),this.objectId=this.common.uniqueId("Worksheet"),this.data=[],this.columns=[],this.rows=[],this.name=e.name,this.state=e.state||"visible",this.timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,this.relations=new p(this.common)}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./sheetView"),s=t("./hyperlinks"),a=t("./mergedCells"),l=t("./print"),u=t("./drawing"),d=t("./tables"),f=t("./prepareExport"),h=t("./export"),p=t("../relations");o.assign(i.prototype,f),o.assign(i.prototype,h),o.assign(i.prototype,r.methods),o.assign(i.prototype,s.methods),o.assign(i.prototype,a.methods),o.assign(i.prototype,u.methods),o.assign(i.prototype,d.methods),o.assign(i.prototype,l.methods),i.prototype.end=function(){return this.workbook},i.prototype.setActive=function(){return this.common.setActiveWorksheet(this),this},i.prototype.setVisible=function(){return this.setState("visible"),this},i.prototype.setHidden=function(){return this.setState("hidden"),this},i.prototype.setState=function(t){return this.state=t,this},i.prototype.getState=function(){return this.state},i.prototype.setRows=function(t,e){var n=this;return e?--t:(e=t,t=0),o.forEach(e,function(e,i){n.rows[t+i]=e}),this},i.prototype.setRow=function(t,e){return this.rows[--t]=e,this},i.prototype.setColumns=function(t,e){var n=this;return e?--t:(e=t,t=0),o.forEach(e,function(e,i){n.columns[t+i]=e}),this},i.prototype.setColumn=function(t,e){return this.columns[--t]=e,this},i.prototype.setData=function(t,e){var n=this;return e?--t:(e=t,t=0),o.forEach(e,function(e,i){n.data[t+i]=e}),this},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../relations":13,"./drawing":29,"./export":30,"./hyperlinks":31,"./mergedCells":33,"./prepareExport":34,"./print":35,"./sheetView":36,"./tables":37}],33:[function(t,e,n){(function(n){"use strict";var i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o=t("../util"),r=t("../XMLString");e.exports={init:function(){this._mergedCells=[]},methods:{mergeCells:function(t,e){return this._mergedCells.push([t,e]),this},_insertMergeCells:function(t,e,n,i,o){var r,s,a;if(i)for(s=0;s<i;s++)t.splice(e+1,0,{style:null,type:"empty"});if(o)for(i+=1,r=0;r<o;r++)if(a=this.data[n+r+1],a||(a=[],this.data[n+r+1]=a),a.length>e)for(s=0;s<i;s++)a.splice(e,0,{style:null,type:"empty"});else for(s=0;s<i;s++)a[e+s]={style:null,type:"empty"}},_exportMergeCells:function(){if(this._mergedCells.length>0){var t=i.map(this._mergedCells,function(t){return r({name:"mergeCell",attributes:[["ref",o.canonCell(t[0])+":"+o.canonCell(t[1])]]})});return r({name:"mergeCells",attributes:[["count",this._mergedCells.length]],children:t})}return""}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27}],34:[function(t,e,n){(function(t){"use strict";function n(t){var e=t.common.styles;a.forEach(t.columns,function(n,i){var o;n&&(o=a.clone(n),n.style&&(o.style=e.addFormat(n.style),o.styleId=e._getId(o.style)),t.preparedColumns[i]=o)})}function i(t){var e=t.common.styles;a.forEach(t.rows,function(n,i){var o;n&&(o=a.clone(n),n.style&&(o.style=e.addFormat(n.style)),t.preparedRows[i]=o)})}function o(t,e){var n,i,o,l,u,d,f,h,p,c=t.common,m=c.styles,y=t.preparedRows[e],g=t.data[e],w=[],b=null;if(g)for(a.isArray(g)||(y=r(t,y,g),g=g.data),y&&(b=y.style||null),i=0;i<g.length;i++)n=t.preparedColumns[i],o=g[i],a.isNil(o)||(u=null,f=null,h=!1,o&&"object"==typeof o?(o.style&&(u=o.style),o.formula?(l=o.formula,d="formula"):o.date?(l=o.date,d="date"):o.time?(l=o.time,d="time"):(l=o.value,d=o.type),s(t,g,o,i,e)):(l=o,d=null),u=m._merge(n?n.style:null,b,u),d||(d=n&&n.type?n.type:"number"==typeof l?"number":"string"),"string"===d?(l=c.addString(l),h=!0):"date"===d||"time"===d?(p=25569+(l-t.timezoneOffset)/864e5,a.isFinite(p)?l=p:(l=c.addString(String(l)),h=!0)):"formula"===d&&(f=a.escape(l),l=null),w[i]={value:l,formula:f,styleId:m._getId(u),isString:h});return t.preparedData[e]=w,y&&(y.styleId=m._getId(y.style),t.preparedRows[e]=y),w}function r(t,e,n){return e=e||{},e.height=n.height||e.height,e.style=n.style?t.common.styles.addFormat(n.style):e.style,e.outlineLevel=n.outlineLevel||e.outlineLevel,e}function s(t,e,n,i,o){var r,s;n.hyperlink&&t._insertHyperlink(i,o,n.hyperlink),n.image&&t._insertDrawing(i,o,n.image),(n.colspan||n.rowspan)&&(r=(n.colspan||1)-1,s=(n.rowspan||1)-1,t.mergeCells({c:i+1,r:o+1},{c:i+1+r,r:o+1+s}),t._insertMergeCells(e,i,o,r,s))}var a="undefined"!=typeof window?window._:"undefined"!=typeof t?t._:null;e.exports={_prepare:function(){var t,e,r,s=0;for(this.preparedData=[],this.preparedColumns=[],this.preparedRows=[],this._prepareTables(),n(this),i(this),t=0,e=this.data.length;t<e;t++)r=o(this,t),r.length>s&&(s=r.length);this.data=null,this.columns=null,this.rows=null,this.maxX=s,this.maxY=this.preparedData.length}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(t,e,n){(function(n){"use strict";function i(t){return t?f({name:"pageMargins",attributes:[["top",t.top],["bottom",t.bottom],["left",t.left],["right",t.right],["header",t.header],["footer",t.footer]]}):""}function o(t){return t?f({name:"pageSetup",attributes:[["orientation",t]]}):""}function r(t,e){if(t.length>0||e.length>0){var n=[];return t.length>0&&n.push(s(t)),e.length>0&&n.push(a(e)),f({name:"headerFooter",children:n})}return""}function s(t){return f({name:"oddHeader",value:l(t)})}function a(t){return f({name:"oddFooter",value:l(t)})}function l(t){return t=t||"",["&L",u(t[0]||""),"&C",u(t[1]||""),"&R",u(t[2]||"")].join("")}function u(t){if(d.isString(t))return'&"-,Regular"'.concat(t);if(d.isObject(t)&&!d.isArray(t)){var e="";if(t.font||t.bold){var n=t.bold?"Bold":"Regular";e+='&"'+(t.font||"-")+","+n+'"'}else e+='&"-,Regular"';return t.underline&&(e+="&U"),t.fontSize&&(e+="&"+t.fontSize),e+=t.text}return d.isArray(t)?d.reduce(t,function(t,e){return t.concat(u(e))},""):void 0}var d="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,f=t("../XMLString");e.exports={init:function(){this._headers=[],this._footers=[]},methods:{setHeader:function(t){if(!d.isArray(t))throw"Invalid argument type - setHeader expects an array of three instructions";return this._headers=t,this},setFooter:function(t){if(!d.isArray(t))throw"Invalid argument type - setFooter expects an array of three instructions";return this._footers=t,this},setPageMargin:function(t){return this._margin=d.defaults(t,{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3}),this},setPageOrientation:function(t){return this._orientation=t,this},setPrintTitleTop:function(t){return this._printTitles=this._printTitles||{},d.isObject(t)?(this._printTitles.topFrom=t[0],this._printTitles.topTo=t[1]):(this._printTitles.topFrom=0,this._printTitles.topTo=t-1),this},setPrintTitleLeft:function(t){return this._printTitles=this._printTitles||{},d.isObject(t)?(this._printTitles.leftFrom=t[0],this._printTitles.leftTo=t[1]):(this._printTitles.leftFrom=0,this._printTitles.leftTo=t-1),this},_exportPrint:function(){return i(this._margin)+o(this._orientation)+r(this._headers,this._footers)}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],36:[function(t,e,n){(function(n){"use strict";function i(t){return t?s({name:"pane",attributes:[["state",t.state],["xSplit",t.xSplit],["ySplit",t.ySplit],["topLeftCell",t.topLeftCell],["activePane",t.activePane]]}):""}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("../util"),s=t("../XMLString");e.exports={init:function(t){this._pane=null,this._attributes={defaultGridColor:{value:null,bool:!0},colorId:{value:null},rightToLeft:{value:null,bool:!0},showFormulas:{value:null,bool:!0},showGridLines:{value:null,bool:!0},showOutlineSymbols:{value:null,bool:!0},showRowColHeaders:{value:null,bool:!0},showRuler:{value:null,bool:!0},showWhiteSpace:{value:null,bool:!0},showZeros:{value:null,bool:!0},tabSelected:{value:null,bool:!0},topLeftCell:{value:null},view:{value:"normal"},windowProtection:{value:null,bool:!0},zoomScale:{value:null},zoomScaleNormal:{value:null},zoomScalePageLayoutView:{value:null},zoomScaleSheetLayoutView:{value:null}};var e=this;o.forEach(t,function(t,n){"freeze"===n?e.freeze(t.col,t.row,t.cell,t.activePane):"split"===n?e.split(t.x,t.y,t.cell,t.activePane):e._attributes[n]&&(e._attributes[n].value=t)})},methods:{setAttribute:function(t,e){return this._attributes[t]&&(this._attributes[t].value=e),this},freeze:function(t,e,n,i){return this._pane={state:"frozen",xSplit:t,ySplit:e,topLeftCell:r.canonCell(n)||r.positionToLetter(t+1,e+1),activePane:i||"bottomRight"},this},split:function(t,e,n,i){return this._pane={state:"split",xSplit:20*t,ySplit:20*e,topLeftCell:r.canonCell(n)||"A1",activePane:i||"bottomRight"},this},_exportSheetView:function(){var t=[["workbookViewId",0]];return o.forEach(this._attributes,function(e,n){var i=e.value;null!==i&&(e.bool&&(i=i?"true":"false"),t.push([n,i]))}),s({name:"sheetViews",children:[s({name:"sheetView",attributes:t,children:[i(this._pane)]})]})}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27}],37:[function(t,e,n){(function(n){"use strict";var i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o=t("../table"),r=t("../XMLString");e.exports={init:function(){this._tables=[]},methods:{addTable:function(t){var e=new o(this,t);return this.common.addTable(e),this.relations.addRelation(e,"table"),this._tables.push(e),e},_prepareTables:function(){var t=this.data;i.forEach(this._tables,function(e){e._prepare(t)})},_exportTables:function(){var t=this.relations;if(this._tables.length>0){var e=i.map(this._tables,function(e){return r({name:"tablePart",attributes:[["r:id",t.getRelationshipId(e)]]})});return r({name:"tableParts",attributes:[["count",this._tables.length]],children:e})}return""}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../table":26}]},{},[12])(12)});