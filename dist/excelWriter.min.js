/*
excelWriter - Javascript module for generating Excel files
<https://github.com/anfilat/excelWriter.js>
(c) 2016 Andrey Filatkin
Dual licenced under the MIT license or GPLv3
*/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.excelWriter=t()}}(function(){return function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return o(n?n:t)},h,h.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){},{}],2:[function(t,e,n){(function(n){"use strict";function i(t){var e,n,i,s=t.name,a="<"+s,l="";if(t.ns&&(a=r.xmlPrefix+a+' xmlns="'+r.schemas[t.ns]+'"'),t.attributes)for(n=0,i=t.attributes.length;n<i;n++)e=t.attributes[n],a+=" "+e[0]+'="'+o.escape(e[1])+'"';return o.isUndefined(t.value)||(l+=o.escape(t.value)),t.children&&(l+=t.children.join("")),a+=l?">"+l+"</"+s+">":"/>"}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./util");e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":27}],3:[function(t,e,n){(function(n){"use strict";function i(t){var e,n,i;o.isObject(t)?e=o.has(t,"cell")?o.isObject(t.cell)?{x:t.cell.c||1,y:t.cell.r||1}:r.letterToPosition(t.cell||""):{x:t.c||1,y:t.r||1}:(e=r.letterToPosition(t||""),t={}),n=e.x-1,i=e.y-1,this.from={x:n,y:i,xOff:r.pixelsToEMUs(t.left||0),yOff:r.pixelsToEMUs(t.top||0)},this.to={x:n+(t.cols||1),y:i+(t.rows||1),xOff:r.pixelsToEMUs(-t.right||0),yOff:r.pixelsToEMUs(-t.bottom||0)}}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("../util"),s=t("../XMLString");i.prototype._exportWithContent=function(t){return s({name:"xdr:twoCellAnchor",children:[s({name:"xdr:from",children:[s({name:"xdr:col",value:this.from.x}),s({name:"xdr:colOff",value:this.from.xOff}),s({name:"xdr:row",value:this.from.y}),s({name:"xdr:rowOff",value:this.from.yOff})]}),s({name:"xdr:to",children:[s({name:"xdr:col",value:this.to.x}),s({name:"xdr:colOff",value:this.to.xOff}),s({name:"xdr:row",value:this.to.y}),s({name:"xdr:rowOff",value:this.to.yOff})]}),t,s({name:"xdr:clientData"})]})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27}],4:[function(t,e,n){"use strict";function i(t){t=t||{},this.x=o.pixelsToEMUs(t.left||0),this.y=o.pixelsToEMUs(t.top||0),this.width=o.pixelsToEMUs(t.width||0),this.height=o.pixelsToEMUs(t.height||0)}var o=t("../util"),r=t("../XMLString");i.prototype._exportWithContent=function(t){return r({name:"xdr:absoluteAnchor",children:[r({name:"xdr:pos",attributes:[["x",this.x],["y",this.y]]}),r({name:"xdr:ext",attributes:[["cx",this.width],["cy",this.height]]}),t,r({name:"xdr:clientData"})]})},e.exports=i},{"../XMLString":2,"../util":27}],5:[function(t,e,n){(function(n){"use strict";function i(t){var e;o.isObject(t)?e=o.has(t,"cell")?o.isObject(t.cell)?{x:t.cell.c||1,y:t.cell.r||1}:r.letterToPosition(t.cell||""):{x:t.c||1,y:t.r||1}:(e=r.letterToPosition(t||""),t={}),this.x=e.x-1,this.y=e.y-1,this.xOff=r.pixelsToEMUs(t.left||0),this.yOff=r.pixelsToEMUs(t.top||0),this.width=r.pixelsToEMUs(t.width||0),this.height=r.pixelsToEMUs(t.height||0)}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("../util"),s=t("../XMLString");i.prototype._exportWithContent=function(t){return s({name:"xdr:oneCellAnchor",children:[s({name:"xdr:from",children:[s({name:"xdr:col",value:this.x}),s({name:"xdr:colOff",value:this.xOff}),s({name:"xdr:row",value:this.y}),s({name:"xdr:rowOff",value:this.yOff})]}),s({name:"xdr:ext",attributes:[["cx",this.width],["cy",this.height]]}),t,s({name:"xdr:clientData"})]})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27}],6:[function(t,e,n){(function(n){"use strict";function i(){this.paths=new r,this.sharedStrings=new s,this.paths.add(this.sharedStrings,"sharedStrings.xml"),this.styleSheet=new a,this.paths.add(this.styleSheet,"styles.xml"),this.worksheets=[],this.tables=[],this.images={},this.imageByNames={},this.drawings=[]}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./paths"),s=t("./sharedStrings"),a=t("./styleSheet"),l=t("./util");i.prototype.addWorksheet=function(t){var e=this.worksheets.length+1,n="worksheets/sheet"+e+".xml",i="xl/worksheets/_rels/sheet"+e+".xml.rels";t.path="xl/"+n,t.relationsPath=i,this.worksheets.push(t),this.paths.add(t,n)},i.prototype.getNewWorksheetDefaultName=function(){return"Sheet "+(this.worksheets.length+1)},i.prototype.setActiveWorksheet=function(t){this.activeWorksheet=t},i.prototype.addTable=function(t){var e=this.tables.length+1,n="xl/tables/table"+e+".xml";t.path=n,this.tables.push(t),this.paths.add(t,"/"+n)},i.prototype.addImage=function(t,e,n){var i=this.images[t];if(i)n&&!this.imageByNames[n]&&(i.name=n,this.imageByNames[n]=i);else{e=e||"";var r,s=l.uniqueId("image"),a="xl/media/image"+s+"."+e;switch(n=n||"_jsExcelWriter"+s,e.toLowerCase()){case"jpeg":case"jpg":r="image/jpeg";break;case"png":r="image/png";break;case"gif":r="image/gif";break;default:r=null}i={objectId:o.uniqueId("Image"),data:t,name:n,contentType:r,extension:e,path:a},this.paths.add(i,"/"+a),this.images[t]=i,this.imageByNames[n]=i}return i.name},i.prototype.getImage=function(t){return this.imageByNames[t]},i.prototype.addDrawings=function(t){var e=this.drawings.length+1,n="xl/drawings/drawing"+e+".xml",i="xl/drawings/_rels/drawing"+e+".xml.rels";t.path=n,t.relationsPath=i,this.drawings.push(t),this.paths.add(t,"/"+n)},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./paths":9,"./sharedStrings":12,"./styleSheet":14,"./util":27}],7:[function(t,e,n){(function(n){"use strict";function i(t){this.objectId=o.uniqueId("Drawings"),this.drawings=[],this.relations=new s(t),this.common=t}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./util"),s=t("./relationshipManager"),a=t("./picture"),l=t("./XMLString");i.prototype.addImage=function(t,e,n){var i=this.common.getImage(t),o=this.relations.addRelation(i,"image"),r=new a({image:i,imageRelationId:o,config:e,anchorType:n});this.drawings.push(r)},i.prototype._export=function(){var t=[["xmlns:a",r.schemas.drawing],["xmlns:r",r.schemas.relationships],["xmlns:xdr",r.schemas.spreadsheetDrawing]],e=o.map(this.drawings,function(t){return t._export()});return l({name:"xdr:wsDr",ns:"spreadsheetDrawing",attributes:t,children:e})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./picture":10,"./relationshipManager":11,"./util":27}],8:[function(t,e,n){(function(n){"use strict";var i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o="undefined"!=typeof window?window.JSZip:"undefined"!=typeof n?n.JSZip:null,r=t("./workbook"),s={createWorkbook:function(){return new r},save:function(t,e){var n=new o,r=o.support.nodestream;return t._generateFiles(n,r),n.generateAsync(i.defaults(e,{compression:"DEFLATE",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",type:"base64"}))},saveAsNodeStream:function(t,e){var n=new o,r=o.support.nodestream;return t._generateFiles(n,r),n.generateNodeStream(i.defaults(e,{compression:"DEFLATE"}))}};e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./workbook":28}],9:[function(t,e,n){"use strict";function i(){this.paths={}}i.prototype.add=function(t,e){this.paths[t.objectId]=e},i.prototype.get=function(t){return this.paths[t.objectId]},e.exports=i},{}],10:[function(t,e,n){"use strict";function i(t){this.objectId=a.uniqueId("Picture"),this.image=t.image,this.imageRelationId=t.imageRelationId,this.createAnchor(t.anchorType,t.config)}var o=t("./anchor/anchor"),r=t("./anchor/anchorOneCell"),s=t("./anchor/anchorAbsolute"),a=t("./util"),l=t("./XMLString");i.prototype.createAnchor=function(t,e){switch(t){case"anchor":this.anchor=new o(e);break;case"oneCell":this.anchor=new r(e);break;case"absolute":this.anchor=new s(e)}},i.prototype._export=function(){var t=l({name:"xdr:pic",children:[l({name:"xdr:nvPicPr",children:[l({name:"xdr:cNvPr",attributes:[["id",this.objectId],["name",this.image.name]]}),l({name:"xdr:cNvPicPr",children:[l({name:"a:picLocks",attributes:[["noChangeAspect","1"],["noChangeArrowheads","1"]]})]})]}),l({name:"xdr:blipFill",children:[l({name:"a:blip",attributes:[["xmlns:r",a.schemas.relationships],["r:embed",this.imageRelationId]]}),l({name:"a:srcRect"}),l({name:"a:stretch",children:[l({name:"a:fillRect"})]})]}),l({name:"xdr:spPr",attributes:[["bwMode","auto"]],children:[l({name:"a:xfrm"}),l({name:"a:prstGeom",attributes:[["prst","rect"]]})]})]});return this.anchor._exportWithContent(t)},e.exports=i},{"./XMLString":2,"./anchor/anchor":3,"./anchor/anchorAbsolute":4,"./anchor/anchorOneCell":5,"./util":27}],11:[function(t,e,n){(function(n){"use strict";function i(t){this.relations={},this.lastId=1,this.paths=t.paths}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./util"),s=t("./XMLString");i.prototype.addRelation=function(t,e){var n,i=this.relations[t.objectId];return i?n=i.relationId:(n="rId"+this.lastId++,this.relations[t.objectId]={relationId:n,schema:r.schemas[e],object:t}),n},i.prototype.getRelationshipId=function(t){var e=this.relations[t.objectId];return e?e.relationId:null},i.prototype._export=function(){var t=this.paths,e=o.map(this.relations,function(e){var n=[["Id",e.relationId],["Type",e.schema],["Target",e.object.target||t.get(e.object)]];return e.object.targetMode&&n.push(["TargetMode",e.object.targetMode]),s({name:"Relationship",attributes:n})});return s({name:"Relationships",ns:"relationshipPackage",children:e})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./util":27}],12:[function(t,e,n){(function(n){"use strict";function i(){this.objectId=l.uniqueId("SharedStrings"),this._strings={},this._stringArray=[]}function o(t){a.call(this,t),this.strings=t.strings,this.status=0}function r(t){return u.xmlPrefix+'<sst xmlns="'+u.schemas.spreadsheetml+'" count="'+t+'" uniqueCount="'+t+'">'}function s(){return"</sst>"}var a=t("stream").Readable,l="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,u=t("./util");i.prototype.addString=function(t){var e=this._strings[t];return void 0===e&&(e=this._stringArray.length,this._strings[t]=e,this._stringArray[e]=t),e},i.prototype.isEmpty=function(){return 0===this._stringArray.length},i.prototype._export=function(t){if(t)return new o({strings:this._stringArray});this._strings=null;var e=this._stringArray.length,n=l.map(this._stringArray,function(t){return"<si><t>"+l.escape(t)+"</t></si>"});return r(e)+n.join("")+s()},u.inherits(o,a||{}),o.prototype._read=function(t){var e=!1;if(0===this.status&&(this._strings=null,e=!this.push(r(this.strings.length)),this.status=1,this.index=0,this.len=this.strings.length),1===this.status){for(var n="";this.index<this.len&&!e;){for(;this.index<this.len&&n.length<t;)n+="<si><t>"+l.escape(this.strings[this.index])+"</t></si>",this.strings[this.index]=null,this.index++;e=!this.push(n),n=""}this.index===this.len&&(this.status=2)}2===this.status&&(this.push(s()),this.push(null))},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":27,stream:1}],13:[function(t,e,n){(function(n){"use strict";function i(t){t=t||{},this.pane=null,this.attributes={defaultGridColor:{value:null,bool:!0},colorId:{value:null},rightToLeft:{value:null,bool:!0},showFormulas:{value:null,bool:!0},showGridLines:{value:null,bool:!0},showOutlineSymbols:{value:null,bool:!0},showRowColHeaders:{value:null,bool:!0},showRuler:{value:null,bool:!0},showWhiteSpace:{value:null,bool:!0},showZeros:{value:null,bool:!0},tabSelected:{value:null,bool:!0},topLeftCell:{value:null},view:{value:"normal"},windowProtection:{value:null,bool:!0},zoomScale:{value:null},zoomScaleNormal:{value:null},zoomScalePageLayoutView:{value:null},zoomScaleSheetLayoutView:{value:null}};var e=this;r.forEach(t,function(t,n){"freeze"===n?e.freeze(t.col,t.row,t.cell,t.activePane):"split"===n?e.split(t.x,t.y,t.cell,t.activePane):e.attributes[n]&&(e.attributes[n].value=t)})}function o(t){return t?a({name:"pane",attributes:[["state",t.state],["xSplit",t.xSplit],["ySplit",t.ySplit],["topLeftCell",t.topLeftCell],["activePane",t.activePane]]}):""}var r="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,s=t("./util"),a=t("./XMLString");i.prototype.setAttribute=function(t,e){this.attributes[t]&&(this.attributes[t].value=e)},i.prototype.freeze=function(t,e,n,i){this.pane={state:"frozen",xSplit:t,ySplit:e,topLeftCell:s.canonCell(n)||s.positionToLetter(t+1,e+1),activePane:i||"bottomRight"}},i.prototype.split=function(t,e,n,i){this.pane={state:"split",xSplit:20*t,ySplit:20*e,topLeftCell:s.canonCell(n)||"A1",activePane:i||"bottomRight"}},i.prototype._export=function(){var t=[["workbookViewId",0]];return r.forEach(this.attributes,function(e,n){var i=e.value;null!==i&&(e.bool&&(i=i?"true":"false"),t.push([n,i]))}),a({name:"sheetViews",children:[a({name:"sheetView",attributes:t,children:[o(this.pane)]})]})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./util":27}],14:[function(t,e,n){(function(n){"use strict";function i(){this.objectId=o.uniqueId("StyleSheet"),this.numberFormats=new r.NumberFormats(this),this.fonts=new s.Fonts(this),this.fills=new a.Fills(this),this.borders=new l.Borders(this),this.cells=new u.Cells(this),this.tableElements=new d.TableElements(this),this.tables=new h.Tables(this),this.defaultTableStyle=""}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./style/numberFormats"),s=t("./style/fonts"),a=t("./style/fills"),l=t("./style/borders"),u=t("./style/cells"),h=t("./style/tables"),d=t("./style/tableElements"),f=t("./XMLString");i.prototype.addFormat=function(t,e){return this.cells.add(t,null,e)},i.prototype.addFontFormat=function(t,e){return this.fonts.add(t,null,e)},i.prototype.addBorderFormat=function(t,e){return this.borders.add(t,null,e)},i.prototype.addPatternFormat=function(t,e){return this.fills.add(t,"pattern",e)},i.prototype.addGradientFormat=function(t,e){return this.fills.add(t,"gradient",e)},i.prototype.addNumberFormat=function(t,e){return this.numberFormats.add(t,null,e)},i.prototype.addTableFormat=function(t,e){return this.tables.add(t,null,e)},i.prototype.addTableElementFormat=function(t,e){return this.tableElements.add(t,null,e)},i.prototype.setDefaultTableStyle=function(t){this.tables.defaultTableStyle=t},i.prototype._export=function(){return f({name:"styleSheet",ns:"spreadsheetml",children:[this.numberFormats.export(),this.fonts.export(),this.fills.export(),this.borders.export(),this.cells.export(),this.tableElements.export(),this.tables.export()]})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./style/borders":16,"./style/cells":17,"./style/fills":18,"./style/fonts":19,"./style/numberFormats":20,"./style/tableElements":23,"./style/tables":24}],15:[function(t,e,n){(function(n){"use strict";function i(t){var e=[];return t.horizontal&&r.includes(a,t.horizontal)&&e.push(["horizontal",t.horizontal]),t.vertical&&r.includes(l,t.vertical)&&e.push(["vertical",t.vertical]),t.indent&&e.push(["indent",t.indent]),t.justifyLastLine&&e.push(["justifyLastLine",1]),r.has(t,"readingOrder")&&r.includes([0,1,2],t.readingOrder)&&e.push(["readingOrder",t.readingOrder]),t.relativeIndent&&e.push(["relativeIndent",t.relativeIndent]),t.shrinkToFit&&e.push(["shrinkToFit",1]),t.textRotation&&e.push(["textRotation",t.textRotation]),t.wrapText&&e.push(["wrapText",1]),e.length?e:void 0}function o(t){return s({name:"alignment",attributes:t})}var r="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,s=t("../XMLString"),a=["left","center","right","fill","justify","centerContinuous","distributed"],l=["top","center","bottom","justify","distributed"];e.exports={canon:i,export:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],16:[function(t,e,n){(function(n){"use strict";function i(t){a.call(this,t,"borders","border"),this.init(),this.lastId=this.formats.length}function o(t){var e={};return s.forEach(d,function(n){var i=t[n];i?e[n]={style:i.style,color:i.color}:e[n]={}}),e}function r(t){var e=s.map(d,function(e){var n,i,o=t[e];return o&&(o.style&&(n=[["style",o.style]]),o.color&&(i=[u.exportColor(o.color)])),h({name:e,attributes:n,children:i})});return h({name:"border",children:e})}var s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,a=t("./stylePart"),l=t("../util"),u=t("./utils"),h=t("../XMLString"),d=["left","right","top","bottom","diagonal"];l.inherits(i,a),i.prototype.init=function(){this.formats.push({format:this.canon({})})},i.prototype.canon=o,i.prototype.exportFormat=r,e.exports={Borders:i,canon:o,exportFormat:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./stylePart":22,"./utils":25}],17:[function(t,e,n){(function(n){"use strict";function i(t){r.call(this,t,"cellXfs","format"),this.init(),this.lastId=this.formats.length,this.exportEmpty=!1}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./stylePart"),s=t("./alignment"),a=t("./protection"),l=t("../util"),u=t("../XMLString"),h=["format","fill","border","font"],d=["numFmtId","fillId","borderId","fontId"];l.inherits(i,r),i.prototype.init=function(){this.formats.push({format:this.canon({})})},i.prototype.canon=function(t){var e={};return t.format&&(e.format=this.styleSheet.numberFormats.add(t.format)),t.font&&(e.font=this.styleSheet.fonts.add(t.font)),t.pattern?e.fill=this.styleSheet.fills.add(t.pattern,"pattern"):t.gradient&&(e.fill=this.styleSheet.fills.add(t.gradient,"gradient")),t.border&&(e.border=this.styleSheet.borders.add(t.border)),e.alignment=s.canon(t),e.protection=a.canon(t),e},i.prototype.exportFormat=function(t){var e=this.styleSheet,n=[],i=[];return t.alignment&&t.alignment.length&&(i.push(s.export(t.alignment)),n.push(["applyAlignment","true"])),t.protection&&t.protection.length&&(i.push(a.export(t.protection)),n.push(["applyProtection","true"])),o.forEach(t,function(t,i){var r;o.includes(h,i)&&(r=d[o.indexOf(h,i)],"format"===i?(n.push([r,e.numberFormats.getId(t)]),n.push(["applyNumberFormat","true"])):"fill"===i?(n.push([r,e.fills.getId(t)]),n.push(["applyFill","true"])):"border"===i?(n.push([r,e.borders.getId(t)]),n.push(["applyBorder","true"])):"font"===i&&(n.push([r,e.fonts.getId(t)]),n.push(["applyFont","true"])))}),u({name:"xf",attributes:n,children:i})},e.exports={Cells:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./alignment":15,"./protection":21,"./stylePart":22}],18:[function(t,e,n){(function(n){"use strict";function i(t){u.call(this,t,"fills","fill"),this.init(),this.lastId=this.formats.length}function o(t,e,n){var i={type:e};if("pattern"===e){var o=t.color||"FFFFFFFF",r=t.backColor||"FFFFFFFF";i.patternType=l.includes(f,t.type)?t.type:"solid",n&&"solid"===i.patternType?(i.fgColor=r,i.bgColor=o):(i.fgColor=o,i.bgColor=r)}else l.has(t,"left")?(i.left=t.left||0,i.right=t.right||0,i.top=t.top||0,i.bottom=t.bottom||0):i.degree=t.degree||0,i.start=t.start||"FFFFFFFF",i.end=t.end||"FFFFFFFF";return i}function r(t){var e;return e="pattern"===t.type?[s(t)]:[a(t)],d({name:"fill",children:e})}function s(t){var e=[["patternType",t.patternType]],n=[d({name:"fgColor",attributes:[["rgb",t.fgColor]]}),d({name:"bgColor",attributes:[["rgb",t.bgColor]]})];return d({name:"patternFill",attributes:e,children:n})}function a(t){var e,n=[],i=[];return t.degree?n.push(["degree",t.degree]):t.left&&(n.push(["type","path"]),n.push(["left",t.left]),n.push(["right",t.right]),n.push(["top",t.top]),n.push(["bottom",t.bottom])),e=[["rgb",t.start]],i.push(d({name:"stop",attributes:[["position",0]],children:[d({name:"color",attributes:e})]})),e=[["rgb",t.end]],i.push(d({name:"stop",attributes:[["position",1]],children:[d({name:"color",attributes:e})]})),d({name:"gradientFill",attributes:n,children:i})}var l="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,u=t("./stylePart"),h=t("../util"),d=t("../XMLString"),f=["none","solid","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis"];h.inherits(i,u),i.prototype.init=function(){this.formats.push({format:this.canon({type:"none"},"pattern")},{format:this.canon({type:"gray125"},"pattern")})},i.prototype.canon=o,i.prototype.exportFormat=r,e.exports={Fills:i,canon:o,exportFormat:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./stylePart":22}],19:[function(t,e,n){(function(n){"use strict";function i(t){a.call(this,t,"fonts","font"),this.init(),this.lastId=this.formats.length}function o(t){var e={};return s.has(t,"bold")&&(e.bold=!!t.bold),s.has(t,"italic")&&(e.italic=!!t.italic),t.superscript&&(e.vertAlign="superscript"),t.subscript&&(e.vertAlign="subscript"),t.underline&&(s.indexOf(["double","singleAccounting","doubleAccounting"],t.underline)!==-1?e.underline=t.underline:e.underline=!0),s.has(t,"strike")&&(e.strike=!!t.strike),t.outline&&(e.outline=!0),t.shadow&&(e.shadow=!0),t.size&&(e.size=t.size),t.color&&(e.color=t.color),t.fontName&&(e.fontName=t.fontName),e}function r(t){var e,n=[];return t.size&&n.push(h({name:"sz",attributes:[["val",t.size]]})),t.fontName&&n.push(h({name:"name",attributes:[["val",t.fontName]]})),s.has(t,"bold")&&(t.bold?n.push(h({name:"b"})):n.push(h({name:"b",attributes:[["val",0]]}))),s.has(t,"italic")&&(t.italic?n.push(h({name:"i"})):n.push(h({name:"i",attributes:[["val",0]]}))),t.vertAlign&&n.push(h({name:"vertAlign",attributes:[["val",t.vertAlign]]})),t.underline&&(e=null,t.underline!==!0&&(e=[["val",t.underline]]),n.push(h({name:"u",attributes:e}))),s.has(t,"strike")&&(t.strike?n.push(h({name:"strike"})):n.push(h({name:"strike",attributes:[["val",0]]}))),t.shadow&&n.push(h({name:"shadow"})),t.outline&&n.push(h({name:"outline"})),t.color&&n.push(u.exportColor(t.color)),h({name:"font",children:n})}var s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,a=t("./stylePart"),l=t("../util"),u=t("./utils"),h=t("../XMLString");l.inherits(i,a),i.prototype.init=function(){this.formats.push({format:o({})})},i.prototype.canon=o,i.prototype.exportFormat=r,e.exports={Fonts:i,canon:o,exportFormat:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./stylePart":22,"./utils":25}],20:[function(t,e,n){(function(n){"use strict";function i(t){a.call(this,t,"numFmts","numberFormat"),this.init(),this.lastId=164}function o(t){return t}function r(t,e){var n=[["numFmtId",e.formatId],["formatCode",t]];return u({name:"numFmt",attributes:n})}var s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,a=t("./stylePart"),l=t("../util"),u=t("../XMLString"),h={date:14,time:21};l.inherits(i,a),i.prototype.init=function(){var t=this;s.forEach(h,function(e,n){t.formatsByNames[n]={formatId:e}})},i.prototype.canon=o,i.prototype.exportFormat=r,e.exports={NumberFormats:i,canon:o,exportFormat:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./stylePart":22}],21:[function(t,e,n){(function(n){"use strict";function i(t){var e=[];return r.has(t,"locked")&&!t.locked&&e.push(["locked",0]),t.hidden&&e.push(["hidden",1]),e.length?e:void 0}function o(t){return s({name:"protection",attributes:t})}var r="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,s=t("../XMLString");e.exports={canon:i,export:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],22:[function(t,e,n){(function(n){"use strict";function i(t,e,n){this.styleSheet=t,this.exportName=e,this.formatName=n,this.lastName=1,this.lastId=0,this.exportEmpty=!0,this.formats=[],this.formatsByData={},this.formatsByNames={}}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("../XMLString");i.prototype.add=function(t,e,n){var i,r,s;return n&&this.formatsByNames[n]?(i=this.canon(t,e),r=o.isObject(i)?JSON.stringify(i):i,r!==this.formatsByNames[n].format&&this._add(i,r,n),n):!n&&o.isString(t)&&this.formatsByNames[t]?t:(i=this.canon(t,e),r=o.isObject(i)?JSON.stringify(i):i,s=this.formatsByData[r],s?n&&!this.formatsByNames[n]&&(s.name=n,this.formatsByNames[n]=s):s=this._add(i,r,n),s.name)},i.prototype._add=function(t,e,n){n=n||this.formatName+this.lastName++;var i={name:n,formatId:this.lastId++,format:t};return this.formats.push(i),this.formatsByData[e]=i,this.formatsByNames[n]=i,i},i.prototype.get=function(t){var e=this.formatsByNames[t];return e?e.format:null},i.prototype.getId=function(t){var e=this.formatsByNames[t];return e?e.formatId:null},i.prototype.export=function(){if(this.exportEmpty!==!1||this.formats.length){var t=this,e=[["count",this.formats.length]],n=o.map(this.formats,function(e){return t.exportFormat(e.format,e)});return this.exportCollectionExt(e,n),r({name:this.exportName,attributes:e,children:n})}return""},i.prototype.canon=function(t){return t},i.prototype.exportCollectionExt=function(){},i.prototype.exportFormat=function(){return""},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],23:[function(t,e,n){"use strict";function i(t){o.call(this,t,"dxfs","tableElement")}var o=t("./stylePart"),r=t("../util"),s=t("./numberFormats"),a=t("./fonts"),l=t("./fills"),u=t("./borders"),h=t("./alignment"),d=t("../XMLString");r.inherits(i,o),i.prototype.canon=function(t){var e={};return t.format&&(e.format=s.canon(t.format)),t.font&&(e.font=a.canon(t.font)),t.pattern?e.fill=l.canon(t.pattern,"pattern","table"):t.gradient&&(e.fill=l.canon(t.gradient,"gradient")),t.border&&(e.border=u.canon(t.border)),e.alignment=h.canon(t),e},i.prototype.exportFormat=function(t){var e=[];return t.font&&e.push(a.exportFormat(t.font)),t.fill&&e.push(l.exportFormat(t.fill)),t.border&&e.push(u.exportFormat(t.border)),t.format&&e.push(s.exportFormat(t.format)),t.alignment&&t.alignment.length&&e.push(h.export(t.alignment)),d({name:"dxf",children:e})},e.exports={TableElements:i}},{"../XMLString":2,"../util":27,"./alignment":15,"./borders":16,"./fills":18,"./fonts":19,"./numberFormats":20,"./stylePart":22}],24:[function(t,e,n){(function(n){"use strict";function i(t){r.call(this,t,"tableStyles","table"),this.exportEmpty=!1}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("./stylePart"),s=t("../util"),a=t("../XMLString"),l=["wholeTable","headerRow","totalRow","firstColumn","lastColumn","firstRowStripe","secondRowStripe","firstColumnStripe","secondColumnStripe","firstHeaderCell","lastHeaderCell","firstTotalCell","lastTotalCell"],u=["firstRowStripe","secondRowStripe","firstColumnStripe","secondColumnStripe"];s.inherits(i,r),i.prototype.canon=function(t){var e={},n=this.styleSheet;return o.forEach(t,function(t,i){if(o.includes(l,i)){var r,s=null;t.style?(r=n.tableElements.add(t.style),t.size>1&&o.includes(u,i)&&(s=t.size)):r=n.tableElements.add(t),e[i]={style:r,size:s}}}),e},i.prototype.exportCollectionExt=function(t){this.styleSheet.defaultTableStyle&&t.push(["defaultTableStyle",this.styleSheet.defaultTableStyle])},i.prototype.exportFormat=function(t,e){var n=this.styleSheet,i=[["name",e.name],["pivot",0]],r=[];return o.forEach(t,function(t,e){var i=t.style,o=t.size,s=[["type",e],["dxfId",n.tableElements.getId(i)]];o&&s.push(["size",o]),r.push(a({name:"tableStyleElement",attributes:s}))}),i.push(["count",r.length]),a({name:"tableStyle",attributes:i,children:r})},e.exports={Tables:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":27,"./stylePart":22}],25:[function(t,e,n){(function(n){"use strict";function i(t){var e;return o.isString(t)?r({name:"color",attributes:[["rgb",t]]}):(e=[],o.isUndefined(t.tint)||e.push(["tint",t.tint]),o.isUndefined(t.auto)||e.push(["auto",!!t.auto]),o.isUndefined(t.theme)||e.push(["theme",t.theme]),r({name:"color",attributes:e}))}var o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r=t("../XMLString");e.exports={exportColor:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],26:[function(t,e,n){(function(n){"use strict";function i(t,e){this.worksheet=t,this.common=t.common,this.tableId=l.uniqueId("Table"),this.objectId="Table"+this.tableId,this.name=this.objectId,this.displayName=this.objectId,this.headerRowBorderDxfId=null,this.headerRowCount=1,this.headerRowDxfId=null,this.beginCell=null,this.endCell=null,this.totalsRowCount=0,this.totalRow=null,this.themeStyle=null,a.extend(this,e)}function o(t,e){return u({name:"autoFilter",attributes:["ref",t+":"+e]})}function r(t){var e=[["count",t.length]],n=a.map(t,function(t,e){var n=[["id",e+1],["name",t.name]];return t.totalsRowFunction&&n.push(["totalsRowFunction",t.totalsRowFunction]),t.totalsRowLabel&&n.push(["totalsRowLabel",t.totalsRowLabel]),u({name:"tableColumn",attributes:n})});return u({name:"tableColumns",attributes:e,children:n})}function s(t,e){var n=[["name",e]],i=!1,o=!1,r=!1,s=!1,a=t.styleSheet.tables.get(e);return a&&(i=a.firstRowStripe||a.secondRowStripe,o=a.firstColumnStripe||a.secondColumnStripe,r=a.firstColumn,s=a.lastColumn),n.push(["showRowStripes",i?"1":"0"],["showColumnStripes",o?"1":"0"],["showFirstColumn",r?"1":"0"],["showLastColumn",s?"1":"0"]),u({name:"tableStyleInfo",attributes:n})}var a="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=t("./util"),u=t("./XMLString");i.prototype.end=function(){return this.worksheet},i.prototype.setReferenceRange=function(t,e){return this.beginCell=l.canonCell(t),this.endCell=l.canonCell(e),this},i.prototype.addTotalRow=function(t){return this.totalRow=t,this.totalsRowCount=1,this},i.prototype.setTheme=function(t){return this.themeStyle=t,this},i.prototype.setSortState=function(t){return this.sortState=t,this},i.prototype._prepare=function(t){var e=["average","countNums","count","max","min","stdDev","sum","var"],n=[101,102,103,104,105,107,109,110];if(this.totalRow){var i=this.name,o=l.letterToPosition(this.beginCell),r=l.letterToPosition(this.endCell),s=o.y-1,u=o.x-1,h=r.y-1,d=t[s]||[],f=t[h+1];f||(f=[],t[h+1]=f),a.forEach(this.totalRow,function(t,o){var r,s=d[u+o];"object"==typeof s&&(s=s.value),t.name=s,t.totalsRowLabel?f[u+o]={value:t.totalsRowLabel,type:"string"}:t.totalsRowFunction&&(r=a.indexOf(e,t.totalsRowFunction),r!==-1&&(f[u+o]={value:"SUBTOTAL("+n[r]+","+i+"["+s+"])",type:"formula"}))})}},i.prototype._export=function(){
var t=[["id",this.tableId],["name",this.name],["displayName",this.displayName]],e=[],n=l.letterToPosition(this.endCell),i=this.beginCell+":"+l.positionToLetter(n.x,n.y+this.totalsRowCount);return t.push(["ref",i]),t.push(["totalsRowCount",this.totalsRowCount]),t.push(["headerRowCount",this.headerRowCount]),e.push(o(this.beginCell,this.endCell)),e.push(r(this.totalRow)),e.push(s(this.common,this.themeStyle)),u({name:"table",ns:"spreadsheetml",attributes:t,children:e})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./util":27}],27:[function(t,e,n){(function(t){"use strict";function n(t,e){var n=a[t];if(!n){var i,o="",r=t;do i=(r-1)%26,o=s[i]+o,r=(r-(i+1))/26;while(r>0);a[t]=o,n=o}return n+(e||"")}function i(t){var e,n,i,o=0,r=0;for(e=0,n=t.length;e<n;e++){if(i=t.charCodeAt(e),!(i>=65)){r=parseInt(t.slice(e),10);break}o=26*o+i-64}return{x:o||1,y:r||1}}var o="undefined"!=typeof window?window._:"undefined"!=typeof t?t._:null,r={},s="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a={},l={uniqueId:function(t){return r[t]||(r[t]=1),r[t]++},inherits:function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n},pixelsToEMUs:function(t){return Math.round(914400*t/96)},canonCell:function(t){return o.isObject(t)?n(t.c||1,t.r||1):t},positionToLetter:n,letterToPosition:i,xmlPrefix:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n',schemas:{worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"}};e.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(t,e,n){(function(n){"use strict";function i(){this.objectId=y.uniqueId("Workbook"),this.common=new w,this.relations=new b(this.common)}function o(t){var e,n=0;return t.activeWorksheet&&(e=t.activeWorksheet.objectId,n=Math.max(n,y.findIndex(t.worksheets,function(t){return t.objectId===e}))),v({name:"bookViews",children:[v({name:"workbookView",attributes:[["activeTab",n]]})]})}function r(t,e){var n=31,i=y.map(e.worksheets,function(e,i){if(e.name.length>n)throw"Microsoft Excel requires work sheet names to be less than "+(n+1)+' characters long, work sheet name "'+e.name+'" is '+e.name.length+" characters long";return v({name:"sheet",attributes:[["name",e.name],["sheetId",i+1],["r:id",t.getRelationshipId(e)],["state",e.state]]})});return v({name:"sheets",children:i})}function s(t){var e=y.some(t.worksheets,function(t){return t._printTitles&&(t._printTitles.topTo>=0||t._printTitles.leftTo>=0)});if(e){var n=[];return y.forEach(t.worksheets,function(t,e){var i=t._printTitles;if(i&&(i.topTo>=0||i.leftTo>=0)){var o="",r=t.name;i.topTo>=0&&(o=r+"!$"+(i.topFrom+1)+":$"+(i.topTo+1),i.leftTo>=0&&(o+=",")),i.leftTo>=0&&(o+=r+"!$"+g.positionToLetter(i.leftFrom+1)+":$"+g.positionToLetter(i.leftTo+1)),n.push(v({name:"definedName",value:o,attributes:[["name","_xlnm.Print_Titles"],["localSheetId",e]]}))}}),v({name:"definedNames",children:n})}return""}function a(t){y.forEach(t.worksheets,function(t){t._prepare()})}function l(t,e,n){y.forEach(n.worksheets,function(n){t.file(n.path,n._export(e)),t.file(n.relationsPath,n.relations._export())})}function u(t,e){y.forEach(e.tables,function(e){t.file(e.path,e._export())})}function h(t,e){y.forEach(e.images,function(e){t.file(e.path,e.data,{base64:!0,binary:!0}),e.data=null}),e.images=null}function d(t,e){y.forEach(e.drawings,function(e){t.file(e.path,e._export()),t.file(e.relationsPath,e.relations._export())})}function f(t,e,n){e.addRelation(n.styleSheet,"stylesheet"),t.file("xl/styles.xml",n.styleSheet._export())}function p(t,e,n,i){i.sharedStrings.isEmpty()||(n.addRelation(i.sharedStrings,"sharedStrings"),t.file("xl/sharedStrings.xml",i.sharedStrings._export(e)))}function c(t){var e=[],n={};return e.push(v({name:"Default",attributes:[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]]})),e.push(v({name:"Default",attributes:[["Extension","xml"],["ContentType","application/xml"]]})),e.push(v({name:"Override",attributes:[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]]})),t.sharedStrings.isEmpty()||e.push(v({name:"Override",attributes:[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]]})),e.push(v({name:"Override",attributes:[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]]})),y.forEach(t.worksheets,function(t,n){e.push(v({name:"Override",attributes:[["PartName","/xl/worksheets/sheet"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]}))}),y.forEach(t.tables,function(t,n){e.push(v({name:"Override",attributes:[["PartName","/xl/tables/table"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]}))}),y.forEach(t.imageByNames,function(t){n[t.extension]=t.contentType}),y.forEach(n,function(t,n){e.push(v({name:"Default",attributes:[["Extension",n],["ContentType",t]]}))}),y.forEach(t.drawings,function(t,n){e.push(v({name:"Override",attributes:[["PartName","/xl/drawings/drawing"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]}))}),v({name:"Types",ns:"contentTypes",children:e})}function m(){return v({name:"Relationships",ns:"relationshipPackage",children:[v({name:"Relationship",attributes:[["Id","rId1"],["Type",g.schemas.officeDocument],["Target","xl/workbook.xml"]]})]})}var y="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,g=t("./util"),w=t("./common"),b=t("./relationshipManager"),x=t("./worksheet"),v=t("./XMLString");i.prototype.addWorksheet=function(t){var e;return t=y.defaults(t,{name:this.common.getNewWorksheetDefaultName()}),e=new x(this,t),this.common.addWorksheet(e),this.relations.addRelation(e,"worksheet"),e},i.prototype.addFormat=function(t,e){return this.common.styleSheet.addFormat(t,e)},i.prototype.addFontFormat=function(t,e){return this.common.styleSheet.addFontFormat(t,e)},i.prototype.addBorderFormat=function(t,e){return this.common.styleSheet.addBorderFormat(t,e)},i.prototype.addPatternFormat=function(t,e){return this.common.styleSheet.addPatternFormat(t,e)},i.prototype.addGradientFormat=function(t,e){return this.common.styleSheet.addGradientFormat(t,e)},i.prototype.addNumberFormat=function(t,e){return this.common.styleSheet.addNumberFormat(t,e)},i.prototype.addTableFormat=function(t,e){return this.common.styleSheet.addTableFormat(t,e)},i.prototype.addTableElementFormat=function(t,e){return this.common.styleSheet.addTableElementFormat(t,e)},i.prototype.setDefaultTableStyle=function(t){return this.common.styleSheet.setDefaultTableStyle(t),this},i.prototype.addImage=function(t,e,n){return this.common.addImage(t,e,n)},i.prototype._generateFiles=function(t,e){a(this.common),l(t,e,this.common),u(t,this.common),h(t,this.common),d(t,this.common),f(t,this.relations,this.common),p(t,e,this.relations,this.common),t.file("[Content_Types].xml",c(this.common)),t.file("_rels/.rels",m()),t.file("xl/workbook.xml",this._export()),t.file("xl/_rels/workbook.xml.rels",this.relations._export())},i.prototype._export=function(){return v({name:"workbook",ns:"spreadsheetml",attributes:[["xmlns:r",g.schemas.relationships]],children:[o(this.common),r(this.relations,this.common),s(this.common)]})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./common":6,"./relationshipManager":11,"./util":27,"./worksheet":29}],29:[function(t,e,n){(function(n){"use strict";function i(t,e){e=e||{},this.objectId=R.uniqueId("Worksheet"),this.workbook=t,this.common=t.common,this.data=[],this.columns=[],this.rows=[],this.mergedCells=[],this.headers=[],this.footers=[],this.tables=[],this.drawings=null,this.hyperlinks=[],this.name=e.name,this.state=e.state||"visible",this.timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,this.relations=new P(this.common),this.sheetView=new E(e)}function o(t){L.call(this,t),this.worksheet=t.worksheet,this.status=0}function r(t,e){var n,i,o,r,u,h,d,f,p=t.common.styleSheet,c=t.rows[e],m=t.data[e],y=[],g=null;if(m)for(m.data&&(c=c||{},c.height=m.height||c.height,c.style=m.style||c.style,c.outlineLevel=m.outlineLevel||c.outlineLevel,m=m.data),c&&(g=c.style||null,c.style=p.cells.getId(c.style)),i=0;i<m.length;i++)n=t.columns[i],o=m[i],R.isNil(o)||(o&&"object"==typeof o?(u=o.style||null,o.formula?(r=o.formula,h="formula"):o.date?(r=o.date,h="date"):o.time?(r=o.time,h="time"):(r=o.value,h=o.type),o.hyperlink&&s(t,i,e,o.hyperlink),o.image&&a(t,i,e,o.image),(o.colspan||o.rowspan)&&(d=(o.colspan||1)-1,f=(o.rowspan||1)-1,t.mergeCells({c:i+1,r:e+1},{c:i+1+d,r:e+1+f}),l(t,m,i,e,d,f))):(r=o,u=null,h=null),null===u&&(null!==g?u=g:n&&n.style&&(u=n.style)),h||(h=n&&n.type?n.type:"number"==typeof r?"number":"string"),"string"===h&&(r=t.common.sharedStrings.addString(r)),y[i]={value:r,style:p.cells.getId(u),type:h});return t.preparedData[e]=y,t.preparedRows[e]=c,y}function s(t,e,n,i){var o,r,s;"string"==typeof i?o=i:(o=i.location,r=i.targetMode,s=i.tooltip),t.setHyperlink({cell:{c:e+1,r:n+1},location:o,targetMode:r,tooltip:s})}function a(t,e,n,i){var o;"string"==typeof i||i.data?t.setImage(i,{c:e+1,r:n+1}):(o=i.config||{},o.cell={c:e+1,r:n+1},t.setImage(i.image,o))}function l(t,e,n,i,o,r){var s,a,l;if(o)for(a=0;a<o;a++)e.splice(n+1,0,{style:null,type:"empty"});if(r)for(o+=1,s=0;s<r;s++)if(l=t.data[i+s+1],l||(l=[],t.data[i+s+1]=l),l.length>n)for(a=0;a<o;a++)l.splice(n,0,{style:null,type:"empty"});else for(a=0;a<o;a++)l[n+a]={style:null,type:"empty"}}function u(t){return I()+c(t.maxX,t.maxY)+t.sheetView._export()+m(t.columns)+"<sheetData>"}function h(t){return"</sheetData>"+y(t.mergedCells)+g(t.relations,t.hyperlinks)+w(t._margin)+b(t._orientation)+x(t.headers,t.footers)+_(t.relations,t.tables)+k(t.relations,t.drawings)+C()}function d(t,e,n){for(var i,o="",r=0,s=t.length;r<s;r++)i=t[r],o+=f(i,r,e,n),t[r]=null;return o}function f(t,e,n,i){var o,r,s,a,l=[];if(t)for(o=t.length,l=new Array(o),r=0;r<o;r++)if(s=t[r])switch(a=' r="'+M.positionToLetter(r+1,e+1)+'"',null!==s.style&&(a+=' s="'+s.style+'"'),s.type){case"number":l[r]="<c"+a+"><v>"+s.value+"</v></c>";break;case"date":case"time":l[r]="<c"+a+"><v>"+(25569+(s.value-i)/864e5)+"</v></c>";break;case"formula":l[r]="<c"+a+"><f>"+R.escape(s.value)+"</f></c>";break;case"string":l[r]="<c"+a+' t="s"><v>'+s.value+"</v></c>";break;case"empty":l[r]="<c"+a+"/>"}return"<row"+p(n[e],e)+">"+l.join("")+"</row>"}function p(t,e){var n=' r="'+(e+1)+'"';return t&&(void 0!==t.height&&(n+=' customHeight="1"',n+=' ht="'+t.height+'"'),void 0!==t.style&&(n+=' customFormat="1"',n+=' s="'+t.style+'"'),t.outlineLevel&&(n+=' outlineLevel="'+t.outlineLevel+'"')),n}function c(t,e){var n=[];return 0!==t?n.push(["ref","A1:"+M.positionToLetter(t,e)]):n.push(["ref","A1"]),D({name:"dimension",attributes:n})}function m(t){if(t.length){var e=R.map(t,function(t,e){t=t||{};var n=[["min",t.min||e+1],["max",t.max||e+1]];return t.hidden&&n.push(["hidden",1]),t.bestFit&&n.push(["bestFit",1]),(t.customWidth||t.width)&&n.push(["customWidth",1]),t.width?n.push(["width",t.width]):n.push(["width",9.140625]),void 0!==t.style&&n.push(["style",t.style]),D({name:"col",attributes:n})});return D({name:"cols",children:e})}return""}function y(t){if(t.length>0){var e=R.map(t,function(t){return D({name:"mergeCell",attributes:[["ref",M.canonCell(t[0])+":"+M.canonCell(t[1])]]})});return D({name:"mergeCells",attributes:[["count",t.length]],children:e})}return""}function g(t,e){if(e.length>0){var n=R.map(e,function(e){var n=[["ref",M.canonCell(e.cell)],["r:id",t.getRelationshipId(e)]];return e.tooltip&&n.push(["tooltip",e.tooltip]),D({name:"hyperlink",attributes:n})});return D({name:"hyperlinks",children:n})}return""}function w(t){return t?D({name:"pageMargins",attributes:[["top",t.top],["bottom",t.bottom],["left",t.left],["right",t.right],["header",t.header],["footer",t.footer]]}):""}function b(t){return t?D({name:"pageSetup",attributes:[["orientation",t]]}):""}function x(t,e){if(t.length>0||e.length>0){var n=[];return t.length>0&&n.push(v(t)),e.length>0&&n.push(S(e)),D({name:"headerFooter",children:n})}return""}function v(t){return D({name:"oddHeader",value:T(t)})}function S(t){return D({name:"oddFooter",value:T(t)})}function T(t){return t=t||"",["&L",F(t[0]||""),"&C",F(t[1]||""),"&R",F(t[2]||"")].join("")}function F(t){if(R.isString(t))return'&"-,Regular"'.concat(t);if(R.isObject(t)&&!R.isArray(t)){var e="";if(t.font||t.bold){var n=t.bold?"Bold":"Regular";e+='&"'+(t.font||"-")+","+n+'"'}else e+='&"-,Regular"';return t.underline&&(e+="&U"),t.fontSize&&(e+="&"+t.fontSize),e+=t.text}return R.isArray(t)?R.reduce(t,function(t,e){return t.concat(F(e))},""):void 0}function _(t,e){if(e.length>0){var n=R.map(e,function(e){return D({name:"tablePart",attributes:[["r:id",t.getRelationshipId(e)]]})});return D({name:"tableParts",attributes:[["count",e.length]],children:n})}return""}function k(t,e){return e?D({name:"drawing",attributes:[["r:id",t.getRelationshipId(e)]]}):""}function I(){return M.xmlPrefix+'<worksheet xmlns="'+M.schemas.spreadsheetml+'" xmlns:r="'+M.schemas.relationships+'" xmlns:mc="'+M.schemas.markupCompat+'">'}function C(){return"</worksheet>"}var L=t("stream").Readable,R="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,M=t("./util"),E=t("./sheetView"),P=t("./relationshipManager"),N=t("./table"),O=t("./drawings"),D=t("./XMLString");i.prototype.end=function(){return this.workbook},i.prototype.addTable=function(t){var e=new N(this,t);return this.common.addTable(e),this.relations.addRelation(e,"table"),this.tables.push(e),e},i.prototype.setImage=function(t,e){return this._setImage(t,e,"anchor"),this},i.prototype.setImageOneCell=function(t,e){return this._setImage(t,e,"oneCell"),this},i.prototype.setImageAbsolute=function(t,e){return this._setImage(t,e,"absolute"),this},i.prototype._setImage=function(t,e,n){var i;this.drawings||(this.drawings=new O(this.common),this.common.addDrawings(this.drawings),this.relations.addRelation(this.drawings,"drawingRelationship")),i=R.isObject(t)?this.common.addImage(t.data,t.type):t,this.drawings.addImage(i,e,n)},i.prototype.setActive=function(){return this.common.setActiveWorksheet(this),this},i.prototype.setVisible=function(){return this.setState("visible"),this},i.prototype.setHidden=function(){return this.setState("hidden"),this},i.prototype.setState=function(t){return this.state=t,this},i.prototype.setHeader=function(t){if(!R.isArray(t))throw"Invalid argument type - setHeader expects an array of three instructions";return this.headers=t,this},i.prototype.setFooter=function(t){if(!R.isArray(t))throw"Invalid argument type - setFooter expects an array of three instructions";return this.footers=t,this},i.prototype.setPageMargin=function(t){return this._margin=R.defaults(t,{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3}),this},i.prototype.setPageOrientation=function(t){return this._orientation=t,this},i.prototype.setPrintTitleTop=function(t){return this._printTitles=this._printTitles||{},R.isObject(t)?(this._printTitles.topFrom=t[0],this._printTitles.topTo=t[1]):(this._printTitles.topFrom=0,this._printTitles.topTo=t-1),this},i.prototype.setPrintTitleLeft=function(t){return this._printTitles=this._printTitles||{},R.isObject(t)?(this._printTitles.leftFrom=t[0],this._printTitles.leftTo=t[1]):(this._printTitles.leftFrom=0,this._printTitles.leftTo=t-1),this},i.prototype.setRows=function(t,e){var n=this;return e?--t:(e=t,t=0),R.forEach(e,function(e,i){n.rows[t+i]=e}),this},i.prototype.setRow=function(t,e){return this.rows[--t]=e,this},i.prototype.setColumns=function(t,e){var n=this;return e?--t:(e=t,t=0),R.forEach(e,function(e,i){n.columns[t+i]=e}),this},i.prototype.setColumn=function(t,e){return this.columns[--t]=e,this},i.prototype.setData=function(t,e){var n=this;return e?--t:(e=t,t=0),R.forEach(e,function(e,i){n.data[t+i]=e}),this},i.prototype.mergeCells=function(t,e){return this.mergedCells.push([t,e]),this},i.prototype.setHyperlink=function(t){return t.objectId=R.uniqueId("hyperlink"),this.relations.addRelation({objectId:t.objectId,target:t.location,targetMode:t.targetMode||"External"},"hyperlink"),this.hyperlinks.push(t),this},i.prototype.setAttribute=function(t,e){return this.sheetView.setAttribute(t,e),this},i.prototype.freeze=function(t,e,n,i){return this.sheetView.freeze(t,e,n,i),this},i.prototype.split=function(t,e,n,i){return this.sheetView.split(t,e,n,i),this},i.prototype._prepare=function(){var t,e,n,i=0;for(this._prepareTables(),this.preparedData=[],this.preparedRows=[],t=0,e=this.data.length;t<e;t++)n=r(this,t),n&&n.length>i&&(i=n.length);this.data=null,this.rows=null,this.maxX=i,this.maxY=this.preparedData.length},i.prototype._prepareTables=function(){var t=this.data;R.forEach(this.tables,function(e){e._prepare(t)})},i.prototype._export=function(t){return t?new o({worksheet:this}):u(this)+d(this.preparedData,this.preparedRows,this.timezoneOffset)+h(this)},M.inherits(o,L||{}),o.prototype._read=function(t){var e=!1,n=this.worksheet;if(0===this.status&&(e=!this.push(u(n)),this.status=1,this.index=0,this.len=n.preparedData.length),1===this.status){for(var i="";this.index<this.len&&!e;){for(;this.index<this.len&&i.length<t;)i+=f(n.preparedData[this.index],this.index,n.preparedRows,n.timezoneOffset),n.preparedData[this.index]=null,this.index++;e=!this.push(i),i=""}this.index===this.len&&(this.status=2)}2===this.status&&(this.push(h(n)),this.push(null))},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./drawings":7,"./relationshipManager":11,"./sheetView":13,"./table":26,"./util":27,stream:1}]},{},[8])(8)});